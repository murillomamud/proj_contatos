/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2015 SAP SE. All rights reserved
 */
sap.ui.define(['sap/ui/layout/Grid','sap/ui/layout/form/SimpleForm','sap/viz/library','./common/BaseControl','./chartpopover/ChartPopover'],function(G,S,l,B,C){"use strict";var P=B.extend("sap.viz.ui5.controls.Popover",{metadata:{library:"sap.viz",properties:{customDataControl:{type:"any",defaultValue:null},actionItems:{type:"object[]",defaultValue:null},formatString:{type:"any",defaultValue:null}}}});P.prototype.init=function(){B.prototype.init.apply(this,arguments);this._Popover=undefined;this._uid=undefined;};P.prototype.exit=function(){B.prototype.exit.apply(this,arguments);var v=sap.ui.getCore().byId(this._uid);if(!v){return;}if(v._vizFrame){v._vizFrame.off('showTooltip');v._vizFrame.off('hideTooltip');}else{v._onConnectPopover(jQuery.proxy(function(e){if(!v._vizFrame){return;}v._vizFrame.off('showTooltip');v._vizFrame.off('hideTooltip');},this));}this._Popover=undefined;this._uid=undefined;};P.prototype.connect=function(u){this._uid=u;if(!this._Popover){this._createPopover();}var v=sap.ui.getCore().byId(this._uid);var a=v.getUiConfig();if(!a||a.applicationSet!=='fiori'){return;}var p=this._Popover;function c(){if(!v._vizFrame){return;}v._vizFrame.on('showTooltip',function(e){p.setOptions(e.data).openBy(e.data.target);});v._vizFrame.on('hideTooltip',function(){p.close();});p.setChartType(v._vizFrame.type());p._oPopover.setOffsetX(0);p._oPopover.setOffsetY(0);}if(v._vizFrame){c();}v._onConnectPopover(c);};P.prototype.close=function(){if(this._Popover){this._Popover.close();}};P.prototype.setFormatString=function(s){this.setProperty("formatString",s);if(this._Popover){this._Popover.setFormatString(s);}else{this._createPopover();}return this;};P.prototype.setCustomDataControl=function(c){this.setProperty('customDataControl',c);if(this._Popover){this._Popover.setCustomDataControl(c);}else{this._createPopover();}return this;};P.prototype.setActionItems=function(a){this.setProperty('actionItems',a);if(this._Popover){this._Popover.setActionItems(a);}else{this._createPopover();}return this;};P.prototype._createPopover=function(){this._Popover=new C({actionItems:this.getActionItems(),customDataControl:this.getCustomDataControl(),formatString:this.getFormatString()});};return P;});
