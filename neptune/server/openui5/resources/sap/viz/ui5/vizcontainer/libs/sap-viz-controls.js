/* SAP CVOM 4.0 Â© <2012-2013> SAP AG. All rights reserved. Build Version REL_bycheckin.245 */
define('sap/viz/controls/common/constants/ChartConst',[],function(){var C={};C.TYPE_COLUMN="viz/column";C.TYPE_STACKED_COLUMN="viz/stacked_column";C.TYPE_DUAL_COLUMN="viz/dual_column";C.TYPE_3D_COLUMN="viz/3d_column";C.TYPE_LINE="viz/line";C.TYPE_AREA="viz/area";C.TYPE_COMBINATION="viz/combination";C.TYPE_DUAL_LINE="viz/dual_line";C.TYPE_DUAL_COMBINATION="viz/dual_combination";C.TYPE_PIE="viz/pie";C.TYPE_DONUT="viz/donut";C.TYPE_PIE_WITH_DEPTH="viz/pie_with_depth";C.TYPE_GEO_BUBBLE="viz/geobubble";C.TYPE_GEO_CHOROPLETH="viz/choropleth";C.TYPE_GEO_PIE="viz/geopie";C.TYPE_GEO_MAP='viz/geomap';C.TYPE_SCATTER="viz/scatter";C.TYPE_BUBBLE="viz/bubble";C.TYPE_SCATTER_MATRIX="viz/scatter_matrix";C.TYPE_HEATMAP="viz/heatmap";C.TYPE_TREEMAP="viz/treemap";C.TYPE_TABLE="viz/ext/table";C.TYPE_RADAR="viz/radar";C.TYPE_BOXPLOT="viz/boxplot";C.TYPE_WATERFALL="viz/waterfall";C.TYPE_TAG_CLOUD="viz/tagcloud";C.TYPE_TREE="viz/tree";C.TYPE_NETWORK="viz/network";C.TYPE_FUNNEL='viz/ext/pa/funnel';C.TYPE_PC='viz/ext/pa/pc';C.DIRECTION_HORIZONTAL="horizontal";C.DIRECTION_VERTICAL="vertical";C.STACKING_FULL="full";C.STACKING_NORMAL="normal";C.TYPE_BAR="viz/bar";C.TYPE_STACKED_BAR="viz/stacked_bar";C.TYPE_100_STACKED_COLUMN="viz/100_stacked_column";C.TYPE_100_STACKED_BAR="viz/100_stacked_bar";C.TYPE_DUAL_BAR="viz/dual_bar";C.TYPE_3D_BAR="viz/3d_bar";C.TYPE_HORIZONTAL_LINE="viz/horizontal_line";C.TYPE_HORIZONTAL_AREA="viz/horizontal_area";C.TYPE_100_AREA="viz/100_area";C.TYPE_100_HORIZONTAL_AREA="viz/100_horizontal_area";C.TYPE_HORIZONTAL_COMBINATION="viz/horizontal_combination";C.TYPE_DUAL_HORIZONTAL_LINE="viz/dual_horizontal_line";C.TYPE_DUAL_HORIZONTAL_COMBINATION="viz/dual_horizontal_combination";C.TYPE_HORIZONTAL_BOXPLOT="viz/horizontal_boxplot";C.TYPE_HORIZONTAL_WATERFALL="viz/horizontal_waterfall";return C});define('sap/viz/controls/feeding/FeedingPanelConfig',['sap/viz/controls/common/constants/ChartConst'],function(C){var F={};F.instance=function(){return{'useBuildInFeedList':true,"defaultVizType":C.TYPE_COLUMN,'enableTrellis':true}};return F});define('sap/viz/controls/mapbuilder/MapBuilderConfig',[],function(){var M={};M.instance=function(){return{basemap:{providers:["ESRI","CVOM","NAVTEQ"],changeable:true,selected:"ESRI"},feedMap:{actionGroups:[]},feedingPanel:{}}};return M});define('sap/viz/controls/common/managers/LangManager',['sap/viz/lang/langManager'],function(l){var L=function(){this.__className="sap.viz.controls.common.managers.LangManager"};L.get=function(n){return l.get(n)};return L});define('sap/viz/controls/switchbar/SwitchBarConfig',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/managers/LangManager'],function(C,L){var S={};S.instance=function(){return{"visible":true,"defaultVizType":C.TYPE_COLUMN,"groups":[{"name":L.get("VIZ_SWITCHBAR_COLUMN_CHARTS"),"types":[{"id":C.TYPE_COLUMN},{"id":C.TYPE_STACKED_COLUMN},{"id":C.TYPE_DUAL_COLUMN},{"id":C.TYPE_3D_COLUMN}]},{"name":L.get("VIZ_SWITCHBAR_LINE_CHARTS"),"types":[{"id":C.TYPE_LINE},{"id":C.TYPE_AREA},{"id":C.TYPE_COMBINATION},{"id":C.TYPE_DUAL_LINE},{"id":C.TYPE_DUAL_COMBINATION}]},{"name":L.get("VIZ_SWITCHBAR_PIE_CHARTS"),"types":[{"id":C.TYPE_PIE},{"id":C.TYPE_DONUT},{"id":C.TYPE_PIE_WITH_DEPTH}]},{"name":L.get("VIZ_SWITCHBAR_GEO_CHARTS"),"types":[{"id":C.TYPE_GEO_BUBBLE},{"id":C.TYPE_GEO_CHOROPLETH},{"id":C.TYPE_GEO_PIE}]},{"name":L.get("VIZ_SWITCHBAR_SCATTER_CHARTS"),"types":[{"id":C.TYPE_SCATTER},{"id":C.TYPE_BUBBLE},{"id":C.TYPE_SCATTER_MATRIX}]},{"name":L.get("VIZ_SWITCHBAR_MAP_CHARTS"),"types":[{"id":C.TYPE_HEATMAP},{"id":C.TYPE_TREEMAP}]},{"name":L.get("VIZ_SWITCHBAR_TABLES"),"types":[{"id":C.TYPE_TABLE}]},{"name":L.get("VIZ_SWITCHBAR_OTHER_CHARTS"),"types":[{"id":C.TYPE_RADAR},{"id":C.TYPE_BOXPLOT},{"id":C.TYPE_WATERFALL},{"id":C.TYPE_TAG_CLOUD},{"id":C.TYPE_TREE},{"id":C.TYPE_NETWORK},{"id":C.TYPE_FUNNEL},{"id":C.TYPE_PC}]}]}};return S});define('sap/viz/controls/builder/VizBuilderConfig',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/feeding/FeedingPanelConfig','sap/viz/controls/mapbuilder/MapBuilderConfig','sap/viz/controls/switchbar/SwitchBarConfig'],function(C,F,M,S){var V={};V.instance=function(){return{"defaultVizType":C.TYPE_COLUMN,"header":{"visible":true},"controls":{"switchBar":S.instance(),"feedingPanel":F.instance(),"mapBuilder":M.instance()}}};return V});define('sap/viz/controls/chart/ChartConfig',[],function(){var C={};C.instance=function(){return{'enableTrellis':true,'enableMorphing':true,"defaultLabelFormatString":[['u']],"defaultProperties":{"title":{"visible":true},"tooltip":{"visible":true},"dataLabel":{"visible":false},"plotArea":{"animation":{"dataLoading":false,"dataUpdating":false,"resizing":false},"marker":{"shape":"circle","size":6,"visible":true},"line":{"marker":{"shape":"circle","size":6,"visible":true}},"valueAxis":{"title":{"visible":true}},"polarAxis":{"title":{"visible":true}}},"legend":{"visible":true},"sizeLegend":{"visible":true},"xAxis":{"title":{"visible":true}},"xAxis2":{"title":{"visible":true}},"yAxis":{"title":{"visible":true}},"yAxis2":{"title":{"visible":true}},"geomap":{"provider":"ESRI","choropleth":{"startColor":"rgb(252, 218, 189)","endColor":"rgb(244, 131, 35)"}}}}};return C});define('sap/viz/controls/annotation/AnnotationConfig',[],function(){var A={};A.instance=function(){return{}};return A});define('sap/viz/controls/filterbar/FilterBarConfig',[],function(){var F={};F.instance=function(){return{"module":{"visible":true}}};return F});define('sap/viz/controls/contextmenu/ContextMenuConfig',[],function(){var C={};C.instance=function(){return{'menu':[["direction","stacking"],["legend","mbclegend","datalabels","mnd"],["comment","charteditor"]]}};return C});define('sap/viz/controls/custombutton/CustomButtonConfig',[],function(){var C={};C.instance=function(){return{"visible":true,"title":"Button"}};return C});define('sap/viz/controls/frame/VizFrameConfig',['sap/viz/controls/annotation/AnnotationConfig','sap/viz/controls/chart/ChartConfig','sap/viz/controls/filterbar/FilterBarConfig','sap/viz/controls/contextmenu/ContextMenuConfig','sap/viz/controls/custombutton/CustomButtonConfig','sap/viz/controls/common/constants/ChartConst'],function(A,C,F,a,b,c){var V={};V.instance=function(){var r={"enableAnnotation":false,"enableFilterMenu":true,"enableFilterBar":true,"enableSettingButton":true,"enableFullScreenButton":true,"controls":{"chart":C.instance(),"filterBar":F.instance(),"contextMenu":a.instance(),"annotation":A.instance(),"settingButton":b.instance(),"fullScreenButton":b.instance()}};return r};return V});define('sap/viz/controls/filterbar2/FilterBarConfig',[],function(){var F={};F.instance=function(){return{"maxLines":2}};return F});define('sap/viz/controls/common/config/GlobalConfig',['sap/viz/controls/builder/VizBuilderConfig','sap/viz/controls/chart/ChartConfig','sap/viz/controls/feeding/FeedingPanelConfig','sap/viz/controls/frame/VizFrameConfig','sap/viz/controls/switchbar/SwitchBarConfig','sap/viz/controls/filterbar/FilterBarConfig','sap/viz/controls/filterbar2/FilterBarConfig','sap/viz/controls/contextmenu/ContextMenuConfig','sap/viz/controls/custombutton/CustomButtonConfig','sap/viz/controls/annotation/AnnotationConfig','sap/viz/controls/mapbuilder/MapBuilderConfig'],function(V,C,F,a,S,b,c,d,e,A,M){var G={};G.DEFAULT_UICONFIG_TYPE_BUILDER='uiconfig-builder';G.DEFAULT_UICONFIG_TYPE_CHART='uiconfig-chart';G.DEFAULT_UICONFIG_TYPE_FEEDING='uiconfig-feeding';G.DEFAULT_UICONFIG_TYPE_FRAME='uiconfig-frame';G.DEFAULT_UICONFIG_TYPE_SWITCHBAR='uiconfig-switchbar';G.DEFAULT_UICONFIG_TYPE_FILTERBAR='uiconfig-filterbar';G.DEFAULT_UICONFIG_TYPE_FILTERBAR2='uiconfig-filterbar2';G.DEFAULT_UICONFIG_TYPE_CONTEXTMENU='uiconfig-contextmenu';G.DEFAULT_UICONFIG_TYPE_CUSTOMBUTTON='uiconfig-custombutton';G.DEFAULT_UICONFIG_TYPE_ANNOTATION='uiconfig-annotation';G.DEFAULT_UICONFIG_TYPE_MAPBUILDER='uiconfig-mapbuilder';var _="../src";G.defaultUIConfig=function(t){var u={};switch(t){case G.DEFAULT_UICONFIG_TYPE_BUILDER:u=V.instance();break;case G.DEFAULT_UICONFIG_TYPE_CHART:u=C.instance();break;case G.DEFAULT_UICONFIG_TYPE_FEEDING:u=F.instance();break;case G.DEFAULT_UICONFIG_TYPE_FRAME:u=a.instance();break;case G.DEFAULT_UICONFIG_TYPE_SWITCHBAR:u=S.instance();break;case G.DEFAULT_UICONFIG_TYPE_FILTERBAR:u=b.instance();break;case G.DEFAULT_UICONFIG_TYPE_FILTERBAR2:u=c.instance();break;case G.DEFAULT_UICONFIG_TYPE_CONTEXTMENU:u=d.instance();break;case G.DEFAULT_UICONFIG_TYPE_CUSTOMBUTTON:u=e.instance();break;case G.DEFAULT_UICONFIG_TYPE_ANNOTATION:u=A.instance();break;case G.DEFAULT_UICONFIG_TYPE_MAPBUILDER:u=M.instance();break;default:u[G.DEFAULT_UICONFIG_TYPE_BUILDER]=V.instance();u[G.DEFAULT_UICONFIG_TYPE_CHART]=C.instance();u[G.DEFAULT_UICONFIG_TYPE_FEEDING]=F.instance();u[G.DEFAULT_UICONFIG_TYPE_FRAME]=a.instance();u[G.DEFAULT_UICONFIG_TYPE_SWITCHBAR]=S.instance();u[G.DEFAULT_UICONFIG_TYPE_FILTERBAR]=b.instance();u[G.DEFAULT_UICONFIG_TYPE_FILTERBAR2]=c.instance();u[G.DEFAULT_UICONFIG_TYPE_CONTEXTMENU]=d.instance();u[G.DEFAULT_UICONFIG_TYPE_CUSTOMBUTTON]=e.instance();u[G.DEFAULT_UICONFIG_TYPE_ANNOTATION]=A.instance();u[G.DEFAULT_UICONFIG_TYPE_MAPBUILDER]=M.instance()}return u};G.defaultAssetsRoot=function(p){if(arguments.length>0){_=p;G._setResourcePath()}else{return _}};G._setResourcePath=function(){var p=[_+"/locale/"];var f=sap.viz.api.env.Resource.path("sap.viz.api.env.Language.loadPaths");var n=f?p.concat(f):p;sap.viz.api.env.Resource.path("sap.viz.api.env.Language.loadPaths",n)};return G});define('sap/viz/controls/common/constants/CSSConst',[],function(){var C={};C.PREFIX="viz-controls-";C.COMMON_PREFIX=C.PREFIX+"common-";C.SWITCHBAR_PREFIX=C.PREFIX+"switchbar-";C.FEEDINGPANEL_PREFIX=C.PREFIX+"feeding-";C.VIZDATAPICKER_PREFIX=C.PREFIX+"datapicker-";C.FRAME_PREFIX=C.PREFIX+"frame-";C.BUILDER_PREFIX=C.PREFIX+"builder-";C.TRELLIS_PREFIX=C.PREFIX+"trellis-";C.MAPBUILDER_PREFIX=C.PREFIX+"mapbuilder-";C.CHART_PREFIX=C.PREFIX+"chart-";C.FILTERBAR_PREFIX=C.PREFIX+"filterbar-";C.FILTERBAR2_PREFIX=C.PREFIX+"filterbar2-";C.CONTEXTMENU_PREFIX=C.PREFIX+"contextmenu-";C.CUSTOMBUTTON_PREFIX=C.PREFIX+"custombutton-";C.ANNOTATION_PREFIX=C.PREFIX+"annotation-";C.FEEDINGSHELF_PREFIX=C.COMMON_PREFIX+"feeding-";return C});define('sap/viz/controls/common/utils/OOUtil',[],function(){var u;var O={};O.extend=function(s,a){var b=s.prototype;s.superclass=a.prototype;var F=function(){};F.prototype=a.prototype;s.prototype=new F();for(var p in b){if(b.hasOwnProperty(p)){s.prototype[p]=b[p]}}s.prototype.constructor=s;if(a.prototype.constructor==Object.prototype.constructor){a.prototype.constructor=a}return s};return O});define('sap/viz/controls/common/events/Event',[],function(){var E=function(t,a,d){this.__className="sap.viz.controls.common.events.Event";this._type=t;this._target=a;this.data=d};E.prototype.type=function(){return this._type};E.prototype.target=function(){return this._target};return E});define('sap/viz/controls/common/events/FeedEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var F=function(t,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.events.FeedEvent"};O.extend(F,E);F.FEED_READY="feedReady";F.REQUEST_FEED="requestFeed";F.FEEDS_CHANGED="feedsChanged";return F});define('sap/viz/controls/common/utils/Utils',[],function(){var u={};var _=0;u.genUID=function(){if(!_){_=0}return"vcgen_"+(_++)};var c={'[object Boolean]':'boolean','[object Number]':'number','[object String]':'string','[object Function]':'function','[object Array]':'array','[object Date]':'date','[object RegExp]':'regexp','[object Object]':'object'};u.applyObjectProperty=function(o,p,a){try{if(u.isFunction(o[p])){o[p](a)}else{o[p]=a}}catch(e){}};u.applyProperties=function(a,p){if(p){var l=p.length;for(var i=0;i<l;i++){var b=p[i];if(b){u.applyObjectProperty(a,b.name,b.value)}}}};u.getObjectProperty=function(o,p){try{if(u.isFunction(o[p])){return o[p]()}else if(o.hasOwnProperty(p)){return o[p]}}catch(e){}};u.type=function(o){return o==null?String(o):c[Object.prototype.toString.call(o)]||"object"};u.isFunction=function(o){return u.type(o)==="function"};u.isBoolean=function(o){return u.type(o)==="boolean"};u.isString=function(o){return u.type(o)==="string"};u.isArray=function(o){return u.type(o)==="array"};u.isNumber=function(o){return u.type(o)==="number"};u.isRegExp=function(o){return u.type(o)==="regexp"};u.sortArrayOn=function(d,p,e){if(u.isArray(d)&&u.isString(p)){d.sort(function(a,b){return e?(a[p]<b[p])-(a[p]>b[p]):(a[p]>b[p])-(a[p]<b[p])})}};u.noop=function(){};u.delay=function(h,w){return setTimeout(function(){return h.apply(null)},w)};u.defer=function(h){return u.delay.call(null,h,1)};u.getEventPosition=function(e){var p=null;var a=null;if(e.originalEvent&&e.originalEvent.targetTouches&&e.originalEvent.targetTouches.length!==0){p=e.originalEvent.targetTouches[0].pageX;a=e.originalEvent.targetTouches[0].pageY}else{p=e.pageX;a=e.pageY}var b={};b.pageX=p;b.pageY=a;return b};u.clone=function(a){if(a===null||typeof(a)!=='object'){return a}var o=a.constructor===Array?[]:{};for(var i in a){if(a.hasOwnProperty(i)){o[i]=arguments.callee.call(null,a[i])}}return o};u.toJSON=function(a,p){if(u.isArray(a)){var r=[];for(var i=0;i<a.length;i++){r.push(p.call(null,a[i]))}return r}else if(a){return p.call(null,a)}else{return null}};u.fromJSON=function(j,p){if(u.isArray(j)){var r=[];for(var i=0;i<j.length;i++){r.push(p.call(null,j[i]))}return r}else if(j){return p.call(null,j)}else{return undefined}};u.updateJSON=function(s,n){var r=u.clone(s);r=r||{};var a=function(b,d){for(var p in d){if(d.hasOwnProperty(p)){var e=d[p];if(e!==undefined){if(typeof(e)!=="object"||e instanceof(Array)){b[p]=e}else{var f=b[p];if(!f){if(e===null||e===undefined){f=e}else{f=b[p]={}}}a(f,e)}}}}};a(r,n);return r};u.substitute=function(s,r){if(!s)return'';for(var i=1;i<arguments.length;i++){s=s.replace(new RegExp("\\{"+(i-1)+"\\}","g"),arguments[i])}return s};return u});define('sap/viz/controls/common/constants/DatasetTypeConst',[],function(){var D={};D.FlatTableDataset='FlatTableDataset';D.CrosstableDataset='CrosstableDataset';D.RawDataset='RawDataset';return D});define('sap/viz/controls/common/feeds/AnalyticalType',[],function(){var A={};A.UNIVERSAL='universal';A.MEASURE='measure';A.DIMENSION='dimension';A.HIERARCHY='hierarchy';A.MND='mnd';A.compatible=function(h,c){if(h===A.UNIVERSAL){return true}else if(h===A.DIMENSION){return c===A.DIMENSION||c===A.HIERARCHY||c===A.MND}else{return h===c}};return A});define('sap/viz/controls/common/feeds/HierarchyLevelObject',['sap/viz/controls/common/utils/Utils'],function(u){var H=function(i,n,a){this.__className="sap.viz.controls.common.feeds.HierarchyLevelObject";this._id=i;this._name=n;this._analysis=a;this._selected=false};H.prototype.id=function(){return this._id};H.prototype.name=function(){return this._name};H.prototype.analysis=function(){return this._analysis};H.prototype.selected=function(v){if(arguments.length>0){this._selected=v;return this}else{return this._selected}};H.prototype.clone=function(){var a=null;if(this._analysis){a=this._analysis.clone()}var c=new H(this._id,this._name,a);c.selected(this._selected);return c};H.toJSON=function(i){var A=require('sap/viz/controls/common/feeds/AnalysisObject');return u.toJSON(i,function(i){return{'id':i._id,'name':i._name,'analysis':A.toJSON(i._analysis),'selected':i._selected}})};H.fromJSON=function(j){var A=require('sap/viz/controls/common/feeds/AnalysisObject');return u.fromJSON(j,function(j){var i=new H(j.id,j.name,A.fromJSON(j.analysis));i.selected(j.selected);return i})};return H});define('sap/viz/controls/common/views/menu/MenuItem',['sap/viz/controls/common/utils/Utils'],function(u){var M=function(i,n,s){this.__className="sap.viz.controls.common.views.menu.MenuItem";this._id=i;this._name=n;this._enabled=true;this._selected=false;this._subMenuGroups=s};M.prototype.id=function(){return this._id};M.prototype.name=function(){return this._name};M.prototype.icon=function(){return this._icon};M.prototype.subMenuGroups=function(){return this._subMenuGroups};M.prototype.enabled=function(v){if(arguments.length>0){this._enabled=v;return this}else{return this._enabled}};M.prototype.selected=function(v){if(arguments.length>0){this._selected=v;return this}else{return this._selected}};M.prototype.equal=function(m){if(m==undefined){return false}if(this.id()!==m.id()){return false}if(this.name()!==m.name()){return false}var s=this.subMenuGroups()||[];var a=m.subMenuGroups()||[];if(s.length!==a.length){return false}for(var i=0;i<s.length;i++){var b=s[i];var c=a[i];if(!(b==undefined&&c==undefined)){if(b==undefined){return false}if(!b.equal(c)){return false}}}return true};M.toJSON=function(i){var a=require('sap/viz/controls/common/views/menu/MenuGroup');return u.toJSON(i,function(i){return{'id':i._id,'name':i._name,'subMenuGroups':a.toJSON(i._subMenuGroups),'enabled':i._enabled,'selected':i._selected}})};M.fromJSON=function(j){var a=require('sap/viz/controls/common/views/menu/MenuGroup');return u.fromJSON(j,function(j){var m=new M(j.id,j.name,a.fromJSON(j.subMenuGroups));m.enabled(j.enabled);m.selected(j.selected);return m})};return M});define('sap/viz/controls/common/views/menu/MenuGroup',['sap/viz/controls/common/utils/Utils','sap/viz/controls/common/views/menu/MenuItem'],function(u,M){var a=function(m){this.__className="sap.viz.controls.common.views.menu.MenuGroup";this._menuItems=m};a.prototype.menuItems=function(){return this._menuItems};a.prototype.selectedItem=function(){for(var i=0;i<this._menuItems.length;i++){if(this._menuItems[i].selected()){return this._menuItems[i]}}return null};a.prototype.equal=function(m){if(m==undefined){return false}var b=this.menuItems()||[];var c=m.menuItems()||[];if(b.length!==c.length){return false}for(var i=0;i<b.length;i++){var d=b[i];var e=c[i];if(!(d==undefined&&e==undefined)){if(d==undefined){return false}if(!d.equal(e)){return false}}}return true};a.toJSON=function(i){return u.toJSON(i,function(i){return{'menuItems':M.toJSON(i._menuItems)}})};a.fromJSON=function(j){return u.fromJSON(j,function(j){return new a(M.fromJSON(j.menuItems))})};return a});define('sap/viz/controls/common/feeds/AnalysisObject',['sap/viz/controls/common/utils/Utils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/views/menu/MenuGroup'],function(u,L,A,H,M){var a=function(i,n,t,d){this.__className="sap.viz.controls.common.feeds.AnalysisObject";this._id=i;this._name=n;this._type=t;this._dataType=d;this._actions=null;this._hierarchyLevels=null};a.genMND=function(){return new a('mnd','',A.MND,'string')};a.prototype.id=function(){return this._id};a.prototype.name=function(v){if(arguments.length>0){this._name=v;return this}else{return this._name}};a.prototype.type=function(){return this._type};a.prototype.dataType=function(){return this._dataType};a.prototype.actions=function(v){if(arguments.length>0){this._actions=v;return this}else{return this._actions}};a.prototype.hierarchyLevels=function(v){if(arguments.length>0){this._hierarchyLevels=v;return this}else{return this._hierarchyLevels}};a.prototype.selectedHierarchyLevel=function(){if(!this._hierarchyLevels){return}for(var i=0;i<this._hierarchyLevels.length;i++){if(this._hierarchyLevels[i].selected()){return this._hierarchyLevels[i]}}return};a.prototype.selectedHierarchyLevelID=function(b){if(!this._hierarchyLevels){return this}for(var i=0;i<this._hierarchyLevels.length;i++){var l=this._hierarchyLevels[i];l.selected(l.id()===b)}return this};a.prototype.clone=function(){var c=a.fromJSON(a.toJSON(this));return c};a.prototype.equal=function(b){if(this.name()!==b.name()){return false}if(this.type()===A.HIERARCHY&&b.type()===A.HIERARCHY&&this.selectedHierarchyLevel().id()!==b.selectedHierarchyLevel().id()){return false}if(this.actions()!=undefined||b.actions()!=undefined){var c=this.actions()||[];var d=b.actions()||[];if(c.length!==d.length){return false}for(var i=0;i<c.length;i++){var m=c[i];var e=d[i];if(!(m==undefined&&e==undefined)){if(m==undefined){return false}if(!m.equal(e)){return false}}}}return true};a.toJSON=function(i){return u.toJSON(i,function(i){return{'id':i._id,'name':i._name,'type':i._type,'dataType':i._dataType,'actions':M.toJSON(i._actions),'hierarchyLevels':H.toJSON(i._hierarchyLevels)}})};a.fromJSON=function(j){return u.fromJSON(j,function(j){var i=new a(j.id,j.name,j.type,j.dataType);if(j.actions){i.actions(M.fromJSON(j.actions))}if(j.hierarchyLevels){i.hierarchyLevels(H.fromJSON(j.hierarchyLevels))}return i})};return a});define('sap/viz/controls/common/feeds/FeedItem',['sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/AnalysisObject'],function(u,A){var F=function(i,t,v){this.__className="sap.viz.controls.common.feeds.FeedItem";this._id=i;this._type=t;this._values=v};F.prototype.type=function(){return this._type};F.prototype.id=function(){return this._id};F.prototype.values=function(v){if(arguments.length>0){this._values=v;return this}else{return this._values}};F.prototype.hasValues=function(){return(this._values&&this._values.length>0)};F.prototype.clone=function(){return F.fromJSON(F.toJSON(this))};F.toJSON=function(i){return u.toJSON(i,function(i){return{'id':i._id,'type':i._type,'values':A.toJSON(i._values)}})};F.fromJSON=function(j){return u.fromJSON(j,function(j){return new F(j.id,j.type,A.fromJSON(j.values))})};return F});define('sap/viz/controls/common/feeds/FeedItemType',[],function(){var F=function(){this.__className="sap.viz.controls.common.feeds.FeedItemType"};F.MEASURE='Measure';F.DIMENSION='Dimension';F.GEOGRAPHY='Geography';return F});define('sap/viz/controls/common/utils/FakeDataUtils',['jquery','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/Utils'],function($,C,A,L,U){var F={};F.buildFakeData=function(v,f,d){var r=d;var a=F.feedItems2feed(f);var b=F._buildRIVFeeding(v,a);return F._buildFake(v,b,r)};F.feedItems2feed=function(f){var a=[];f.forEach(function(b){var v=b.values();if(v.length>0){for(var i=0;i<v.length;++i){var c=v[i];var d={'feed':b.id().indexOf('multiplier')!==-1?b.id().split('.')[0]:b.id()};if(c.type()===A.HIERARCHY){var h=c.hierarchyLevels();for(var j=0;j<h.length;j++){var l=h[j];if(l.selected()){d.objId=l.id()}}}else if(c.type()===A.MND){d.objId=null}else{d.objId=c.id()}a.push(d)}}});return a};F._buildRIVFeeding=function(v,f){var c=sap.viz.api.manifest.Viz;var a=c.get(v)[0];var b=a.allFeeds();var d=[];var m=[];var e=[];for(var i=0;i<b.length;i++){var g=b[i].id;var h=b[i].type;var l=[];for(var j=0;j<f.length;j++){if(f[j].feed==g){l.push(f[j])}}if(l.length>0){var n={};n.feedId=g;n.binding=[];var o=0;for(var k=0;k<l.length;k++){if(l[k].objId!=null){if(h==="Dimension"){if($.inArray(b[i].aaIndex,d)==-1){n.binding[o]={};n.binding[o].type="analysisAxis";n.binding[o].index=b[i].aaIndex;d.push(b[i].aaIndex);o++}}else{if($.inArray(b[i].mgIndex,m)==-1){n.binding[o]={};n.binding[o].type="measureValuesGroup";n.binding[o].index=b[i].mgIndex;m.push(b[i].mgIndex);o++}}}else if(h==="Dimension"){n.binding[o]={};n.binding[o].type="measureNamesDimension";o++}}e.push(n)}}d.sort();m.sort();F._fillAxesHoles(e,d);F._fillMgHoles(e,m);return e};F._fillAxesHoles=function(d,a){var j,b;if(a.length>0){b=a[0]-1;if(b>0){for(var j=0;j<d.length;j++){for(var k=0;k<d[j].binding.length;k++){if(d[j].binding[k].type=="analysisAxis"&&d[j].binding[k].index!=null&&d[j].binding[k].index>1){d[j].binding[k].index-=b}}}for(j=0;j<a.length;j++){a[j]-=b}}}for(var i=0;i<a.length-1;i++){b=a[i+1]-a[i]-1;if(b>0){for(j=0;j<d.length;j++){for(var k=0;k<d[j].binding.length;k++){if(d[j].binding[k].type=="analysisAxis"&&d[j].binding[k].index!=null&&d[j].binding[k].index>a[i]){d[j].binding[k].index-=b}}}for(j=i+1;j<a.length;j++){a[j]-=b}}}};F._fillMgHoles=function(d,m){var j;if(m.length>0){var a=m[0]-1;if(a>0){for(j=0;j<d.length;j++){if(d[j].binding[0].type=="measureValuesGroup"&&d[j].binding[0].index!=null&&d[j].binding[0].index>1){d[j].binding[0].index-=a}}for(j=0;j<m.length;j++){m[j]-=a}}}for(var i=0;i<m.length-1;i++){var a=m[i+1]-m[i]-1;if(a>0){for(j=0;j<d.length;j++){if(d[j].binding[0].type=="measureValuesGroup"&&d[j].binding[0].index!=null&&d[j].binding[0].index>m[i]){d[j].binding[0].index-=a}}for(j=i+1;j<m.length;j++){m[j]-=a}}}};F._getMNDfeed=function(f,a){if(!a)return;var m={priority:-1};for(var i=0;i<f.length;i++){var I=f[i].id;var b=f[i];var c=U.isNumber(b.acceptMND)?Number(b.acceptMND):-1;var d=false;for(var j=0;j<a.length;j++){if(a[j].feedId==I){if(a[j].binding.length>0){for(var k=0;k<a[j].binding.length;k++){if(a[j].binding[k].type=='measureNamesDimension'){return I}}}if(a[j].binding.length<b.min){if(c>m.priority){m={feedId:I,priority:b.acceptMND}}}d=true;break}}if(!d){if(b.min>0&&c>=0){m={feedId:I,priority:b.acceptMND}}}}return m.feedId};F._validateInput=function(f,d){for(var i=0;i<f.length;i++){var a=f[i];if(a.binding){for(var j=0;j<a.binding.length;j++){if(a.binding[j].type=='analysisAxis'){var l=0;var b=a.binding[j].index;if(d.analysisAxis){l=d.analysisAxis.length}if(b>l){return false}}}}};return true};F._buildFake=function(v,r,a){if(!F._validateInput(r,a)){a.analysisAxis=[];a.measureValuesGroup=[];return{"feeding":r,"dataset":a}}var c=sap.viz.api.manifest.Viz;var b=c.get(v)[0];var f=b.allFeeds();var d=b.id;var m=F._getMNDfeed(f,r);var e=[];var g=[];var i,j;for(i=0;i<f.length;i++){if(f[i].id==m){continue}var h=F._getFakeToBeBuilt(f[i],r,a);if(h.nb>0){if(h.axisIndex!=null){e.push(h)}else if(h.mgIndex!=null){g.push(h)}}}if(a.analysisAxis==null){a.analysisAxis=[]}for(i=0;i<e.length;i++){var l=e[i];var n=null;for(var j=0;j<a.analysisAxis.length;j++){if(a.analysisAxis[j].index==l.axisIndex){n=a.analysisAxis[j]}}if(n==null){n={};n.data=[];n.index=l.axisIndex;a.analysisAxis.push(n)}var o={};o.type="Dimension";o.name=L.get('VIZ_COMMON_FAKE_DIMENSION');o.isFake=true;var p=false;for(j=0;j<a.analysisAxis.length;j++){if(a.analysisAxis[j].data[0]!=null&&a.analysisAxis[j].data[0].values.length>0){p=true}else{p=false}}if(p||i>0){if(d===C.TYPE_TREE||d===C.TYPE_NETWORK){o.values=F._buildFakeDimensionValues(n.data[0].values.length)}else{o.values=F._buildFakeDimensionValues(1)}}else{var q=10;if(a.measureValuesGroup!=null&&a.measureValuesGroup[0]!=null){q=a.measureValuesGroup[0].data[0].values.length}o.values=F._buildFakeDimensionValues(q);if(F._isGeoOrNor(v)){o.infos=[{featureId:"20128886,NAVTEQ"}]}}n.data.push(o)}if(a.measureValuesGroup==null){a.measureValuesGroup=[]}var s=F._sortAxes(f,a,r);if(s){F._swapMeasure(a)}for(i=0;i<g.length;i++){var t=g[i];var u=null;for(j=0;j<a.measureValuesGroup.length;j++){if(a.measureValuesGroup[j].index==t.mgIndex){u=a.measureValuesGroup[j]}}if(u==null){u={};u.data=[];u.index=t.mgIndex;a.measureValuesGroup.push(u)}for(var k=0;k<t.nb;k++){var w={};w.type="Measure";w.name=L.get('VIZ_COMMON_FAKE_MEASURE')+(k+1);w.isFake=true;var x=[];for(j=a.analysisAxis.length-1;j>=0;j--){x.push(a.analysisAxis[j].data[0].values.length)}if(x.length===0){x=[1]}var y=F._buildFakeMeasureValues(x);if(!Array.isArray(y[0])){y=[y]}w.values=y;u.data.push(w)}}return{"feeding":r,"dataset":a}};F._sortAxes=function(f,r,a){var b={};if(r.analysisAxis.length>1){for(var i=0;i<f.length;i++){var c=f[i];if(c.type==='Dimension'){for(var j=0;j<a.length;j++){if(a[j].feedId===c.id){var d=c.aaIndex;var e=a[j].binding;for(var m=0;m<e.length;m++){if(e[m]&&e[m].type=="analysisAxis"){var g=e[m].index;for(var n=0;n<r.analysisAxis.length;n++){if(r.analysisAxis[n].index===g){b[n]=d;break}}}}}}}}}var h=false;for(var i=0;i<r.analysisAxis.length;i++){for(var j=r.analysisAxis.length-1;j>=i+1;j--){if(b[j]<b[j-1]){var l=r.analysisAxis[j];r.analysisAxis[j]=r.analysisAxis[j-1];r.analysisAxis[j-1]=l;h=true}}}var o=U.clone(a);for(var i=0;i<r.analysisAxis.length;i++){var l=r.analysisAxis[i];var d=i+1;for(var j=0;j<o.length;j++){var e=o[j].binding;for(var k=0;k<e.length;k++){if(e[k]&&e[k].type=="analysisAxis"&&e[k].index==l.index){a[j].binding[k].index=d}}}l.index=d}return h};F._swapMeasure=function(r){var a=r.measureValuesGroup;if(a){for(var m=0;m<a.length;m++){var d=a[m].data;if(d){for(var n=0;n<d.length;n++){var b=d[n];var l=b.values.length;var c=b.values[0].length;var e=new Array(c);for(var j=0;j<c;j++){e[j]=new Array(l)}for(var i=0;i<l;i++){for(var j=0;j<c;j++){e[j][i]=b.values[i][j]}}b.values=e}}}}};F._getFakeToBeBuilt=function(f,r,a){var b=f.min;if(f.id==="treeNode"||f.id==="link"){b=f.minStackedDims}if(b==0){return{"nb":0}}var n=0;var i,j,k;for(i=0;i<r.length;i++){var c=null;var m=null;if(f.id==r[i].feedId){if(f.type=="Dimension"){var d=r[i].binding;for(k=0;k<d.length;k++){if(d[k].index){c=d[k].index}}if(c!==null){if(!a.analysisAxis.length){return{"nb":0,"axisIndex":c}}else{for(j=0;j<a.analysisAxis.length;j++){if(a.analysisAxis[j].index==c){n=a.analysisAxis[j].data.length;var e=b-n;if(e<0){e=0}return{"nb":e,"axisIndex":c}}}}}else{return{"nb":0}}}else if(f.type=="Measure"){m=r[i].binding[0].index;for(j=0;j<a.measureValuesGroup.length;j++){if(a.measureValuesGroup[j].index==m){n=a.measureValuesGroup[j].data.length;var e=b-n;if(e<0){e=0}return{"nb":e,"mgIndex":m}}}return{"nb":0,"mgIndex":m}}}}if(f.type=="Dimension"){var g=1;for(i=0;i<r.length;i++){for(k=0;k<r[i].binding.length;k++){if(r[i].binding[k].type=="analysisAxis"&&r[i].binding[k].index>=g){g=r[i].binding[k].index+1}}}var h={};h.feedId=f.id;h.binding=[];h.binding[0]={};h.binding[0].type="analysisAxis";h.binding[0].index=g;r.push(h);return{"nb":b,"axisIndex":g}}else if(f.type=="Measure"){var l=1;for(i=0;i<r.length;i++){if(r[i].binding[0].type=="measureValuesGroup"&&r[i].binding[0].index>=l){l=r[i].binding[0].index+1}}var h={};h.feedId=f.id;h.binding=[];h.binding[0]={};h.binding[0].type="measureValuesGroup";h.binding[0].index=l;r.push(h);return{"nb":b,"mgIndex":l}}return null};F._buildFakeMeasureValues=function(a){var v=[];var c=a[0];var i=0;if(a.length==1){for(i=0;i<c;i++){v[i]=Math.round(Math.random()*100)}}else{a.shift();for(i=0;i<c;i++){v[i]=F._buildFakeMeasureValues(a)}}return v};F._buildFakeDimensionValues=function(n){var d=[];for(var i=0;i<n;i++){d[i]=i.toString()}return d};F._buildFakeGeoInfos=function(n){var f=[];for(var i=0;i<n;i++){f[i]=''}return f};F._isGeoOrNor=function(t){if(t.search('geo')==-1&&t.search('choropleth')==-1){return false}else{return true}};return F});define('sap/viz/controls/common/feeds/FeedUtils',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/FakeDataUtils'],function(C,F,b,A,U,c){var d={};d.MultiplierFeedingName='multiplier';d.RowsFeedingName='multiplier.row';d.ColumnsFeedingName='multiplier.column';d.trillisFeeds={'id':'multiplier','row':{id:'multiplier.row',maxStacked:3,minStacked:0,type:'Dimension'},'column':{id:'multiplier.column',maxStacked:3,minStacked:0,type:'Dimension'}};d.geoFeeds={'id':'geoFeatures'};d.MaxDemensionFeedsCount=2;d._mapFeedItem=function(f,a,t){var e=f.id();var i;var g=null;for(i=0;i<a.length;i++){if(a[i].id===e){g=a[i];break}}if(g===null){return f}var h=f.type();var j='aaIndex';if(h!==b.DIMENSION){j='mgIndex'}var r=null;for(i=0;i<t.length;i++){if(t[i][j]===g[j]){r=new F(t[i].id,h,f.values());t.splice(i,1);return r}}for(i=0;i<t.length;i++){if(h===t[i].type&&t[i].id!==d.MultiplierFeedingName){r=new F(t[i].id,h,f.values());t.splice(i,1);return r}}return r};d._idEquals=function(f,a){var i=f.id();var r=false;if(i===a.id){r=true}else if(a.id===d.MultiplierFeedingName&&(i===d.RowsFeedingName||i===d.ColumnsFeedingName)){r=true}return r};d.getVizFeeds=function(v){var a=sap.viz.api.manifest.Viz.get(v)[0];if(a){return a.allFeeds()}else{return null}};d.mapFeeds=function(f,a,t){if(!t||a===t||(!f)){return{'feeds':f,'feedsChanged':false}}var e=[];if(a&&U.isString(a)){e=d.getVizFeeds(a)||[]}var g=d.getVizFeeds(t);if(!g){return{'feeds':[],'feedsChanged':true}}g=g.slice();var i,n;var h=[];var l=[];var j=false;for(i=0;i<f.length;i++){var k=f[i].id();j=false;for(n=0;n<g.length;n++){if(g[n].id===k){h.push(f[i]);g.splice(n,1);j=true;break}}if(!j){l.push(f[i])}}var o;var p=false;for(i=0;i<l.length;i++){o=d._mapFeedItem(l[i],e,g);if(o){h.push(o)}if(o!==l[i]){p=true}}for(n=0;n<g.length;n++){j=false;for(var m=0;m<h.length;m++){if(d._idEquals(h[m],g[n])){j=true;break}}if(!j){p=true;if(g[n].id===d.MultiplierFeedingName){h.push(new F(d.RowsFeedingName,g[n].type,[]));h.push(new F(d.ColumnsFeedingName,g[n].type,[]))}else{h.push(new F(g[n].id,g[n].type,[]))}}}if(d.isEmptyFeeds(h)){p=false}return{'feeds':h,'feedsChanged':p}};d.canAddFeed=function(f,a,e,z){var g=a.id===d.MultiplierFeedingName;var m=0;if(g){m=z?(z==="mainPlot"?2:1):2}for(var i=0;i<f.length;i++){if(!d._idEquals(f[i],a)){continue}if((z===d.RowsFeedingName||z===d.ColumnsFeedingName)&&f[i].id()!==z){continue}var v=f[i].values();for(var j=0;j<v.length;j++){var h=v[j];if(h.id()===e.id()){if(g){if(--m===0){return false}}else{return false}}}}var t=e.type();if(t){t=t.toLowerCase()}var l=e.dataType();if(l){l=l.toLowerCase()}var n=a.id===d.geoFeeds.id?b.GEOGRAPHY:a.type;if(!d.feedCompatible(n,t,l)){return false}var o=0;var p=0;for(var k=0;k<f.length;k++){var q=f[k];if(!q.hasValues()){continue}else if(d._idEquals(q,a)){return true}else if(q.type()===b.DIMENSION){if(q.id()===d.RowsFeedingName||q.id()===d.ColumnsFeedingName){p=Math.min(1,p+1)}else{o++}}}return(o+p)<d.MaxDemensionFeedsCount};d.checkDimensionFeedItemsToLimit=function(f){var n=0;var a=0;for(var i=0;i<f.length;i++){var e=f[i];if(e.type()===b.DIMENSION&&e.hasValues()){if(e.id()===d.RowsFeedingName||e.id()===d.ColumnsFeedingName){a=Math.min(1,a+1)}else{n++}}}return(a+n)>=d.MaxDemensionFeedsCount};d.getEmptyFeedItemsId=function(f){var e=[];var h=false;for(var i=0;i<f.length;i++){var a=f[i];if(a.type()===b.DIMENSION){if(a.id()===d.RowsFeedingName||a.id()===d.ColumnsFeedingName){if(a.values().length>0){h=true}continue}if(!a.values().length){e.push(a.id())}}}if(!h){e.push(d.RowsFeedingName);e.push(d.ColumnsFeedingName)}return e};d.hasRowOrColumn=function(f){var _=false;if(!f){return _}for(var i=0;i<f.length;i++){var a=f[i];if(a.id()===d.RowsFeedingName||a.id()===d.ColumnsFeedingName||a.id()===d.MultiplierFeedingName){if(a.values().length>0){_=true;break}}}return _};d.isEmptyFeeds=function(f){if(!f){return true}for(var i=0;i<f.length;i++){var a=f[i];if(a){var v=a.values();if(v&&v.length>0){return false}}}return true};d._toMap=function(f){var m={};for(var i=0;i<f.length;i++){var a=f[i];if(!a){continue}m[a.id()]={'index':i,'item':a}}return m};d.isFeedDefinitionEqual=function(t,a){if(t===a){return true}if(!t||!a){return false}var f=d.getVizFeeds(t);var e=d.getVizFeeds(a);if(!f||!e){return false}if(f.length!==e.length){return false}for(var i=0;i<f.length;i++){var g=f[i];var h=e[i];for(var p in g){if(g.hasOwnProperty(p)){if(g[p]!==h[p]){return false}}}}return true};d.equal=function(f,a){var i;var e=d._toMap(f);var g=d._toMap(a);var h;for(h in e){if(e.hasOwnProperty(h)){var j=e[h].item;var k=j.values();var l=g[h]?g[h].item:null;var m=g[h]?l.values():null;delete g[h];if(!l){if(k.length>0){return false}}else{if(m.length!==k.length){return false}else{var n;var o=d._toMap(k);var p=d._toMap(m);for(var q in o){if(o.hasOwnProperty(q)){if(p[q]===undefined){return false}else if(o[q].index!==p[q].index){return false}else if(!o[q].item.equal(p[q].item)){return false}}}}}}}for(h in g){if(g.hasOwnProperty(h)){var r=g[h].item;var s=r.values();if(s.length>0){return false}}}return true};d.cloneFeeds=function(f){if(!f){return null}if(f.length===0){return[]}var r=[];for(var i=0;i<f.length;i++){var a=f[i];r.push(a.clone())}return r};d.feedHasValue=function(n,f){if(!n||!f){return false}var r=false;var a=f.values();for(var i=0;i<a.length;i++){if(a[i].id()===n.id()){r=true;break}}return r};d.buildMNDFeedings=function(f,t){if(!f){return}var a=sap.viz.api.manifest.Viz;var e=a.get(t)[0];var g=e.allFeeds();var m={feedId:null,index:-1,priority:-1};for(var i=0;i<g.length;i++){var I=g[i].id;var h=g[i];var k=false;for(var j=0;j<f.length;j++){if(f[j].feedId===I){if(f[j].binding.length<h.min){if(d.canAcceptMND(h.acceptMND)){m={feedId:I,index:j,priority:h.acceptMND}}}k=true;break}}if(!k){if(h.min>0&&d.canAcceptMND(h.acceptMND)){m={feedId:I,index:-1,priority:h.acceptMND}}}}var l=f;if(l&&m.index>=0){l[m.index].binding.push({"type":"measureNamesDimension"})}else if(l&&m.feedId){l.push({binding:[{"type":"measureNamesDimension"}],feedId:m.feedId})}return l};d._useFullHierarchies=function(f,a,e){var r=true;if(f==="geoFeatures"){r=false}else if(U.isNumber(a.maxStackedDims)){var s=0;for(var j=0;j<e.length;j++){var g=e[j];if(g.type()===A.HIERARCHY){var l=g.hierarchyLevels();for(var k=0;k<l.length;k++){s++;if(l[k].selected()){break}}}else if(g.type()===A.DIMENSION){s++}}if(a.maxStackedDims<s){r=false}}return r};d.buildFeedings=function(t,f,a){a=JSON.parse(JSON.stringify(a.data()));var i;var v=d.getManifestFeedsMap(t);var e=d._getFeedsValuesMap(f);d._adjustMND(f,e);var g=[];var h={};for(i in e){if(e.hasOwnProperty(i)){var l=v[i];if(!l){continue}var m;var n;if(h[i]){m=h[i];n=m.binding}else{m=h[i]||{'feedId':l.id,'binding':[]};n=m.binding;m.binding=n;h[i]=m;g.push(m)}var o;var p=e[i];var q=[];if(p.length>0){var r=false;for(var j=0;j<p.length;j++){var s=p[j];if(s.type()===A.HIERARCHY){var u=d._useFullHierarchies(i,l,p);for(var k=0;k<s.hierarchyLevels().length;k++){var w=s.hierarchyLevels()[k];if(u){q.push(w.name())}if(w.selected()){if(!u){q.push(w.name())}break}}}else if(s.type()!==A.MND){q.push(s.name())}r=r||s.type()===A.MND}if(l.type==='Dimension'&&q.length>0){n.push({'type':'analysisAxis','index':d._findBindingIndex(a.analysisAxis,q)})}else if(l.type==='Measure'&&q.length>0){n.push({'type':'measureValuesGroup','index':d._findBindingIndex(a.measureValuesGroup,q)})}if(r){var x={"type":"measureNamesDimension"};if(p[0].type()===A.MND){n.splice(0,0,x)}else{n.push(x)}}}}}return g};d._adjustMND=function(f,a){var m=a['multiplier'];if(m){var e=d.getNumberOfDimensionsInColumn(f);var r=m.length-e;if(r>0&&e>0){for(var i=0;i<m.length;i++){if(m[i].type()===A.MND){if(i>0&&i<r+e-1){var g=m[i];if(i<r){m.unshift(g);m.splice(i+1,1)}else{m.push(g);m.splice(i,1)}}break}}}}};d._findBindingIndex=function(a,e){for(var i=0;i<a.length;i++){var f=a[i];if(f.data.length!==e.length){continue}var m=true;for(var j=0;j<f.data.length;j++){m=m&&f.data[j].name===e[j]}if(m){a.splice(i,1);return f.index}}};d.removeRowAndColumnFeedItems=function(f){var r=d.cloneFeeds(f);var l=r.length;while(l){var a=l-1;var e=r[a];if(e.id()===d.RowsFeedingName||e.id()===d.ColumnsFeedingName||e.id()===d.MultiplierFeedingName){r.splice(a,1)}l--}return r};d.getNumberOfDimensionsInColumn=function(f){var n=0;f.forEach(function(a){if(a.id()===d.ColumnsFeedingName){var e=a.values();e.forEach(function(g){if(g.type()===A.HIERARCHY){var l=g.hierarchyLevels();for(var i=0;i<l.length;i++){n++;if(l[i].selected()){break}}}else{n++}});return}});return n};d.buildFeedingsWithFakeData=function(v,f,a){var a=JSON.parse(JSON.stringify(a.data()));var e=c.buildFakeData(v,f,a).feeding;return e};d.meetMinDimensions=function(t,f){var i;var v=d.getManifestFeedsMap(t);var a=d._getFeedsValuesMap(f);for(i in v){var e=v[i];var g=a[i];var l=e.type.toLowerCase();if(A.compatible(A.DIMENSION,l)){var n=d.countDataContainers(g);if(n<e.min){return false}}}return true};d.removeMND=function(f){var a=[];for(var i=0;i<f.length;i++){var e=f[i].clone();var v=e.values();for(var j=0;j<v.length;j++){var g=v[j];if(A.compatible(A.MND,g.type())){v.splice(j,1);j--}}a.push(e)}return a};d.hasMND=function(f){return d.countAnalyses(f,A.MND)>0};d.countAnalyses=function(f,t){var n=0;for(var i=0;i<f.length;i++){var a=f[i];var v=a.values();for(var j=0;j<v.length;j++){var e=v[j];if(A.compatible(t,e.type())){n++}}}return n};d.convertFeedType=function(f){if(f===b.GEOGRAPHY){return b.DIMENSION}return f};d.isGeoHierarchyFeed=function(f,a,e){var l=f?f.toLowerCase():null;var g=a?a.toLowerCase():null;var h=e?e.toLowerCase():null;return l===b.GEOGRAPHY.toLowerCase()&&g===A.HIERARCHY&&h===b.GEOGRAPHY.toLowerCase()};d.feedCompatible=function(f,a,e){var l=f?f.toLowerCase():null;var g=a?a.toLowerCase():null;var h=e?e.toLowerCase():null;if(l===b.DIMENSION.toLowerCase()){return g===A.DIMENSION||g===A.HIERARCHY||g===A.MND}else if(l===b.GEOGRAPHY.toLowerCase()){return(g===A.DIMENSION||g===A.HIERARCHY)&&h===b.GEOGRAPHY.toLowerCase()}else{return l===g}};d.getManifestFeedsMap=function(t){var v=d.getVizFeeds(t);if(!v){return{}}var a={};for(var i=0;i<v.length;i++){a[v[i].id]=v[i]}return a};d._getFeedsValuesMap=function(f,m){m=m!==false;var a={};for(var i=0;i<f.length;i++){var e=f[i];var g=e.id();if(m&&(g===d.RowsFeedingName||g===d.ColumnsFeedingName)){g='multiplier'}if(!a[g]){a[g]=e.values()}else{a[g]=a[g].concat(e.values())}}return a};d.countDataContainers=function(v){if(!v){return 0}var n=0,e=0,f=0;for(var i=0;i<v.length;i++){var a=v[i];if(A.compatible(A.MEASURE,a.type())){n++}else{if(A.compatible(A.MND,a.type())){f++}else if(A.compatible(A.DIMENSION,a.type())){e++}}}return n+Math.min(1,e)+Math.min(1,f)};d.countAAOfFeeds=function(f){var n=0;var a=0;for(var i=0;i<f.length;i++){var e=f[i];if(e.type()===b.DIMENSION&&d.countAAOfFeedItem(e)){if(e.id()===d.RowsFeedingName||e.id()===d.ColumnsFeedingName){a=Math.min(1,a+1)}else{n++}}}return(a+n)};d.countAAOfValues=function(v){if(!v||!v.length){return 0}var h=d.hasMNDInValues(v);if(h&&v.length===1){return 0}return 1};d.countAAOfFeedItem=function(f){if(!f||!f.hasValues()){return 0}var v=f.values();return d.countAAOfValues(v)};d.hasMNDInValues=function(v){return(d.indexOfMNDInValues(v)!==-1)};d.indexOfMNDInValues=function(v){if(!v||!v.length){return-1}var a=-1;for(var i=0;i<v.length;i++){var e=v[i];if(e.type()===A.MND){a=i;break}}return a};d._getCapacityOfFeedDef=function(f){var r=0;if(f.type===b.DIMENSION){if(f.id===d.RowsFeedingName||f.id===d.ColumnsFeedingName||f.id===d.MultiplierFeedingName){r=d.trillisFeeds.row.maxStacked}else{r=f.maxStackedDims?f.maxStackedDims:Number.MAX_VALUE}}else{r=f.max=='Infinity'?Number.MAX_VALUE:f.max}return r};d.canAddValue=function(f,a,e,i,g){if(!e){return false}var h=d._toMap(f);var j=h[a]?h[a].item:null;var v=j?j.values():[];if(a===d.RowsFeedingName||a===d.ColumnsFeedingName){v=d.getRowAndColumnValues(f)}var k;if(g){k=d.canAcceptMND(e.acceptMND)}else{k=d._canAddValueAtAALimitaion(f,v)}if(k){var m=e.max;k=d._canAddValueAtDataContainerLimitaion(v,m,i,g);if(k){var l=d._getCapacityOfFeedDef(e);k=d._canAddValueAtCapacityLimitaion(j,l)}}return k};d._canAddValueAtAALimitaion=function(f,v){var a=d.countAAOfFeeds(f);var e=(a<=d.MaxDemensionFeedsCount);if(e){var g=d.countAAOfValues(v);if(g===0){var h=a+1;if(h>d.MaxDemensionFeedsCount){e=false}}}return e};d._canAddValueAtDataContainerLimitaion=function(v,m,i,a){var n=d.countDataContainers(v);if(n>m){return false}var e=(m>0&&(n<=m));if(e&&n===m){var h=d.hasMNDInValues(v);if(a){if(!h){if(n===1){e=false}else if(n===2){}}else{e=false}}else{if(!h){if(n===1){e=true}else if(n===2){}}else{if(n===1){if(i){e=false}else{e=true}}else if(n===2){e=true}}}}return e};d._canAddValueAtCapacityLimitaion=function(f,a){var v=f?f.values().length:0;return(v<a)};d.canAcceptMND=function(a){a=U.isNumber(a)?Number(a):-1;return(a>=0)};d.supportMultiChart=function(f,a){if(!f){return true}var i;var e;var g;var n;var h;for(i=0;i<f.length;i++){e=f[i];g=e.id();if(g===d.RowsFeedingName||g===d.ColumnsFeedingName){h=a[d.MultiplierFeedingName]}else{h=a[g]}n=d.countDataContainers(e.values());if(h&&n>h.max){return false}}return true};d.getRowAndColumnValues=function(f){if(!f){return null}var i;var a;var e;var n;var r=[];for(i=0;i<f.length;i++){a=f[i];e=a.id();if(e===d.RowsFeedingName||e===d.ColumnsFeedingName){r=r.concat(a.values())}}return r};d.match=function(t,f,s){var a=require('sap/viz/controls/common/utils/ChartTypeUtil');if(!s&&a.supportMultiChart(t)){var e=a.toSingleChartType(t);var m=a.toMultiChartType(t);return d.match(e,f,true)||d.match(m,f,true)}else{var v=d.getManifestFeedsMap(t);var g=d._getFeedsValuesMap(f);var i;for(i in g){if(g.hasOwnProperty(i)){var h=v[i];if(!h){return false}}}return true}};d.buildEmptyFeeds=function(v){var e=[];var t=d.getVizFeeds(v);if(t){for(var i=0;i<t.length;i++){var a=t[i];if(a.id===d.MultiplierFeedingName){e.push(new F(d.RowsFeedingName,a.type,[]));e.push(new F(d.ColumnsFeedingName,a.type,[]))}else{e.push(new F(a.id,a.type,[]))}}}else{}return e};d.merge=function(h,a){var e=d._getFeedsValuesMap(a,false);for(var i=0;i<h.length;i++){var f=h[i];if(e[f.id()]){f.values(f.values().concat(e[f.id()]))}}return h};d.getFeed=function(f,a){for(var i=0;i<f.length;i++){var e=f[i];if(e.id()===a){return e}}return null};return d});define('sap/viz/controls/common/utils/TrellisUtils',['sap/viz/controls/common/constants/ChartConst'],function(C){var t={};var T={};T.TRELLIS='trellis';T.MULTIPLE='multi';T._register=function(p,a){if(a){t[a]=p}else{t['_default']=p}};T._getProvider=function(a){var p=t[a];if(!p){p=t['_default']}return p};T.providerName=function(a){var p=T._getProvider(a);return p.name};T.isMultipleChart=function(a){if(!a){return false}var p=T._getProvider(a);return p.isMultipleChart(a)};T.supportMultiChart=function(a){if(!a){return false}var p=T._getProvider(a);return p.supportMultiChart(a)};T.toSingleChartType=function(a){if(!a){return a}var p=T._getProvider(a);return p.toSingleChartType(a)};T.toMultiChartType=function(a){if(!a){return a}var p=T._getProvider(a);if(p.isMultipleChart(a)){return a}else{return p.toMultiChartType(a)}};function c(n){var v='viz/'+n+'_';var p={name:n};p.isMultipleChart=function(a){if(!a){return false}return(a.indexOf(v)===0)};p.supportMultiChart=function(a){if(a.indexOf(v)===0){return true}var m=p.toMultiChartType(a);if(m!==a){return true}else{return false}};p.toSingleChartType=function(a){if(p.isMultipleChart(a)){return a.replace(v,'viz/')}return a};p.toMultiChartType=function(a){var m=a.replace('viz/',v);if(sap.viz.api.manifest.Viz.get(m)[0]){return m}return a};return p}T._register(c(T.MULTIPLE));return T});define('sap/viz/controls/common/utils/ChartTypeUtil',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/TrellisUtils'],function(C,D,L,F,T){var a={};a._CVOM_TYPE_MAPPING=function(){var m={};var b=function(c,v,d,e){var p={vizType:v};if(d){p.vizDirection=d}if(e){p.vizStacking=e}m[c]=p};b(C.TYPE_BAR,C.TYPE_COLUMN,C.DIRECTION_HORIZONTAL);b(C.TYPE_COLUMN,C.TYPE_COLUMN,C.DIRECTION_VERTICAL);b(C.TYPE_STACKED_BAR,C.TYPE_STACKED_COLUMN,C.DIRECTION_HORIZONTAL,C.STACKING_NORMAL);b(C.TYPE_100_STACKED_BAR,C.TYPE_STACKED_COLUMN,C.DIRECTION_HORIZONTAL,C.STACKING_FULL);b(C.TYPE_STACKED_COLUMN,C.TYPE_STACKED_COLUMN,C.DIRECTION_VERTICAL,C.STACKING_NORMAL);b(C.TYPE_100_STACKED_COLUMN,C.TYPE_STACKED_COLUMN,C.DIRECTION_VERTICAL,C.STACKING_FULL);b(C.TYPE_DUAL_BAR,C.TYPE_DUAL_COLUMN,C.DIRECTION_HORIZONTAL);b(C.TYPE_DUAL_COLUMN,C.TYPE_DUAL_COLUMN,C.DIRECTION_VERTICAL);b(C.TYPE_3D_BAR,C.TYPE_3D_COLUMN,C.DIRECTION_HORIZONTAL);b(C.TYPE_3D_COLUMN,C.TYPE_3D_COLUMN,C.DIRECTION_VERTICAL);b(C.TYPE_HORIZONTAL_LINE,C.TYPE_LINE,C.DIRECTION_HORIZONTAL);b(C.TYPE_LINE,C.TYPE_LINE,C.DIRECTION_VERTICAL);b(C.TYPE_HORIZONTAL_AREA,C.TYPE_AREA,C.DIRECTION_HORIZONTAL,C.STACKING_NORMAL);b(C.TYPE_100_HORIZONTAL_AREA,C.TYPE_AREA,C.DIRECTION_HORIZONTAL,C.STACKING_FULL);b(C.TYPE_AREA,C.TYPE_AREA,C.DIRECTION_VERTICAL,C.STACKING_NORMAL);b(C.TYPE_100_AREA,C.TYPE_AREA,C.DIRECTION_VERTICAL,C.STACKING_FULL);b(C.TYPE_HORIZONTAL_COMBINATION,C.TYPE_COMBINATION,C.DIRECTION_HORIZONTAL);b(C.TYPE_COMBINATION,C.TYPE_COMBINATION,C.DIRECTION_VERTICAL);b(C.TYPE_DUAL_HORIZONTAL_LINE,C.TYPE_DUAL_LINE,C.DIRECTION_HORIZONTAL);b(C.TYPE_DUAL_LINE,C.TYPE_DUAL_LINE,C.DIRECTION_VERTICAL);b(C.TYPE_DUAL_HORIZONTAL_COMBINATION,C.TYPE_DUAL_COMBINATION,C.DIRECTION_HORIZONTAL);b(C.TYPE_DUAL_COMBINATION,C.TYPE_DUAL_COMBINATION,C.DIRECTION_VERTICAL);b(C.TYPE_HORIZONTAL_BOXPLOT,C.TYPE_BOXPLOT,C.DIRECTION_HORIZONTAL);b(C.TYPE_BOXPLOT,C.TYPE_BOXPLOT,C.DIRECTION_VERTICAL);b(C.TYPE_HORIZONTAL_WATERFALL,C.TYPE_WATERFALL,C.DIRECTION_HORIZONTAL);b(C.TYPE_WATERFALL,C.TYPE_WATERFALL,C.DIRECTION_VERTICAL);return m};a._VIZ_TYPE_MAPPING=function(){var m={};var b=function(v,i){var n;if(v===C.TYPE_TABLE){n=L.get('VIZ_COMMON_TABLE_TEXT')}else{var c=sap.viz.api.manifest.Viz.get(v)[0];n=c?c.name:v}m[v]={'id':v,'caption':n,'icon':i,'whiteIcon':i+'-white','greyIcon':i+'-grey'}};b(C.TYPE_COLUMN,'column');b(C.TYPE_STACKED_COLUMN,'stacked-column');b(C.TYPE_DUAL_COLUMN,'dual-column');b(C.TYPE_3D_COLUMN,'3D-column');b(C.TYPE_LINE,'line');b(C.TYPE_AREA,'area');b(C.TYPE_COMBINATION,'combination');b(C.TYPE_DUAL_LINE,'dual-line');b(C.TYPE_DUAL_COMBINATION,'dual-combination');b(C.TYPE_PIE,'pie');b(C.TYPE_DONUT,'donut');b(C.TYPE_PIE_WITH_DEPTH,'pie-with-depth');b(C.TYPE_GEO_BUBBLE,'geo-bubble');b(C.TYPE_GEO_CHOROPLETH,'geo-choropleth');b(C.TYPE_GEO_PIE,'geo-pie');b(C.TYPE_GEO_MAP,'geo-map');b(C.TYPE_SCATTER,'scatter');b(C.TYPE_BUBBLE,'bubble');b(C.TYPE_SCATTER_MATRIX,'scatter-matrix');b(C.TYPE_HEATMAP,'heatmap');b(C.TYPE_TREEMAP,'treemap');b(C.TYPE_TABLE,'table');b(C.TYPE_RADAR,'radar');b(C.TYPE_BOXPLOT,'boxplot');b(C.TYPE_WATERFALL,'waterfall');b(C.TYPE_TAG_CLOUD,'tag-cloud');b(C.TYPE_TREE,'tree');b(C.TYPE_NETWORK,'network');b(C.TYPE_FUNNEL,'funnel');b(C.TYPE_PC,'pc');return m};a.getVizTypeObject=function(v){if(a.VIZ_TYPE__MAPPING==null){a.VIZ_TYPE__MAPPING=a._VIZ_TYPE_MAPPING()}var t=a.VIZ_TYPE__MAPPING[v];if(t){t=JSON.parse(JSON.stringify(t))}return t};a.toVizProperties=function(c){if(a.CVOM_TYPE_MAPPING==null){a.CVOM_TYPE_MAPPING=a._CVOM_TYPE_MAPPING()}var p=a.CVOM_TYPE_MAPPING[c];if(!p){p={vizType:c}}return p};a.fromVizProperties=function(t,v,b){if(!v&&!b){return t}var c=a.toVizProperties(t).vizType;for(var d in a.CVOM_TYPE_MAPPING){if(a.CVOM_TYPE_MAPPING.hasOwnProperty(d)){var p=a.CVOM_TYPE_MAPPING[d];if(p.vizType===c&&(!v||!p.vizDirection||p.vizDirection===v)&&(!b||!p.vizStacking||p.vizStacking===b)){return d}}}return t};a.updateType=function(t,o){var n=t;if(o.hasOwnProperty("direction")){n=a.changeDirection(n,o["direction"]);o["direction"]=undefined}if(o.hasOwnProperty("stacking")){n=a.changeStacking(n,o["stacking"]);o["stacking"]=undefined}return n};a.isMultipleChart=function(t){return T.isMultipleChart(t)};a.toMultiChartType=function(t){return T.toMultiChartType(t)};a.toSingleChartType=function(t){return T.toSingleChartType(t)};a.supportMultiChart=function(v){return T.supportMultiChart(v)};a.getDirection=function(t){var c=a.toSingleChartType(t);var b=a.toVizProperties(c);if(b.vizDirection){return b.vizDirection}return null};a.getStacking=function(t){var c=a.toSingleChartType(t);var b=a.toVizProperties(c);if(b.vizStacking){return b.vizStacking}return null};a.changeDirection=function(t,d){var c=a.toSingleChartType(t);var b=a.getDirection(c);if(b===d||!b){return t}var s=a.getStacking(c);var n=a.fromVizProperties(c,d,s);if(a.isMultipleChart(t)){return a.toMultiChartType(n)}return n};a.changeStacking=function(t,s){var c=a.toSingleChartType(t);var b=a.getStacking(c);if(b===s||!b){return t}var d=a.getDirection(c);var n=a.fromVizProperties(c,d,s);if(a.isMultipleChart(t)){return a.toMultiChartType(n)}return n};a.getType=function(t,v){if(!t){return v}var c=a.toSingleChartType(t);var d=a.getDirection(c);var s=a.getStacking(c);c=a.fromVizProperties(v,d,s);if(a.isMultipleChart(t)){return a.toMultiChartType(c)}return c};a.getVizType=function(t){var c=a.toSingleChartType(t);return a.toVizProperties(c).vizType};a.getDatasetType=function(t){if(a.isGeo(t)){return D.FlatTableDataset}else if(a.isTable(t)){return D.RawDataset}else{return D.CrosstableDataset}};a.isTable=function(t){return(t===C.TYPE_TABLE)};a.isGeo=function(t){return(t===C.TYPE_GEO_MAP)};a.getColumnFeeding=function(f){var c=null;for(var i=0;i<f.length;i++){var b=f[i].id();if(b===F.trillisFeeds.column.id){c=f[i]}}return c};a.supportTitle=function(t){if(a.isGeo(t)||a.isTable(t)){return false}else{return true}};a.supportMND=function(t){var v=F.getVizFeeds(t);for(var i=0;i<v.length;i++){var b=v[i].acceptMND;if(F.canAcceptMND(b)){return true}}return false};a.isBuildInType=function(t){return sap.viz.api.manifest.Viz.get(t)[0].isBuiltIn};return a});define('sap/viz/controls/common/events/EventDispatcher',['sap/viz/controls/common/utils/Utils'],function(u){var E=function(){this.__className="sap.viz.controls.common.events.EventDispatcher";this._enableDispatchEvent=true};E.prototype.addEventListener=function(t,l,s,p){if(!p){p=0}var e=this._findEventListener(t,l,s);if(e){return}e={type:t,scope:s,listener:l,priority:p};var a=this.listeners()[t];if(!a){this.listeners()[t]=a=[e]}else{var i=false;for(var n=0;n<a.length;++n){var b=a[n];if(p>b.priority){a.splice(n,0,e);i=true;break}}if(i===false){a.push(e)}}};E.prototype.removeEventListener=function(t,l,s){var e=this._findEventListener(t,l,s);if(e){var a=this.listeners()[t];a.splice(a.indexOf(e),1)}};E.prototype.removeEventListeners=function(t){this.listeners()[t]=[]};E.prototype.removeAllEventListeners=function(){this._listeners={}};E.prototype.hasEventListener=function(t,l,s){var e=this._findEventListener(t,l,s);return!e};E.prototype.hasEventListeners=function(t){var l=this.listeners()[t];if(l){return l.length>0}return false};E.prototype._dispatchEvent=function(e){if(this._enableDispatchEvent===undefined){this._enableDispatchEvent=true}if(this._enableDispatchEvent){var t=e.type();var l=this.listeners()[t];if(l){var c=l.slice(0);for(var n=0;n<c.length;++n){var a=c[n];a.listener.call(a.scope,e)}}}};E.prototype.enableDispatchEvent=function(v){if(this._enableDispatchEvent===undefined){this._enableDispatchEvent=true}if(arguments.length>=1){if(u.isBoolean(v)){this._enableDispatchEvent=v}return this}else{return this._enableDispatchEvent}};E.prototype._findEventListener=function(t,l,s){var a=this.listeners()[t];if(!a){return null}for(var n=0;n<a.length;++n){var e=a[n];if(e.listener===l&&e.scope===s){return e}}return null};E.prototype.listeners=function(){if(this._listeners===undefined){this._listeners={}}return this._listeners};return E});define('sap/viz/controls/common/UIControl',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/utils/Utils'],function($,O,E,u){var U=function U(d,a){U.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.UIControl";this._dom=d;this._dom$=$(d);this._uiConfig=a;this._uid=u.genUID()};O.extend(U,E);U.prototype.size=function(v){if(arguments.length>0){if(v.width!=null){this._dom$.width(v.width)}if(v.height!=null){this._dom$.height(v.height)}this._validateSize();return this}else{return{'width':this._dom$.width(),'height':this._dom$.height()}}};U.prototype._validateSize=function(){};U.prototype.visible=function(v){this._dom$.css("visibility",v?"visible":"hidden");return this};U.prototype.destroy=function(){this._dom$.removeData().off().find('*').removeData().off();this._dom$.empty();this._dom=null};return U});define('sap/viz/controls/runtime/Runtime',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher'],function(O,E,a){var R=function(){this._models={};this._modelRefs={}};O.extend(R,a);R.prototype.registerModel=function(u,m){this._models[u]=m;this._modelRefs[u]=1};R.prototype.addModelRef=function(u){this._modelRefs[u]++};R.prototype.removeModelRef=function(u){this._modelRefs[u]--;if(this._modelRefs[u]===0){this._models[u]=null}};R.prototype.getModel=function(u){return this._models[u]};return R});define('sap/viz/controls/runtime/RuntimeManager',['sap/viz/controls/runtime/Runtime'],function(R){var _=null;var a={};a.getRuntime=function(){if(_===null){_=new R()}return _};return a});define('sap/viz/controls/common/feeds/valueobjects/Shelf',[],function(){var S=function(){this.id=null;this.name=null;this.type=null;this.analysisType=null;this.feedItemType=null;this.capacity=0};return S});define('sap/viz/controls/common/feeds/valueobjects/ShelfType',[],function(){var S=function(){};S.MEASURE='measure';S.ATTRIBUTE='attribute';S.TRELLIS='trellis';return S});define('sap/viz/controls/common/feeds/AutoFeedingUtils',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/valueobjects/Shelf','sap/viz/controls/common/feeds/valueobjects/ShelfType','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil'],function(C,F,a,A,L,S,b,U,c,d){var e={};e.getInitialShelves=function(t){var f={"measure":[],"attribute":[],"trellis":[]};var g=e.getFeedDefsMap(t);if(g){var m=g.measure;var h=e._getSortedIds(m,false);var k;var l;for(var i=0;i<h.length;i++){k=h[i];l=m[k];f["measure"].push(e._getShelfByFeedDef(l,b.MEASURE,t))}var n=g.dimension;var o=e._getSortedIds(n,true);for(var j=0;j<o.length;j++){k=o[j];l=n[k];if(k===c.RowsFeedingName||k===c.ColumnsFeedingName){f["trellis"].push(e._getShelfByFeedDef(l,b.TRELLIS))}else{f["attribute"].push(e._getShelfByFeedDef(l,b.ATTRIBUTE))}}if(!d.isMultipleChart(t)&&d.supportMultiChart(t)){f["trellis"].push(e._getShelfByFeedDef(c.trillisFeeds.row,b.TRELLIS));f["trellis"].push(e._getShelfByFeedDef(c.trillisFeeds.column,b.TRELLIS))}}return f};e._getShelfByFeedDef=function(f,g,t){var v=d.getVizType(t);var h=new S();h.id=f.id;h.type=g;if(h.id==="primaryValues"){if(v===C.TYPE_BUBBLE){h.name=L.get(s[h.id][1])}else if(v===C.TYPE_SCATTER||v===C.TYPE_DUAL_COLUMN||v===C.TYPE_DUAL_LINE||v===C.TYPE_DUAL_COMBINATION||v===C.TYPE_DUAL_BAR||v===C.TYPE_DUAL_HORIZONTAL_LINE||v===C.TYPE_DUAL_HORIZONTAL_COMBINATION){h.name=L.get(s[h.id][2])}else{h.name=L.get(s[h.id][0])}}else if(h.id==="secondaryValues"){h.name=v===C.TYPE_BUBBLE?L.get(s[h.id][1]):L.get(s[h.id][0])}else{h.name=L.get(s[h.id])}if(!h.name){h.name=f.name}h.analysisType=f.type.toLowerCase();h.feedItemType=h.id===c.geoFeeds.id?a.GEOGRAPHY:f.type;h.capacity=f.maxStacked;return h};e.smartFeeding=function(f,g,h){return e._autoFeedItems(e._STRATEGY_SMART,f,g,h)};e.directFeeding=function(f,g,h){return e._autoFeedItems(e._STRATEGY_DIRECT,f,g,h)};e._STRATEGY_SMART='smart';e._STRATEGY_DIRECT='direct';e._autoFeedItems=function(f,g,t,h){g=c.cloneFeeds(g);var j=e.getFeedDefsMap(t);var p=e._prepareData(g);if(!j||!p){return g}var k={'measure':[],'dimension':[]};h=h||[];for(var i=0;i<h.length;i++){var l=h[i];if(A.compatible(A.MEASURE,l.type())){k.measure.push(l)}else{if(A.compatible(A.DIMENSION,l.type())){k.dimension.push(l)}}}var m=e._mapFeedsProcess(f,p.measure,j.measure,false,k.measure);var n=e._mapFeedsProcess(f,p.dimension,j.dimension,true,k.dimension);var o=m.concat(n);return o};e.needAutoFeeding=function(f,g,t){var n=true;if(!t||g===t||(!f)){n=false}return n};e.getFeedDefsMap=function(v){var m={'measure':{},'dimension':{}};var t=c.getVizFeeds(v);if(t){for(var i=0;i<t.length;i++){var f=t[i];if(f.type===a.MEASURE){m.measure[f.id]=e._addMinAndMaxStackedToFeedDef(f)}else if(f.type===a.DIMENSION){if(f.id===c.MultiplierFeedingName){var r=U.clone(f);r.id=c.RowsFeedingName;m.dimension[c.RowsFeedingName]=e._addMinAndMaxStackedToFeedDef(r,true);var g=U.clone(f);g.id=c.ColumnsFeedingName;m.dimension[c.ColumnsFeedingName]=e._addMinAndMaxStackedToFeedDef(g,true)}else{m.dimension[f.id]=e._addMinAndMaxStackedToFeedDef(f,true)}}}}else{return null}return m};e._addMinAndMaxStackedToFeedDef=function(f,i){var r=U.clone(f);if(i){if(f.id===c.RowsFeedingName){r.minStacked=c.trillisFeeds.row.minStacked;r.maxStacked=c.trillisFeeds.row.maxStacked}else if(f.id===c.ColumnsFeedingName){r.minStacked=c.trillisFeeds.column.minStacked;r.maxStacked=c.trillisFeeds.column.maxStacked}else{var m=0;if(f.min){m=f.minStackedDims?f.minStackedDims:f.min}r.minStacked=m;var g=f.maxStackedDims?f.maxStackedDims:Number.MAX_VALUE;r.maxStacked=g}}else{r.minStacked=f.min;r.maxStacked=f.max=='Infinity'?Number.MAX_VALUE:f.max}return r};e._prepareData=function(f){var M=[];var D=[];if(f.length>0){for(var i=0;i<f.length;i++){var g=f[i];if(g.type()===a.MEASURE){M.push(g)}else if(g.type()===a.DIMENSION){D.push(g)}}}return{'measure':M,'dimension':D}};e._mapFeedsProcess=function(f,g,h,i,p){var r=e._idMapping(g,h);var t=r.feeds;p=r.pool.concat(p||[]);var j=e._getSortedIds(h,i);if(i){var k=c.indexOfMNDInValues(p);if(k!==-1){var m=p[k];p.splice(k,1);e._autoFeedMNDValue(j,h,t,m)}if(f===e._STRATEGY_SMART){e._feedGeographyFeedItem(j,h,t,p)}}var l=e._precalFeedItemValuesSize(f,j,h,t,p.length,i);var n=e._locateValuestoFeeds(j,h,t,p,l);var o=e._convertToFeeds(j,n);return o};e._idMapping=function(f,g){var t={};var p=[];var m;var r=c.getRowAndColumnValues(f);for(var i=0;i<f.length;i++){var h=f[i];var j=h.id();var v=h.values();v=v?v:[];var k=e._getIdByShelfName(j,g);if(k){var l=g[k].maxStacked;var n=c.canAcceptMND(g[k].acceptMND);var o=c.indexOfMNDInValues(v);var q=false;if(!n){q=true}else{if(o>l){q=true}else{var u=g[k].max;var w;var x=-1;if(j===c.RowsFeedingName||j===c.ColumnsFeedingName){w=c.countDataContainers(r);x=c.indexOfMNDInValues(r)}else{w=c.countDataContainers(v)}if(w>u){if(j===c.RowsFeedingName||j===c.ColumnsFeedingName){if(x===0){if(o===0){l=1}else if(o===-1){l=0}}else{q=true;if(o!==-1&&x!==-1){r.splice(x,1);}}}else{if(o===0){l=1}else{q=true}}}}}if(q&&o!==-1){m=v[o];v.splice(o,1);e._pushFeedItemValuesToPool([m],p)}if(l<v.length){var y=v.slice(l,v.length);e._pushFeedItemValuesToPool(y,p);var z=v.slice(0,l);var B=new F(k,h.type(),z);t[k]=B}else{t[k]=new F(k,h.type(),v)}}else{e._pushFeedItemValuesToPool(v,p)}}return{'feeds':t,'pool':p}};e._autoFeedMNDValue=function(f,g,h,m){var j=-1;var k;var l=e._convertToFeeds(f,h);for(var i=0;i<f.length;i++){var n=f[i];var o=g[n];var p=true;var q=true;var r=c.canAddValue(l,n,o,p,q);if(r){var t=o.acceptMND;var u=h[n];var v=u?u.values():null;var w=c.countDataContainers(v);var x=g[n].min;if(w<x){t+=10}if(t>j){j=t;k=n}}}if(k){var u=h[k];var o=g[k];var v=u?u.values():[];v.push(m);h[k]=new F(o.id,o.type,v)}};e._feedGeographyFeedItem=function(f,g,h,p){var j=g[c.geoFeeds.id];if(!j){return}var k=h[c.geoFeeds.id];if(!k){k=new F(c.geoFeeds.id,j.type,[])}var v=k.values();if(v.length>0){return}var _=function(t){var u=-1;for(var i=0;i<t.length;i++){var w=t[i];if(w.dataType()&&w.dataType().toLowerCase()===a.GEOGRAPHY.toLowerCase()){u=i;break}}return u};var n;var l=_(p);if(l!==-1){n=p[l];p.splice(l,1)}else{var m,o,q,r;for(var i=0;i<f.length;i++){m=f[i];o=g[m];q=h[m];if(m===c.geoFeeds.id||!q){continue}r=q.values();if(r.length>1&&r.length>o.minStacked){l=_(r);if(l!==-1){n=r[l];r.splice(l,1);break}}}}if(n){v.push(n);h[c.geoFeeds.id]=k}};e._getIdByShelfName=function(f,g){if(g[f]){return f}var h=s[f];for(var i in g){if(g.hasOwnProperty(i)){var j=g[i];var t=s[i];if(h===t){return i}}}return null};e._locateValuestoFeeds=function(f,g,h,p,j){var i,k,l,v,m;for(i=0;i<f.length;i++){k=f[i];l=h[k];if(l){v=l.values();m=j[k];if(v.length>m){var n=c.indexOfMNDInValues(v);if(n!==-1&&n>=m){var o=v[n];v.splice(n,1);v.splice(m-1,0,o)}var r=v.slice(m,v.length);e._pushFeedItemValuesToPool(r,p)}}}for(i=0;i<f.length;i++){k=f[i];l=h[k];if(!l){l=new F(k,g[k].type,[]);h[k]=l}var q=false;m=j[k];v=l.values();if(m<v.length){q=true;v=v.slice(0,m)}else if(m>v.length&&p.length>0){q=true;var t=[];var u=false;if(v.length>1&&v[v.length-1].type()===A.MND){u=true}while(p.length>0&&m>v.length){var w=p.shift();if(!c.feedHasValue(w,l)){if(u){v.splice(v.length-1,0,w)}else{v.push(w)}}else{t.push(w)}}if(t.length>0){p=p.concat(t)}}if(q){h[k]=new F(k,g[k].type,v)}}return h};e._pushFeedItemValuesToPool=function(f,p){for(var i=0;i<f.length;i++){var g=f[i];p.push(g)}};e._precalFeedItemValuesSize=function(f,g,h,j,p,k){var l=e._initializeId2Size(g,j);var m;if(k){m=e._getFeedsStatus(g,h,j)}var n=e._getNeedToFillFeedsId(g,l,h);var o=!n.length;var q=0;var r;var i;var t;var u;var v;var w;if(!o&&p>0){r=true;for(i=0;i<n.length;i++){q=i;t=n[i];if(k&&!m[t]){continue}u=l[t];v=h[t].minStacked;w=v-u;if(p<w){w=p;r=false}l[t]=u+w;p-=w;if(!p){break}}o=r&&(q==n.length-1)}else if(!o){if(f===e._STRATEGY_SMART){var x=e._getOverMinFeedsId(g,l,h);if(x.length>0){r=true;var y=[];var z=0;var B;for(i=0;i<x.length;i++){B=x[i];var D=l[B];var E=h[B].minStacked;var G=D-E;y[B]=G;z+=G}var H=q;for(i=q;i<n.length;i++){H=i;t=n[i];if(k&&!m[t]){continue}u=l[t];v=h[t].minStacked;w=v-u;var I=w;for(var J in y){if(y.hasOwnProperty(J)){var G=y[J];if(G<I){I-=G;l[B]-=G}else{y[B]-=I;l[B]-=I;I=0;break}}}if(I>0){w-=I;r=false}l[t]=u+w;z-=w;if(!z){break}}o=r&&(H==n.length-1)}}return l}if(o&&p>0){var K=e._getEmptyFeedsId(g,l);for(i=0;i<K.length;i++){t=K[i];if(k&&!m[t]){continue}p--;l[t]=1;if(!p){if(i<K.length){o=false}break}}}if(o&&p>0){var M=e._getNotFullFeedsId(g,l,h);for(i=0;i<M.length;i++){t=M[i];if(k&&!m[t]){continue}u=l[t];var N=h[t].maxStacked;w=N-u;if(p<w){w=p}l[t]=u+w;p-=w;if(!p){break}}}return l};e._convertToFeeds=function(f,g){var t=[];for(var i=0;i<f.length;i++){var h=f[i];var j=g[h];if(j){t.push(j)}}return t};e._getSortedIds=function(f,g){var h=[];var j=[];for(var k in f){var l=f[k];var p=g?l.aaIndex:l.mgIndex;if(k===c.RowsFeedingName||k===c.ColumnsFeedingName){p=1000+l.aaIndex}j.push({id:k,priority:p})};j.sort(function(m,n){return m.priority-n.priority});for(var i=0;i<j.length;i++){h.push(j[i].id)};return h};e._initializeId2Size=function(f,g){var h={};for(var i=0;i<f.length;i++){var j=f[i];var k=0;var l=g[j];if(l){k=l.values().length}h[j]=k}return h};e._getNeedToFillFeedsId=function(f,g,h){var j=[];for(var i=0;i<f.length;i++){var k=f[i];var l=h[k];var m=l.minStacked;var n=g[k];if(n<m){j.push(k)}}return j};e._getNotFullFeedsId=function(f,g,h){var j=[];for(var i=0;i<f.length;i++){var k=f[i];var l=h[k];var m=l.maxStacked;var n=g[k];if(n<m){j.push(k)}}return j};e._getOverMinFeedsId=function(f,g,h){var j=[];for(var i=0;i<f.length;i++){var k=f[i];var l=h[k];var m=l.minStacked;var n=g[k];if(n>1&&n>m){j.push(k)}}return j};e._getEmptyFeedsId=function(f,g){var h=[];for(var i=0;i<f.length;i++){var j=f[i];var k=g[j];if(k===0){h.push(j)}}return h};e._getFeedsStatus=function(f,g,h){var j={};var k;var _=function(v){var w=0;if(v===c.RowsFeedingName||v===c.ColumnsFeedingName){if(k!==undefined){var x=h[c.RowsFeedingName]?h[c.RowsFeedingName].item:null;var y=h[c.ColumnsFeedingName]?h[c.ColumnsFeedingName].item:null;var z=x?x.values():[];var B=y?y.values():[];var D=z.concat(B);w=c.countAAOfValues(D);k=w}else{w=k}}else{var E=h[v];w=c.countAAOfFeedItem(E)}return w};var l=e._convertToFeeds(f,h);var m=c.countAAOfFeeds(l);var n=(m<=c.MaxDemensionFeedsCount);var o=true;var p=false;for(var i=0;i<f.length;i++){var q=false;if(n){var r=f[i];if(r===c.geoFeeds.id){j[r]=false;continue}var t=g[r];q=c.canAddValue(l,r,t,o,p);if(q){var u=_(r);if(u===0){m++;if(m>c.MaxDemensionFeedsCount){q=false;m--}else if(r===c.RowsFeedingName){m--}}n=(m<=c.MaxDemensionFeedsCount)}}j[r]=q}return j};var s={"primaryValues":['VIZ_COMMON_YAXIS','VIZ_COMMON_XAXIS','VIZ_COMMON_PRIMARY_YAXIS'],"secondaryValues":['VIZ_COMMON_SECONDARY_YAXIS','VIZ_COMMON_YAXIS'],"pieSectorSize":'VIZ_COMMON_PIE_SECTORS',"pieDepthSize":'VIZ_COMMON_PIE_DEPTH',"featureValues":'VIZ_COMMON_FEATUREVALUES',"bubbleWidth":'VIZ_COMMON_BUBBLE_WIDTH',"bubbleHeight":'VIZ_COMMON_BUBBLE_HEIGHT',"rectangleColor":'VIZ_COMMON_RECTANGLECOLOR',"rectangleWeight":'VIZ_COMMON_RECTANGLEWEIGHT',"regionColor":'VIZ_COMMON_REGIONCOLOR',"axisLabels":'VIZ_COMMON_XAXIS',"pieSectorColor":'VIZ_COMMON_REGIONCOLOR',"geoFeatures":'VIZ_COMMON_GEO_FEATURES',"featureAnalysis":'VIZ_COMMON_FEATUREANALYSIS',"regionShape":'VIZ_COMMON_REGIONSHAPE',"rectangleTitle":'VIZ_COMMON_AREANAME',"mainLabelAxis":'VIZ_COMMON_AREANAME',"secondaryLabelAxis":'VIZ_COMMON_SECONDARY_AREANAME',"radarAxesValues":'VIZ_COMMON_YAXIS',"radarAxes":'VIZ_COMMON_RADAR_AXES',"tagWeight":'VIZ_COMMON_TAGWEIGHT',"tagFamily":'VIZ_COMMON_TAGFAMILY',"tagName":'VIZ_COMMON_TAGNAME',"multiplier.column":'VIZ_COMMON_COLUMNS',"multiplier.row":'VIZ_COMMON_ROWS',"treeNode":'VIZ_COMMON_TREENODE',"link":'VIZ_COMMON_LINK',"rows":'VIZ_COMMON_TABLE_DIMENSION',"values":'VIZ_COMMON_TABLE_MEASURE'};return e});define('sap/viz/controls/common/helpers/MapLayers',['sap/viz/controls/common/utils/Utils'],function(U){var M={};M.toJSON=function(i){return U.toJSON(i,function(i){return i})};M.fromJSON=function(j){return U.fromJSON(j,function(j){return j})};return M});define('sap/viz/controls/common/services/BVRService',['sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/Utils'],function(F,A,C,U){var B={};B.VERSION='1.0';B.switchFeeds=function(n,c,f){if(!A.needAutoFeeding(f,c,n)){return{'vizType':n,'feeds':f}}if(n&&F.isEmptyFeeds(f)){var e=F.buildEmptyFeeds(n);if(!e.length){}return{'vizType':n,'feeds':e}}var t;if(C.toSingleChartType(U.clone(n))===C.toSingleChartType(U.clone(c))){t=A.directFeeding(f,n)}else{t=A.smartFeeding(f,n)}return{'vizType':n,'feeds':t}};B.suggestFeeds=function(t,a,b){var f,c;if(arguments.length===2){f=[];c=a}else if(arguments.length>=3){f=a;c=b}return{'vizType':t,'feeds':A.smartFeeding(f,t,c)}};B.suggestChartWithFeeds=function(a){};return B});define('sap/viz/controls/common/filter/AbstractFilter',[],function(){var A=function(t,o,a){this.__className="sap.viz.controls.common.filter.AbstractFilter";this.filterType=t;this.filteredObjectId=o;this.filteredObjectName=a;this.isReverse=true;this._isGlobalFilter=false};A.VALUE_TYPE="VALUE_FILTER_TYPE";A.NUMERIC_RANGE_TYPE="NUMERIC_RANGE_TYPE";A.DATE_RANGE_TYPE="DATE_RANGE_TYPE";A.prototype.getType=function(){return this.filterType};A.prototype.getFilteredObjectId=function(){return this.filteredObjectId};A.prototype.getFilteredObjectName=function(){return this.filteredObjectName};A.prototype.setReverseSelection=function(r){this.isReverse=r};A.prototype.isReverseSelection=function(){return this.isReverse};A.prototype.isEmpty=function(){return false};A.prototype.toJSON=function(){var j={};j.filteredObjectId=this.filteredObjectId;j.filteredObjectName=this.filteredObjectName;j.filterType=this.filterType;j.isReverse=this.isReverse;j.isGlobalFilter=this._isGlobalFilter;return j};A.prototype.analysisObjectId=function(){return this.getFilteredObjectId()};A.prototype.id=function(){return this.getFilteredObjectId()};A.prototype.filterName=function(){return this.getFilteredObjectName()};A.prototype.isExcluded=function(i){if(arguments.length>0){this.isReverse=!i}else{return!this.isReverse}};A.prototype.isGlobalFilter=function(i){if(arguments.length>0){this._isGlobalFilter=i;return this}else{return this._isGlobalFilter}};A.prototype.filterTitle=function(){return this.filteredObjectName};A.prototype.filterContent=function(){return this.filteredObjectName};return A});define('sap/viz/controls/common/utils/DatasetUtil',[],function(){var D={};D.findAAIndex=function(f,a){for(var i=0;i<a.length;i++){if(a[i].feedId===f){var b=a[i].binding;for(var j=0;j<b.length;j++){var c=b[j];if(c.index!=null){return c.index}}}}return-1};D.getValue=function(d,a,b,c,e){var v=null;D._searchDimension(function(f,c,g){v=f.values[e]},d,a,b,c);return v};D.getInfoValue=function(d,a,b,c,e){var i;var f=d.info('additionalData');if(f&&f.length){i=D._getInfoValue(d,f,a,b,c,e)}return i};D._getInfoValue=function(d,a,b,c,e,f){for(var i=0;i<a.length;i++){var g=a[i];if(g.type!=='additionalData'){continue}var h=g.info;var j=null;D._searchDimension(function(k,e,l){j=h[l].infoValues[f]},d,b,c,e);return j}return null};D._searchDimension=function(c,d,a,b,e){var f=d.data().analysisAxis;var g=0;for(var i=0;i<f.length;i++){var h=f[i];if(a===h.index){for(var j=0;j<h.data.length;j++){var k=h.data[j];var m=isNaN(e)?k.name===b:e===j;if(m){c(k,j,g)}g++}}else{g+=h.data.length}}};return D});define('sap/viz/controls/common/filter/DateRangeFilter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/managers/LangManager'],function(O,A,L){var D=function(o,a){var b=[];b.push(A.DATE_RANGE_TYPE);b.push(o);b.push(a);D.superclass.constructor.apply(this,b);this.__className="sap.viz.controls.common.filter.DateRangeFilter";this.minDate=null;this.maxDate=null;this.excludeNull=false};O.extend(D,A);D.prototype.isEmpty=function(){if(this.minDate===null&&this.maxDate===null){return true}return false};D.prototype.getMin=function(){return this.minDate};D.prototype.getMax=function(){return this.maxDate};D.prototype.isExcludeNull=function(){return this.excludeNull};D.prototype.setMin=function(m){this.minDate=m};D.prototype.setMax=function(m){this.maxDate=m};D.prototype.setExcludeNull=function(e){this.excludeNull=e};D.prototype.toJSON=function(){var j=D.superclass.toJSON.apply(this,arguments);j.minDate=this.minDate;j.maxDate=this.maxDate;j.excludeNull=this.excludeNull;return j};D.fromJSON=function(f){var a=new D(f.filteredObjectId,f.filteredObjectName);a.setReverseSelection(f.isReverse);a.isGlobalFilter(f.isGlobalFilter);a.minDate=f.minDate;a.maxDate=f.maxDate;a.excludeNull=f.excludeNull;return a};D.prototype.clone=function(){var j=this.toJSON();return D.fromJSON(j)};D.prototype.filterTitle=function(){return this.filteredObjectName+'('+L.get('VIZ_COMMON_BETWEEN')+')'};D.prototype.filterContent=function(){return'('+this.minDate+'  -  '+this.maxDate+')'};return D});define('sap/viz/controls/common/filter/NumericRangeFilter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/managers/LangManager'],function(O,A,L){var N=function(o,a){var b=[];b.push(A.NUMERIC_RANGE_TYPE);b.push(o);b.push(a);N.superclass.constructor.apply(this,b);this.__className="sap.viz.controls.common.filter.NumericRangeFilter";this.minValue=null;this.maxValue=null;this.excludeNull=false};O.extend(N,A);N.prototype.isEmpty=function(){if(this.minValue===null&&this.maxValue===null){return true}return false};N.prototype.getMin=function(){return this.minValue};N.prototype.getMax=function(){return this.maxValue};N.prototype.isExcludeNull=function(){return this.excludeNull};N.prototype.setMin=function(m){this.minValue=m};N.prototype.setMax=function(m){this.maxValue=m};N.prototype.setExcludeNull=function(e){this.excludeNull=e};N.prototype.toJSON=function(){var j=N.superclass.toJSON.apply(this,arguments);j.minValue=this.minValue;j.maxValue=this.maxValue;j.excludeNull=this.excludeNull;return j};N.fromJSON=function(f){var a=new N(f.filteredObjectId,f.filteredObjectName);a.setReverseSelection(f.isReverse);a.isGlobalFilter(f.isGlobalFilter);a.minValue=f.minValue;a.maxValue=f.maxValue;a.excludeNull=f.excludeNull;return a};N.prototype.clone=function(){var j=this.toJSON();return N.fromJSON(j)};N.prototype.filterTitle=function(){return this.filteredObjectName+'('+L.get('VIZ_COMMON_BETWEEN')+')'};N.prototype.filterContent=function(){return'('+this.minValue+'  -  '+this.maxValue+')'};return N});define('sap/viz/controls/common/filter/ValueFilter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/filter/AbstractFilter'],function(O,A){var V=function(o,a){V.superclass.constructor.apply(this,[A.VALUE_TYPE,o,a]);this.__className="sap.viz.controls.common.filter.ValueFilter";this.hierarchyLevelId=null;this.filteredValues=[]};O.extend(V,A);V.prototype.getValues=function(){return this.filteredValues};V.prototype.isEmpty=function(){if(this.filteredValues&&this.filteredValues.length>0){return false}else{return true}};V.prototype.removeAllValues=function(){this.filteredValues.length=0};V.prototype.addValue=function(v){return this.filteredValues.push(v)};V.prototype.removeValue=function(v){for(var i=0;i<this.filteredValues.length;i++){if(this.filteredValues[i].key===v.key&&this.filteredValues[i].value===v.value){this.filteredValues.splice(i,1)}}};V.prototype.toJSON=function(){var j=V.superclass.toJSON.apply(this,arguments);j.filteredValues=this.filteredValues;if(this.hierarchyLevelId){j.hierarchyLevelId=this.hierarchyLevelId}return j};V.fromJSON=function(f){var a=new V(f.filteredObjectId,f.filteredObjectName);a.setReverseSelection(f.isReverse);a.isGlobalFilter(f.isGlobalFilter);a.filteredValues=f.filteredValues;if(f.hierarchyLevelId){a.hierarchyLevelId=f.hierarchyLevelId}return a};V.prototype.clone=function(){var j=this.toJSON();return V.fromJSON(j)};V.prototype.values=function(){return this.filteredValues};V.prototype.updateValues=function(v){return this.filteredValues=v};V.prototype.filterTitle=function(){return this.filteredObjectName+' ('+this.filteredValues.length+')'};V.prototype.filterContent=function(){var v="";for(var i=0,l=this.filteredValues.length;i<l;i++){if(v){v+=", "+this.filteredValues[i].value}else{v=this.filteredValues[i].value}}return v};return V});define('sap/viz/controls/common/filter/FilterHelper',['jquery','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/DateRangeFilter','sap/viz/controls/common/filter/NumericRangeFilter','sap/viz/controls/common/filter/ValueFilter'],function($,u,D,A,F,a,b,N,V){var c={};c.getMapFilterItems=function(s,d,f,e){if(!s||s.length<1||!e||e.length<1){return f}var p=[];for(var i=0;i<s.length;++i){var g=s[i].layerIndex;var l=e[g];if(!l||l.length<1){continue}for(var h in s[i].data){if(!s[i].data.hasOwnProperty(h)){continue}var j=c._getAnalysisObject(h,l);if(!j){continue}var k=c.getFilterInfo(j);var o={'value':s[i].data[h]};var q=false;for(var n=0;n<p.length;++n){if(p[n].filterInfo.id===k.id&&p[n].filterInfo.hierarchyLevelId===k.hierarchyLevelId){q=true;p[n].values.push(o);break}}if(!q){p.push({filterInfo:k,values:[o]})}}}var r=f.slice(0);for(var m=0;m<p.length;m++){var t=c._getFilter(r,p[m].filterInfo.id,p[m].filterInfo.hierarchyLevelId);if(t){r=c._updateFilterItem(r,t,p[m].values,d)}else{r=c._addFilterItem(r,p[m].filterInfo,p[m].values,d)}}return r};c._getAnalysisObject=function(d,f){for(var i=0;i<f.length;i++){if(f[i].type()!==F.DIMENSION){continue}var e=f[i].values();for(var j=0;j<e.length;j++){if(e[j].id()===d){return e[j]}}}return null};c.getFilterInfo=function(d){var n=d.name();var i=d.id();if(d.type()===A.HIERARCHY){var s=d.selectedHierarchyLevel();n=s.name();i=s.analysis().id();return{name:n,id:i,hierarchyLevelId:s.id(),hierarchyInfo:c._buildFilterHierarchyInfo(d)}}return{name:n,id:i}};c._buildFilterHierarchyInfo=function(d){var h=null;if(d.type()===A.HIERARCHY){h={hierarchyId:d.id(),levels:c._buildFilterHierarchyLevels(d.hierarchyLevels())}}return h};c.getFilterItems=function(s,d,f,e,g,h){if(!s||s.length===0){return f}var i;var k=[],l=[],m=[];for(i=0;i<e.length;i++){if(e[i].type()!==F.DIMENSION){continue}var n=D.findAAIndex(e[i].id(),h);var o=e[i].values();var p=0;for(var j=0;j<o.length;j++){k.push(c.getFilterInfo(o[j]));if(o[j].type()===A.MND){l.push(-1);m.push(-1)}else{l.push(n);m.push(p);p++}}}f=f.slice(0);var q={};for(i=0;i<k.length;i++){var r=k[i];var n=l[i];if(n<0){continue}if(!q[n]){q[n]=0}var t=c._pathsIndex(r.hierarchyInfo);var v=c._getAADataLength(g,n);if(t>0&&t<v){q[n]+=t}var w=c._getFilterValues(g,s,n,r.name,m[i]+q[n],r.hierarchyInfo);if(!w||w.length===0){continue}var x=c._getFilter(f,r.id,r.hierarchyLevelId);if(x){f=c._updateFilterItem(f,x,w,d)}else{f=c._addFilterItem(f,r,w,d)}}return f};c._excludeFilterValues=function(f,v){var d=f.values().slice(0);var i,n;if(f.isExcluded()){for(i=0;i<v.length;i++){var e=false;for(n=0;n<d.length;n++){if(c._filterValueEquals(v[i],d[n])){e=true;break}}if(!e){d.push(v[i])}}}else{for(i=0;i<v.length;i++){for(n=0;n<d.length;n++){if(c._filterValueEquals(v[i],d[n])){d.splice(n,1);break}}}}f.updateValues(d)};c._updateFilterItem=function(f,d,v,i){if(i){c._excludeFilterValues(d,v)}else{d.isExcluded(i);d.updateValues(v)}if(d.isEmpty()){var e=f.indexOf(d);f.splice(e,1)}return f};c._getFilterValues=function(d,s,e,f,g,h){var v=[];for(var i in s){var j=s[i];var k=j.ctx[0]['dii_a'+e];var l=D.getValue(d,e,f,g,k);if(!l){continue}var m=D.getInfoValue(d,e,f,g,k);var n;n={'value':l,'infoValue':m};if(!c._isValueExisted(v,n)){v.push(n)}}return v};c._getAADataLength=function(d,e){var l=0;var r=d.data();var i=e-1;if(r&&r.analysisAxis&&r.analysisAxis[i]){var f=r.analysisAxis[i].data;if(f){l=f.length}}return l};c._pathsIndex=function(h){if(h&&h.levels){var l=h.levels;for(var i in l){if(l[i].selected===true){return Number(i)}}}return-1};c._addFilterItem=function(f,i,v,d){var e=new V(i.id,i.name);e.hierarchyLevelId=i.hierarchyLevelId;e.updateValues(v);e.isExcluded(d);f.push(e);return f};c._buildFilterHierarchyLevels=function(h){var l=[];if(h&&h.length>0){for(var i in h){var d={id:h[i].id(),name:h[i].name(),selected:h[i].selected()};l.push(d)}}return l};c._filterValueEquals=function(v,d){if(!v&&!d){return true}if((!v&&d)||(v&&!d)){return false}if(v.value!==d.value){return false}if(v.infoValue===d.infoValue){return true}if(v.infoValue==null||d.infoValue==null){return true}if(u.isFunction(v.infoValue.equals)){return v.infoValue.equals(d.infoValue)}else if(v.infoValue.hasOwnProperty('key')){return v.infoValue.key===d.infoValue.key}else{return true}};c._isValueExisted=function(d,f){var v=f.value;var e=f.infoValue;var g=false;if(!d||d.length===0){return g}for(var i=0;i<d.length;i++){if(d[i]){g=c._filterValueEquals(d[i],f);if(g===true){break}}}return g};c._getFilter=function(f,d,h){var r=null;for(var i=0;i<f.length;i++){var e=f[i];if(!e.isGlobalFilter()&&e.id()===d&&(e.hierarchyLevelId==h)){r=e;break}}return r};c.isFilterItemExisted=function(m,i,h){var f=c._getFilter(m.filterItems(),i,h);if(f){return true}else{return false}};c.toJSON=function(i){return u.toJSON(i,function(i){return i.toJSON()})};c.fromJSON=function(j){return u.fromJSON(j,function(j){var f=j.filterType;var i;switch(f){case a.VALUE_TYPE:i=V.fromJSON(j);break;case a.NUMERIC_RANGE_TYPE:i=N.fromJSON(j);break;case a.DATE_RANGE_TYPE:i=b.fromJSON(j);break}return i})};return c});define('sap/viz/controls/runtime/ModelHandler',[],function(){var M=function(v){this.__className="sap.viz.controls.runtime.ModelHandler";this._vizModel=v;this._isMNDVisibleChanged=false;this._feedingItemsChanged=false};M.prototype._type=function(v){if(arguments.length>0){this._vizModel._type=v;return this}else{return this._vizModel._type}};M.prototype._feedingItems=function(v){if(arguments.length>0){this._vizModel._feedingItems=v;return this}else{return this._vizModel._feedingItems}};M.prototype._filterItems=function(v){if(arguments.length>0){this._vizModel._filterItems=v;return this}else{return this._vizModel._filterItems}};M.prototype.explicitFeedingItems=function(o){return this._vizModel.feedingItems()};M.prototype.deactive=function(){};M.prototype.feedingItemsChanged=function(v,e){};M.prototype.isMNDVisibleChanged=function(v){};M.prototype._setIsMNDVisible=function(v){};M.prototype.vizModelChanged=function(o){};M.prototype.propertiesChanged=function(t,a){};M.prototype.getFilterItems=function(s,i,v,f){};M.prototype.cloneFeeds=function(f){};M.prototype.clone=function(c){};return M});define('sap/viz/controls/runtime/MapModelHandler',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/helpers/MapLayers','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/runtime/ModelHandler'],function(O,u,E,a,C,A,b,c,H,F,d,M,B,e,f,g,h){var k=function(v){k.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.MapModelHandler"};O.extend(k,h);k.prototype.feedingItemsChanged=function(v){var j=[];var l=this._feedingItems();for(var i=0;i<v.length;i++){if(l[i]!==v[i]){if(l[i]&&v[i]&&d.equal(l[i],v[i])){continue}else{j.push(i)}}}this._feedingItems(v);if(j.length>0){this._vizModel._feedingItemsHistory=null;var m={'feedingItemsChanged':true,feedsChangedInfo:{items:j}};this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(m)}};k.prototype.isMNDVisibleChanged=function(v){this._vizModel._feedingItemsHistory=null};k.prototype._setIsMNDVisible=function(v){if(this._vizModel.isMNDVisible()!==v){this._vizModel._isMNDVisible=v;this._isMNDVisibleChanged=true}};k.prototype.vizModelChanged=function(o){var j=false;var l=this._type();if(o.type){this._type(o.type)}var n=this._type();if(o.feedingItems){var m=this._feedingItems();if(m.length!=o.feedingItems.length){j=true}else{for(var i=0;i<m.length;i++){if(!d.equal(m[i],o.feedingItems[i])){j=true;break}}}if(j){this._vizModel._feedingItemsHistory=null;this._feedingItems(o.feedingItems)}}var p=false;if(o.filterItems){this._filterItems(o.filterItems);p=true}var q={'vizTypeChanged':l!==n,'feedingItemsChanged':this._feedingItemsChanged||j,'filterChanged':p};this._type(n);this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(q)};k.prototype.propertiesChanged=function(t,i){var v=this._type();if(!v){return}var n=v;var j={'vizTypeChanged':i||(v!==t)};this._type(n);this._feedingItemsChanged=false;this._isMNDVisibleChanged=false;this._vizModel.dispatchPropertiesChangedEvent(j)};k.prototype.getFilterItems=function(s,i,v,j){return g.getMapFilterItems(s,i,this._filterItems(),this._feedingItems())};k.prototype.clone=function(l){var r=l;r._type=this._type();var m=this._feedingItems();if(m&&m.length>0){for(var i=0;i<m.length;i++){r._feedingItems[i]=[];for(var n=0;n<m[i].length;n++){r._feedingItems[i][n]=m[i][n].clone()}}}var o=this._filterItems();if(o&&o.length>0){for(var j=0;j<o.length;j++){r._filterItems[j]=o[j].clone()}}return r};return k});define('sap/viz/controls/runtime/VizModelHandler',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/helpers/MapLayers','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/runtime/ModelHandler'],function(O,u,E,a,C,A,b,c,H,F,d,M,B,e,f,g,h){var V=function(v){V.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizModelHandler"};O.extend(V,h);V.prototype.explicitFeedingItems=function(o){o=o||{};var i=this._feedingItems();var t=this._type();if(!f.isMultipleChart(t)){i=d.removeRowAndColumnFeedItems(i)}var w=o.withMND!=null?o.withMND===true:this._vizModel.isMNDVisible();if(!w){i=d.removeMND(i)}var j=d.buildEmptyFeeds(t);i=d.merge(j,i);return i};V.prototype.deactive=function(){this._vizModel._feedingItemsHistory=d.cloneFeeds(this._feedingItems())};V.prototype.feedingItemsChanged=function(v,i){var j=this._vizModel.extensionValues();var i=j.feedingPanel?j.feedingPanel.enableTrellis:i;if(i===false){v=d.removeRowAndColumnFeedItems(v)}this._setIsMNDVisible(d.hasMND(v));this._feedingItemsChanged=!d.equal(v,this._feedingItems());if(this._feedingItemsChanged){this._feedingItems(v||[]);this._vizModel._feedingItemsHistory=null;var k=d.hasRowOrColumn(this._feedingItems());var l=this._type();var n;if(k&&!f.isMultipleChart(l)){n=f.toMultiChartType(l);this._vizModel.type(n)}else if(!k&&f.isMultipleChart(l)){n=f.toSingleChartType(l);this._vizModel.type(n)}else{this.propertiesChanged(l,false)}this._vizModel._feedingItemsHistory=null}};V.prototype.isMNDVisibleChanged=function(v){this._isMNDVisibleChanged=true;this._vizModel._feedingItemsHistory=null;this.propertiesChanged(this._type(),false);this._vizModel._feedingItemsHistory=null};V.prototype._setIsMNDVisible=function(v){var i=(v===true);if(this._vizModel.isMNDVisible()!==i){this._vizModel._isMNDVisible=i;this._isMNDVisibleChanged=true}};V.prototype.vizModelChanged=function(o){var i=false;if(!this._vizModel._feedingItemsHistory){this._vizModel._feedingItemsHistory=d.cloneFeeds(this._feedingItems())}var j=this._vizModel.isMNDVisible();var k=this._type();if(o.type){this._type(o.type)}var n=this._type();if(o.feedingItems){if(d.match(n,o.feedingItems,false)){var l=V._feedMND(n,o.feedingItems,j);n=l.vizType;o.feedingItems=l.feeds}i=!d.equal(this._feedingItems(),o.feedingItems);if(i){this._feedingItems(o.feedingItems);this._vizModel._feedingItemsHistory=d.cloneFeeds(o.feedingItems)}}var m=this._vizModel._feedingItemsHistory;n=V._adaptTypeByTrellis(n,m);if(!i){var p;if(n!==k){p=B.switchFeeds(n,k,this._vizModel._feedingItemsHistory).feeds;var l=V._feedMND(n,p,j);n=l.vizType;p=l.feeds}if(p){this._feedingItems(p);if(d.isEmptyFeeds(this._feedingItems())&&d.isEmptyFeeds(p)){i=false}else{i=!d.isFeedDefinitionEqual(k,n)||!d.equal(this._feedingItems(),p)}}}var q=false;if(o.filterItems){this._filterItems(o.filterItems);q=true}var r={'vizTypeChanged':k!==n,'feedingItemsChanged':this._feedingItemsChanged||i,'filterChanged':q};this._type(n);this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(r)};V.prototype.propertiesChanged=function(t,i){var v=this._type();if(!v){return}var j=this._feedingItems();if(!this._vizModel._feedingItemsHistory){this._vizModel._feedingItemsHistory=d.cloneFeeds(j)}var n=v;var k=t;var l=this._vizModel._feedingItemsHistory;n=V._adaptTypeByTrellis(n,l);var m=this._vizModel.isMNDVisible();if(m){n=V._adaptTypeByMND(n)}if(d.match(n,l,false)){var o=V._feedMND(n,l,m);n=o.vizType;l=o.feeds}var p=B.switchFeeds(n,k,l).feeds;var o=V._feedMND(n,p,m);n=o.vizType;p=o.feeds;var q=true;if(d.isEmptyFeeds(j)&&d.isEmptyFeeds(p)){q=false}else{q=!d.isFeedDefinitionEqual(k,n)||!d.equal(j,p)}var r={'vizTypeChanged':i||(k!==n),'feedingItemsChanged':this._feedingItemsChanged||q,'isMNDVisibleChanged':this._isMNDVisibleChanged};this._type(n);this._feedingItems(p);this._feedingItemsChanged=false;this._isMNDVisibleChanged=false;this._vizModel.dispatchPropertiesChangedEvent(r)};V.prototype.getFilterItems=function(s,i,v,j){return g.getFilterItems(s,i,this._filterItems(),this._feedingItems(),v,j)};V.prototype.clone=function(k){var r=k;r._type=this._type();var l=this._feedingItems();if(l&&l.length>0){for(var i=0;i<l.length;i++){r._feedingItems[i]=l[i].clone()}}var m=this._filterItems();if(m&&m.length>0){for(var j=0;j<m.length;j++){r._filterItems[j]=m[j].clone()}}return r};V._adaptTypeByTrellis=function(t,i){var j=f;if(j.supportMultiChart(t)){if(d.hasRowOrColumn(i)){return j.toMultiChartType(t)}else{return j.toSingleChartType(t)}}else{return t}};V._adaptTypeByMND=function(t){var i=f;if(i.supportMultiChart(t)){var m=i.toMultiChartType(t);if(t!==m&&!i.supportMND(t)&&i.supportMND(m)){return m}else{return t}}else{return t}};V._feedMND=function(t,i,j){if(j){t=V._adaptTypeByMND(t);if(!d.hasMND(i)){i=c.directFeeding(i,t,[A.genMND()])}}else{i=d.removeMND(i);t=V._adaptTypeByTrellis(t,i);if(!d.isEmptyFeeds(i)){if(!d.meetMinDimensions(t,i)){i=c.directFeeding(i,t,[A.genMND()])}}}if(d.countAnalyses(i,b.MEASURE)===0){i=d.removeMND(i)}t=V._adaptTypeByTrellis(t,i);return{'vizType':t,'feeds':i}};return V});define('sap/viz/controls/runtime/VizModel',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/helpers/MapLayers','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/runtime/MapModelHandler','sap/viz/controls/runtime/VizModelHandler'],function(O,u,E,a,C,A,b,c,H,F,d,M,B,e,f,g,h,V){var i=function(){i.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizModel";this._type=null;this._isMNDVisible=false;this._feedingItems=[];this._feedingItemsHistory=null;this._filterItems=[];this._extensionValues={};this._handler=this._vizModelHandler=new V(this)};O.extend(i,a);i.PropertiesChangedEvent='propertiesChangedEvent';i.prototype._updateHandler=function(t){var n=this._vizModelHandler;if(C.TYPE_GEO_MAP===t){if(!this._mapModelHandler){this._mapModelHandler=new h(this)}n=this._mapModelHandler}if(n!==this._handler){this._handler.deactive();this._handler=n;this._feedingItems=[]}};i.prototype.filterItems=function(v){if(arguments.length>0){this._filterItems=v;var j={filterChanged:true};var k=new E(i.PropertiesChangedEvent,this,j);this._dispatchEvent(k);return this}else{return this._filterItems}};i.prototype.explicitFeedingItems=function(o){return this._handler.explicitFeedingItems(o)};i.prototype.feedingItems=function(v,j){if(arguments.length>0){this._handler.feedingItemsChanged(v,j);return this}else{return this._feedingItems.slice(0)}};i.prototype.type=function(v){if(arguments.length>0){if(this._type!==v){var o=this._type;this._type=v;this._updateHandler(this._type);this._handler.propertiesChanged(o,true)}return this}else{return this._type}};i.prototype.isMNDVisible=function(v){if(arguments.length>0){var j=(v===true);if(this._isMNDVisible!==j){this._isMNDVisible=j;this._handler.isMNDVisibleChanged()}return this}else{return this._isMNDVisible}};i.prototype.vizModelChanged=function(o){if(o.type){this._updateHandler(o.type)}this._handler.vizModelChanged(o)};i.prototype.updateFilterItems=function(s,j,v,k){var n=this._handler.getFilterItems(s,j,v,k);this.filterItems(n)};i.prototype.clone=function(){var r=new i();this._handler.clone(r);return r};i.prototype.extensionValues=function(j){if(arguments.length>0){var k={};if(j){if(this._extensionValues!==j){this._extensionValues=j;k={'extensionValuesChanged':true}}}var l=new E(i.PropertiesChangedEvent,this,k);this._dispatchEvent(l);return this}else{return this._extensionValues}};i.prototype.dispatchPropertiesChangedEvent=function(j){var p=new E(i.PropertiesChangedEvent,this,j);this._dispatchEvent(p)};i.prototype.dispatchEvent=function(j){this._dispatchEvent(j)};return i});define('sap/viz/controls/common/ProxyBase',[],function(){var P=function P(c){this.__className="sap.viz.controls.runtime.ProxyBase";this.__client=c};P.prototype._client=function(){return this.__client};P.prototype.updateClient=function(c){this.__client=c};return P});define('sap/viz/controls/runtime/VizProxy',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/ProxyBase','sap/viz/controls/common/events/Event'],function($,O,P,E){var V=function V(v){V.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizProxy"};O.extend(V,P);V.VizProxyEvent='VizProxy.VizProxyEvent';V.GetTitleZoneOperation='getTitleZoneOperation';V.GetTitleTextOperation='getTitleTextOperation';V.SetTitleTextOperation='setTitleTextOperation';V.GetTitleTextByFeedingOperation='getTitleTextByFeedingOperation';V.RestoreTitleTextOperation='restoreTitleTextOperation';V.IsFakeChartOperation='isFakeChartOperation';V.IsTitleCustomizedOperation='isTitleCustomizedOperation';V.GetPropertiesOperation='getPropertiesOperation';V.SetPropertiesOperation='setPropertiesOperation';V.GetSelectionOperation='getSelectionOperation';V.prototype._model=function(){return this._client()};V.prototype._doOperation=function(o,d){d=d||{};d.operation=o;var e=new E(V.VizProxyEvent,this._model(),d);this._model().dispatchEvent(e);return e.data.result};V.prototype.getTitleZone=function(){return this._doOperation(V.GetTitleZoneOperation)};V.prototype.getTitleText=function(){return this._doOperation(V.GetTitleTextOperation)};V.prototype.setTitleText=function(t){var d={args:arguments};this._doOperation(V.SetTitleTextOperation,d)};V.prototype.getTitleTextByFeeding=function(){return this._doOperation(V.GetTitleTextByFeedingOperation)};V.prototype.restoreTitleText=function(){this._doOperation(V.RestoreTitleTextOperation)};V.prototype.isFakeChart=function(){return this._doOperation(V.IsFakeChartOperation)};V.prototype.isTitleCustomized=function(){return this._doOperation(V.IsTitleCustomizedOperation)};V.prototype.getProperties=function(){return this._doOperation(V.GetPropertiesOperation)};V.prototype.setProperties=function(n){var d={args:arguments};this._doOperation(V.SetPropertiesOperation,d)};V.prototype.getSelection=function(){return this._doOperation(V.GetSelectionOperation)};return V});define('sap/viz/controls/common/VizControlBase',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/UIControl','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/runtime/VizModel','sap/viz/controls/runtime/VizProxy'],function(O,E,U,R,V,a){var b=function b(d,u,p){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.VizControlBase";sap.viz.base.utils.log.Analyzer.pnrContext('sap.viz.controls performance log context');this._vizUid=null;if(p){this._parent=p;this.__vizModel=p._vizModel()}else{this.__vizModel=this._createModel()}this.__vizModel.addEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);this._updatingProperty=0;this.__vizProxy=new a(this.__vizModel)};O.extend(b,U);b.prototype.connect=function(v){this._vizUid=v;var r=R.getRuntime();var m=r.getModel(v);var c=false;if(!m){r.registerModel(v,this.__vizModel)}else{if(this.__vizModel!==m){c=true;this.__vizModel.removeEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);this.__vizModel=m;this.__vizModel.addEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this)}r.addModelRef(v)}this._onConnect(v,c)};b.prototype._vizModel=function(){return this.__vizModel};b.prototype._vizProxy=function(){return this.__vizProxy};b.prototype._onVizModelChanged=function(e){};b.prototype._createModel=function(){return new V()};b.prototype._onConnect=function(v,m){this._vizProxy().updateClient(this.__vizModel)};b.prototype._onDisconnect=function(){};b.prototype.disconnect=function(){this._removeSharedModel(true)};b.prototype._removeSharedModel=function(n){var v=this._vizUid;if(v){var m=R.getRuntime().getModel(v);if(m){if(n){this._onDisconnect()}m.removeEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);this.__vizModel=m.clone();this.__vizModel.addEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);R.getRuntime().removeModelRef(v)}this._vizUid=null}};b.prototype.destroy=function(){this._removeSharedModel(false);b.superclass.destroy.apply(this,arguments)};b.prototype._beginUpdateProperty=function(){this._updatingProperty++};b.prototype._inUpdatingProperty=function(){return this._updatingProperty>0};b.prototype._endUpdateProperty=function(){this._updatingProperty--};b.prototype._dispatchPropertyEvent=function(e){if(!this._updatingProperty){b.superclass._dispatchEvent.apply(this,arguments)}};b.prototype._dispatchEvent=function(e){if(!e.data){e.data={}}e.data.token=this._vizUid;b.superclass._dispatchEvent.apply(this,arguments)};b.prototype.save=function(){return{}};b.prototype.load=function(v){};return b});define('sap/viz/controls/common/VizControlHost',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/VizControlBase'],function(O,E,V){var a=function a(){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.VizControlHost";this._children=[]};O.extend(a,V);a.prototype._onConnect=function(v){a.superclass._onConnect.apply(this,arguments);for(var i=0;i<this._children.length;i++){this._children[i].connect(v)}};a.prototype._onDisconnect=function(){a.superclass._onDisconnect.apply(this,arguments);for(var i=0;i<this._children.length;i++){this._children[i].disconnect()}};a.prototype._addChild=function(c,f,e){if(!c){return}this._children.push(c);var _=this;if(f){for(var i=0;i<f.length;i++){(function(i){var n=f[i];_[n]=function(){return c[n].apply(c,arguments)}})(i)}}if(e){for(var j=0;j<e.length;j++){c.addEventListener(e[j],function(b){_._dispatchEvent(b)})}}};a.prototype.destroy=function(){if(this._children.length>0){for(var i=0;i<this._children.length;i++){try{this._children[i].destroy()}catch(e){}}this._children=[]}a.superclass.destroy.apply(this,arguments)};return a});define('sap/viz/controls/common/views/feed/FeedingShelfEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedingShelfEvent"};O.extend(F,E);F.CLICK_ADD_FEEDING="clickAddFeeding";F.ACTION_CHANGED="actionChanged";F.FEEDING_CHANGED="feedingChanged";F.FEEDING_EMPTY_CHANGED="feedingEmptyChanged";F.FEEDING_DROP_DENY="feedingDropDeny";return F});define('sap/viz/controls/builder/VizBuilderEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var V=function(t,a,d){V.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.builder.VizBuilderEvent"};O.extend(V,E);return V});define('sap/viz/controls/mapbuilder/constants/Const',[],function(){var C={};C.VIZ_TYPE_CHOROPLETH="choropleth";C.VIZ_TYPE_MARKER="marker";C.VIZ_TYPE_BUBBLE="bubble";return C});define('sap/viz/controls/mapbuilder/components/PropertyTriangle',['jquery','sap/viz/controls/common/constants/CSSConst'],function($,C){var P=function(){this.__className="sap.viz.controls.geo.compnents.PropertyTriangle"};P.prototype.createTriangle=function(){var i=document.createElement('DIV');this.turnToExpandTriangle(i);return i};P.prototype.turnToExpandTriangle=function(i){if(i){$(i).removeClass(C.MAPBUILDER_PREFIX+"section-expand");$(i).addClass(C.MAPBUILDER_PREFIX+"section-collapse");$(i).removeClass(C.MAPBUILDER_PREFIX+"header-collapse");$(i).addClass(C.MAPBUILDER_PREFIX+"header-expand")}};P.prototype.turnToShrinkTriangle=function(i){if(i){$(i).removeClass(C.MAPBUILDER_PREFIX+"section-collapse");$(i).addClass(C.MAPBUILDER_PREFIX+"section-expand");$(i).removeClass(C.MAPBUILDER_PREFIX+"header-expand");$(i).addClass(C.MAPBUILDER_PREFIX+"header-collapse")}};return P});define('sap/viz/controls/mapbuilder/events/GeoEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var G=function(t,a,d){G.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.events.GeoEvent"};O.extend(G,E);G.ADD_LAYER="addLayer";G.SHOW_LAYER="showLayer";G.HIDE_LAYER="hideLayer";G.EXPAND_SECTION="expandSection";G.HIDE_SECTION="hideSection";G.DELETE_LAYER="deleteLayer";G.REORDER_LAYER="reorderLayer";G.CHANGE_LAYER_VIZTYPE="changeLayerVizType";G.CHANGE_BASEMAP_PROVIDER="changeBasemapProvider";G.UPDATE_LAYER_DATA="updateLayerData";G.RENAME_LAYER="renameLayer";G.DISPLAY_SETTINGMENU="displaySettingMenu";G.SHOW_LEGEND="showLegend";G.HIDE_LEGEND="hideLegend";G.CHANGE_VIZ_PROPERITIES="changeVizProperties";G.CHANGE_BASEMAP_TYPE="changeBaseMapType";return G});define('sap/viz/controls/mapbuilder/sections/SectionBase',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/UIControl","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/mapbuilder/components/PropertyTriangle","sap/viz/controls/mapbuilder/events/GeoEvent"],function($,O,U,V,C,P,G){var S=function(d,c){S.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.sections.SectionBase";this._config=c;this._checkable=this._config.checkable;this._configable=this._config.configable;this._sortable=this._config.sortable;this._isExpand=false;this._isChecked=true;this._instanceDom=this._dom;this._checkBoxDom=null;this._symbolDom=null;this._headerDom=null;this._iconDom=null;this._labelDom=null;this._configDom$=null;this._controlPanel=null;this._childControls=[];this._isMouseDown=false;this._selected=false;this._propertyTriangle=new P();this._availableControls=[];this._createCompoment()};O.extend(S,V);S.prototype._createCompoment=function(){if(this._isCreated){return}this._titleString=this._config.title?this._config.title:null;this._childControlDom=[];this._createSection();this._attachEventHandler();this._isCreated=true;$(this._instanceDom).prepend($(this._sectionDom))};S.prototype._createSection=function(){this._sectionDom=document.createElement('div');this._headerDom=document.createElement('div');$(this._sectionDom).addClass(C.MAPBUILDER_PREFIX+"section");$(this._headerDom).addClass(C.MAPBUILDER_PREFIX+"section-header");this._checkBoxDom=document.createElement('input');this._checkBoxDom.type='checkbox';this._checkBoxDom.checked=this._isChecked;$(this._checkBoxDom).addClass(C.MAPBUILDER_PREFIX+"section-block");if(!this._checkable){this._checkBoxDom.disabled=true}this._symbolDom=this._propertyTriangle.createTriangle();$(this._symbolDom).addClass(C.MAPBUILDER_PREFIX+"section-expand");this._headerDom.appendChild(this._symbolDom);this._headerDom.appendChild(this._checkBoxDom);this._labelDom=document.createElement('div');$(this._labelDom).addClass(C.MAPBUILDER_PREFIX+"section-title");this._labelDom.innerText=this._titleString;this._headerDom.appendChild(this._labelDom);this._iconDom=$('<div/>').addClass(C.MAPBUILDER_PREFIX+"section-icon");this._iconDom.appendTo($(this._headerDom));this._iconDom.hide();if(this._configable){this._configDom$=$('<div/>').addClass(C.MAPBUILDER_PREFIX+"section-setting");this._configDom$.appendTo($(this._headerDom))}this._sectionDom.appendChild(this._headerDom)};S.prototype._attachEventHandler=function(){$(this._symbolDom).bind('tap click',function(e){e.stopPropagation();e.preventDefault();this._dispatchEvent(new G(this._isExpand?G.HIDE_SECTION:G.EXPAND_SECTION,this,{sectionIdx:this.getSectionIdx()}))}.bind(this));$(this._headerDom).bind('tap click',function(e){e.stopPropagation();e.preventDefault();this._dispatchEvent(new G(this._isExpand?G.HIDE_SECTION:G.EXPAND_SECTION,this,{sectionIdx:this.getSectionIdx()}))}.bind(this));if(this._configable){this._configDom$.bind('tap click',function(e){this._dispatchEvent(new G(G.DISPLAY_SETTINGMENU,this,{sectionIdx:this.getSectionIdx()}));e.stopPropagation();e.preventDefault()}.bind(this))}$(this._checkBoxDom).bind('click tap',function(e){e.stopPropagation();e.preventDefault()});$(this._checkBoxDom).bind('mousedown',function(e){this._isMouseDown=true}.bind(this));$(this._checkBoxDom).bind('mouseup',function(e){if(this._isMouseDown){this._isChecked=!this._isChecked;e.target.checked=this._isChecked;e.stopPropagation();e.preventDefault();this._isMouseDown=false;this._selected=true;this._dispatchEvent(new G(this._isChecked?G.SHOW_LAYER:G.HIDE_LAYER,this,{sectionIdx:this.getSectionIdx()}))}}.bind(this));if(this._sortable){$(this._instanceDom).sortable({start:function(e,u){u.item.data("__origIdx",u.item.index())},update:function(e,u){this._dispatchEvent(new G(G.REORDER_LAYER,this,{from:u.item.data("__origIdx"),to:u.item.index()}))}.bind(this)})}};S.prototype._hideSectionHandler=function(){var _=this;if(this._controlPanel!=null){$(this._controlPanel).hide()}$(this._sectionDom).removeClass(C.MAPBUILDER_PREFIX+"section-header-expand");this._propertyTriangle.turnToExpandTriangle(this._symbolDom);$(this._headerDom).bind("mouseover",function(){_._configDom$.show()}).bind("mouseout",function(){_._configDom$.hide()});this._isExpand=false};S.prototype._expandSectionHandler=function(){this._propertyTriangle.turnToShrinkTriangle(this._symbolDom);$(this._sectionDom).addClass(C.MAPBUILDER_PREFIX+"section-header-expand");this._configDom$.show();$(this._headerDom).unbind("mouseover").unbind("mouseout");if(this._controlPanel!=null){$(this._controlPanel).show()}else{this._controlPanel=$('<div/>').appendTo($(this._sectionDom));this._createChildControlPanel(this._controlPanel)}this._isExpand=true};S.prototype.getSectionIdx=function(){return $(this._sectionDom).index()};S.prototype.getSectionDom=function(){return $(this._sectionDom)};S.prototype.title=function(t,c){if(!arguments.length){return this._labelDom.innerText}else{if(c){this._titleString=t;this._labelDom.innerText=this._titleString}else{if(this._titleString!=null){this._labelDom.innerText=this._titleString}else{this._labelDom.innerText=t}}}};return S});define('sap/viz/controls/mapbuilder/widgets/WidgetBase',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/VizControlBase"],function($,O,V){var W=function(r,c){W.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetBase";this._config=c};O.extend(W,V);return W});define('sap/viz/controls/mapbuilder/widgets/WidgetTitle',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/mapbuilder/widgets/WidgetBase"],function($,O,C,W){var a=function(d,c){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetTitle";this._title$=null;this._creatControls()};O.extend(a,W);a.prototype._creatControls=function(){var r=$(this._dom);this._title$=$('<div/>').appendTo(r).addClass(C.MAPBUILDER_PREFIX+"section-category-title");var b=$('<div/>').appendTo(this._title$).addClass(C.MAPBUILDER_PREFIX+"section-category-title-text");b.text(this._config.title)};a.prototype.show=function(){this._title$.show()};a.prototype.hide=function(){this._title$.hide()};return a});define('sap/viz/controls/mapbuilder/widgets/WidgetDataPoint',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/events/GeoEvent","sap/viz/controls/mapbuilder/constants/Const","sap/viz/controls/mapbuilder/widgets/WidgetBase"],function($,O,C,L,G,a,W){var I=C.MAPBUILDER_PREFIX+"inline-block";var T=C.MAPBUILDER_PREFIX+"viztype-selected";var b=function(d,c){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetDataPoint";this._vizTypeButton$={};this._creatControls();this._addEventListeners()};O.extend(b,W);b.prototype.update=function(c){var v=c.vizType;if(v){for(var k in this._vizTypeButton$){if(this._vizTypeButton$.hasOwnProperty(k)){this._vizTypeButton$[k].removeClass(T)}}this._vizTypeButton$[v].addClass(T)}};b.prototype._creatControls=function(){var r=$(this._dom);var c=$('<button/>').appendTo(r).addClass(C.MAPBUILDER_PREFIX+"viztype").addClass(I);$("<div/>").addClass(C.MAPBUILDER_PREFIX+'viztype-choropleth').addClass(C.MAPBUILDER_PREFIX+'viztype-icon').appendTo(c);c.data("__viztype","choropleth");c.attr("title",L.get('VIZ_MAPBUILDER_CHOROPLETH'));this._vizTypeButton$['choropleth']=c;c=$('<button/>').appendTo(r).addClass(C.MAPBUILDER_PREFIX+"viztype").addClass(I);$("<div/>").addClass(C.MAPBUILDER_PREFIX+'viztype-bubble').addClass(C.MAPBUILDER_PREFIX+'viztype-icon').appendTo(c);c.data("__viztype","bubble");c.attr("title",L.get('VIZ_MAPBUILDER_BUBBLE'));this._vizTypeButton$['bubble']=c;c=$('<button/>').appendTo(r).addClass(C.MAPBUILDER_PREFIX+"viztype").addClass(I);$("<div/>").addClass(C.MAPBUILDER_PREFIX+'viztype-marker').addClass(C.MAPBUILDER_PREFIX+'viztype-icon').appendTo(c);c.data("__viztype","marker");c.attr("title",L.get('VIZ_MAPBUILDER_MARKER'));this._vizTypeButton$['marker']=c;this._vizTypeButton$[this._config.selected].addClass(T)};b.prototype._addEventListeners=function(){var _=this;for(var k in this._vizTypeButton$){if(this._vizTypeButton$.hasOwnProperty(k)){this._vizTypeButton$[k].bind('click tap',function(e){for(var k in _._vizTypeButton$){if(_._vizTypeButton$.hasOwnProperty(k)){_._vizTypeButton$[k].removeClass(T)}}$(this).addClass(T);_._dispatchEvent(new G(G.CHANGE_LAYER_VIZTYPE,this,{vizType:$(this).data("__viztype")}))})}}};return b});define('sap/viz/controls/common/views/drag/DropAction',[],function(){var D={};D.ACCEPT='accept';D.ACCEPT_AS_REPLACEMENT='acceptAsReplacement';D.ACCEPT_AS_COPY='acceptAsCopy';D.DENY='deny';D.AS_TRASH='asTrash';return D});define('sap/viz/controls/common/views/drag/AnalysisToken',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/drag/DropAction'],function($,C,O,u,U,D){var A=function(d,a,b){A.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.drag.AnalysisToken";this._domHelper$=$(d);this._domDraggable$=$(a);this._fixDragingPosition();this._defaultAction=D.DENY;this.analysisObject=b;this.playDefaultAction()};O.extend(A,U);A.prototype._fixDragingPosition=function(){var d=this._domDraggable$;var a=$.proxy(function(e,c){c.position.top=c.offset.top;c.position.left=c.offset.left;c.helper.trigger('sap.viz.controls.analysisDrag.events.drag',[e.pageX,e.pageY])},this);var b=$.proxy(function(e,c){o()},this);var o=function(){d.off('drag',a);d.off('dragstop',b)};o();d.on('drag',a);d.on('dragstop',b)};A.prototype.defaultAction=function(v){if(arguments.length>0){this._defaultAction=v;return this}else{return this._defaultAction}};A.prototype.killRevertAnimation=function(){var d=this._domDraggable$;if(d){var o=d.draggable('option','revertDuration');d.draggable('option','revertDuration',0);u.defer(function(){try{d.draggable('option','revertDuration',o)}catch(e){}})}};A.prototype.dropTarget=function(v){};A.prototype.currentAction=function(v){if(arguments.length>0){this._domHelper$.data('sap.viz.controls.analysisDrag.action',v);this._domHelper$.trigger('sap.viz.controls.analysisDrag.events.dropAction',[v]);return this}else{return this._domHelper$.data('sap.viz.controls.analysisDrag.action')}};A.prototype.playDefaultAction=function(){this.currentAction(this._defaultAction)};A.prototype.showWarn=function(w){};return A});define('sap/viz/controls/common/views/drag/DefaultAnalysisToken',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/drag/AnalysisToken','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/utils/Utils'],function($,C,O,U,A,D,a){var b=function(d,c,e){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.drag.DefaultAnalysisToken";this._dom$=$(d);this._icon$=null;this._warn$=null;this._warnspan$=null;this._dropTarget=null;this._createChildren();this._dom$.appendTo(document.body);this.currentAction(this._defaultAction);b._instance=this};O.extend(b,A);b._ACTION_TO_CLASS=(function(){var m={};var p=C.COMMON_PREFIX;var c=p+'havanaVXTabSprite16 '+p+'analysisDraggingToken-'+'icon-dropAccepted';m[D.ACCEPT]=c;m[D.ACCEPT_AS_COPY]=c;c=p+'havanaVXTabSprite16 '+p+'analysisDraggingToken-icon-dropAcceptedAsReplacement';m[D.ACCEPT_AS_REPLACEMENT]=c;c=p+'havanaVXTabSprite16 '+p+'analysisDraggingToken-'+'icon-dropDenied';m[D.DENY]=c;c=p+'havanaSharedSprite16 '+p+'analysisDraggingToken-icon-dropAsTrash';m[D.AS_TRASH]=c;return m})();b.prototype.dropTarget=function(v){if(arguments.length>0){this._dropTarget=v;return this}else{return this._dropTarget}};b.prototype.currentAction=function(v){if(this._icon$){if(arguments.length>0){this._icon$.removeClass(b._ACTION_TO_CLASS[D.ACCEPT]);this._icon$.removeClass(b._ACTION_TO_CLASS[D.ACCEPT_AS_COPY]);this._icon$.removeClass(b._ACTION_TO_CLASS[D.ACCEPT_AS_REPLACEMENT]);this._icon$.removeClass(b._ACTION_TO_CLASS[D.DENY]);this._icon$.removeClass(b._ACTION_TO_CLASS[D.AS_TRASH]);this._icon$.addClass(b._ACTION_TO_CLASS[v])}}return b.superclass.currentAction.apply(this,arguments)};b.prototype.showWarn=function(w){if(w){if(!this._warn$){this._warn$=$(document.createElement('div')).addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn').appendTo(this._dom$);this._warnspan$=$(document.createElement('span')).addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn-text').appendTo(this._warn$)}this._warnspan$.text(w);this._layoutWarn();this._dom$.bind("mousemove",$.proxy(function(e){this._layoutWarn()},this))}else{if(this._warn$){this._warn$.hide(0);this._dom$.unbind("mousemove")}}};b.prototype._layoutWarn=function(){this._warn$.removeClass(C.COMMON_PREFIX+'analysisDraggingToken-warn');this._warn$.addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn');this._warnspan$.removeClass(C.COMMON_PREFIX+'analysisDraggingToken-warn-text');this._warnspan$.addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn-text');this._warn$.css({'maxWidth':document.body.clientWidth+'px'});var d=this._dom$.outerWidth();var c=this._dom$.outerHeight();var l=this._dom$.offset().left-document.body.scrollLeft;var r=document.body.clientWidth-this._dom$.offset().left-d;var w=false;var m=0;var e=0;var f=d;var g=this._warnspan$.outerWidth();this._warn$.hide(0);if(r>=g){m=-c;e=d;f=g}else if(l>=g){e=-g}else if(r>=f){w=true;m=-c;e=d;f=r}else if(l>=f){w=true;e=-l;g=l}else{w=true;e=-l}f=Math.min(f,document.body.clientWidth);g=Math.min(g,document.body.clientWidth);this._warn$.css({'marginTop':m+'px','marginLeft':e+'px','minWidth':f+'px','maxWidth':g+'px'});if(w){this._warnspan$.css({'whiteSpace':'pre-line'})}this._warn$.show(0)};b.prototype._createChildren=function(){this._dom$.addClass(C.COMMON_PREFIX+'analysisDraggingToken');var s=$(document.createElement('span')).appendTo(this._dom$).text(this.analysisObject.name());s.addClass(C.COMMON_PREFIX+'text-ellipsis');var i=this._icon$=$(document.createElement('input')).appendTo(this._dom$);i.addClass(C.COMMON_PREFIX+'analysisDraggingToken-icon')};return b});define('sap/viz/controls/common/managers/DragManager',['jquery','sap/viz/controls/common/views/drag/DefaultAnalysisToken','sap/viz/controls/common/views/drag/AnalysisToken','sap/viz/controls/common/views/drag/DropAction'],function($,D,A,a){var b=function(){this.__className="sap.viz.controls.common.managers.DragManager"};b._instance=null;b.instance=function(){if(!b._instance){b._instance=new b()}return b._instance};b.enableDraggableFeeding=function(d,c){var e=$(d);e.off('dragstart',b._feedingDragStartHandler);e.on('dragstart',b._feedingDragStartHandler);e.addClass(b.DRAGGABLE_CLASS_ANALYSIS);e.data(b._KEY_ANALYSIS,c)};b.disableDraggableFeeding=function(d){var c=$(d);c.off('dragstart',b._feedingDragStartHandler);c.removeClass(b.DRAGGABLE_CLASS_ANALYSIS);c.removeData(b._KEY_ANALYSIS)};b.getDefaultHelper=function(d){var c=$(d);var e=c.data(b._KEY_ANALYSIS);if(!e){return null}var h=document.createElement('div');var t=new D(h,d,e);$(h).data(b._KEY_TOKEN,t);return h};b._feedingDragStartHandler=function(e,u){var d=$(e.currentTarget);u.helper.data(b._KEY_ANALYSIS,d.data(b._KEY_ANALYSIS));u.helper.data(b._KEY_DRAGGABLE,d[0])};b.DRAGGABLE_CLASS_ANALYSIS='viz-controls-common-analysisDraggable';b._KEY_ANALYSIS='sap.viz.controls.reserved.draggableFeeding.analysisObject';b._KEY_TOKEN='sap.viz.controls.reserved.draggableFeeding.analysisToken';b._KEY_DRAGGABLE='sap.viz.controls.reserved.draggableFeeding.domDraggable';b.prototype.getAnalysisToken=function(h){var t=h.data(b._KEY_TOKEN);if(t){return t}else{var c=h.data(b._KEY_ANALYSIS);if(c){t=new A(h[0],h.data(b._KEY_DRAGGABLE),c);h.data(b._KEY_TOKEN,t);return t}else{return null}}};return b});define('sap/viz/controls/common/helpers/Rectangle',[],function(){var R=function(l,t,w,h){this._left=l;this._top=t;this._width=w;this._height=h};R.parseDOM=function(d){var o=d.offset();return new R(o.left,o.top,d.outerWidth(),d.outerHeight())};R.prototype.left=function(v){if(arguments.length>0){this._left=v}else{return this._left}};R.prototype.top=function(v){if(arguments.length>0){this._top=v}else{return this._top}};R.prototype.right=function(v){if(arguments.length>0){this.left(v-this.width())}else{return this.left()+this.width()}};R.prototype.bottom=function(v){if(arguments.length>0){this.top(v-this.height())}else{return this.top()+this.height()}};R.prototype.width=function(){return this._width};R.prototype.height=function(){return this._height};R.prototype.hCenter=function(){return this.left()+this.width()/2};R.prototype.vCenter=function(){return this.top()+this.height()/2};R.prototype.hContains=function(t){return this.left()<=t.left()&&this.right()>=t.right()};R.prototype.vContains=function(t){return this.top()<=t.top()&&this.bottom()>=t.bottom()};R.prototype.contains=function(t){return this.hContains(t)&&this.vContains(t)};R.toJSON=function(i){return{'left':i.left(),'top':i.top(),'width':i.width(),'height':i.height()}};return R});define('sap/viz/controls/common/views/menu/PopUpMenuEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var P=function(t,a,d){P.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.common.views.PopUpMenuEvent'};O.extend(P,E);P.OPENED='opened';P.CLOSED='closed';P.ITEM_SELECTED='itemSelected';return P});define('sap/viz/controls/common/views/menu/DockStrategy',[],function(){var D={};D.RIGHT='right';D.RIGHT_WITH_ARROW='rightWithArrow';D.LEFT='left';D.LEFT_WITH_ARROW='leftWithArrow';D.DOWN='down';D.DOWN_WITH_ARROW='downWithArrow';D.UP='up';D.UP_WITH_ARROW='upWithArrow';D._oppsosite=(function(){var o={};o[D.RIGHT]=D.LEFT;o[D.RIGHT_WITH_ARROW]=D.LEFT_WITH_ARROW;o[D.DOWN]=D.UP;o[D.DOWN_WITH_ARROW]=D.UP_WITH_ARROW;return o})();D.oppsosite=function(s){for(var p in D._oppsosite){if(D._oppsosite.hasOwnProperty(p)){var n=D._oppsosite[p];if(p===s){return n}else if(n===s){return p}}}};D.arrow=function(s){return s===D.RIGHT_WITH_ARROW||s===D.LEFT_WITH_ARROW||s===D.DOWN_WITH_ARROW||s===D.UP_WITH_ARROW};D.up=function(s){return s===D.UP||s===D.UP_WITH_ARROW};D.down=function(s){return s===D.DOWN||s===D.DOWN_WITH_ARROW};D.left=function(s){return s===D.LEFT||s===D.LEFT_WITH_ARROW};D.right=function(s){return s===D.RIGHT||s===D.RIGHT_WITH_ARROW};D.horizontal=function(s){return D.left(s)||D.right(s)};D.vertical=function(s){return D.up(s)||D.down(s)};return D});define('sap/viz/controls/common/views/menu/PopUpMenu',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/UIControl','sap/viz/controls/common/helpers/Rectangle','sap/viz/controls/common/views/menu/PopUpMenuEvent','sap/viz/controls/common/views/menu/DockStrategy'],function($,C,O,u,U,R,P,D){var c=C.COMMON_PREFIX;var a=function(d,m){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.menu.PopUpMenu";this._menuGroups=m;this._dock$=null;this._preferredDockStrategy=null;this._dockStrategy=null;this._hOffset=null;this._vOffset=null;this._subMenu=null;this._documentHandler=null;this._createChildren();this._dom$.appendTo($('body'))};O.extend(a,U);a.prototype.open=function(d,p,h,o){this._dock$=d;this._preferredDockStrategy=p;this._hOffset=h?h:0;this._vOffset=o?o:0;this._locate(this._preferredDockStrategy);this._dispatchEvent(new P(P.OPENED,this));this._documentHandler=$.proxy(function(e){var b=this._dock$[0];if(!$.contains(this._dom,e.target)&&((!this._subMenu&&(!$.contains(b,e.target)||b.nodeName!=='LI'))||(this._subMenu&&!$.contains(this._subMenu._dom,e.target)))){this.close()}},this);document.addEventListener("mousedown",this._documentHandler,true)};a.prototype.close=function(){var d=this._dom$;document.removeEventListener("mousedown",this._documentHandler,true);this._dispatchEvent(new P(P.CLOSED,this));this.removeAllEventListeners();u.delay(function(){d.removeClass(c+'menu-transition');d.detach()},240);this._dom$.css('opacity',0).addClass(c+'menu-transition');this.destroy()};a.prototype._createChildren=function(){var i,j;var d=this._dom$;d.addClass(c+'menu');var l=$('<div/>').addClass([c+'menu-list',C.COMMON_PREFIX+'scrollable',C.COMMON_PREFIX+'scrollable-y'].join(' ')).appendTo(d);var b=$('<ul/>').appendTo(l);for(i=0;i<this._menuGroups.length;i++){var m=this._menuGroups[i];for(j=0;j<m.menuItems().length;j++){var e=m.menuItems()[j];var f=$('<li/>').appendTo(b);f.addClass(c+'menu-list-prefix-icon-x1');f.data('item',e);if(m.selectedItem()===e){f.addClass(c+'menu-list-selected')}f.on('mouseenter',function(k){$('li',b).each(function(){var f=$(this);if(this===k.currentTarget){f.addClass(c+'menu-list-hovered')}else{f.removeClass(c+'menu-list-hovered')}})}).on('mouseleave',function(k){});f.on('click',$.proxy(function(k){var f=$(k.currentTarget);var e=f.data('item');if(e.subMenuGroups()){return}else{this._dispatchEvent(new P(P.ITEM_SELECTED,this,{'selectedItem':e}));this.close()}},this));var g=$('<div/>').addClass([c+'menu-list-caption',c+'text-ellipsis'].join(' ')).appendTo(f);g.text(e.name());var h=false;f.on('mouseenter',$.proxy(function(k){this._closeSubMenu()},this)).on('mouseleave',$.proxy(function(k){var f=$(k.currentTarget);var e=f.data('item');u.defer($.proxy(function(){if(!h){this._closeSubMenu()}},this))},this));if(e.subMenuGroups()){f.addClass(c+'menu-list-suffix-icon-x1');$('<div/>').addClass([c+'menu-list-suffix-icon-submenu',c+'havanaSharedSprite16'].join(' ')).appendTo(f);f.on('mouseenter',$.proxy(function(k){var f=$(k.currentTarget);var e=f.data('item');h=e.subMenuGroups().length>0;if(e.subMenuGroups().length>0){this._subMenu=new a(document.createElement('div'),e.subMenuGroups());this._subMenu.addEventListener(P.ITEM_SELECTED,function(k){this._dispatchEvent(k);this.close()},this);this._subMenu.open(f,D.RIGHT,-6,6);$(this._subMenu._dom).on('mouseenter',$.proxy(function(k){h=true},this))}},this))}}if(i!==this._menuGroups.length-1){var s=$('<div/>').addClass(c+'menu-list-group-splitter').appendTo(b)}}};a.prototype._closeSubMenu=function(){if(this._subMenu){$(this._subMenu._dom).off('mouseenter');this._subMenu.close();this._subMenu=null}};a.prototype._locate=function(d){var b=(d===this._preferredDockStrategy);var f=false;var t={'from':{'visibility':'hidden','opacity':0},'to':{'visibility':'','opacity':1}};var g=6;var e=6;var h=R.parseDOM(this._dock$);var m=R.parseDOM(this._dom$);var i=R.parseDOM($('body'));var w=D.arrow(d);if(D.horizontal(d)){if(D.left(d)){e*=-1;g*=-1;m.right(h.left()+g-this._hOffset)}else if(D.right(d)){m.left(h.right()+g+this._hOffset)}m.top(h.top()+this._vOffset);f=!i.hContains(m);t.from.left=m.left()-e+'px';t.to.left=m.left()+'px';t.from.top=t.to.top=m.top()+'px'}else if(D.vertical(d)){if(w){m.left(h.hCenter()-m.width()*3/4+this._hOffset)}else{m.left(h.left()+this._hOffset)}if(D.up(d)){e*=-1;g*=-1;m.bottom(h.top()+g+this._vOffset)}else if(D.down(d)){m.top(h.bottom()+g+this._vOffset)}f=!i.vContains(m);t.from.left=t.to.left=m.left()+'px';t.from.top=m.top()-e+'px';t.to.top=m.top()+'px'}if(b&&f){this._locate(D.oppsosite(d))}else{this._dockStrategy=d;if(t){this._dom$.css(t.from);u.defer($.proxy(function(){this._dom$.css(t.to).addClass(c+'menu-transition')},this));u.delay($.proxy(function(){this._dom$.removeClass(c+'menu-transition')},this),240)}}};return a});define('sap/viz/controls/common/views/feed/FeedingShelf',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/UIControl','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/views/feed/FeedingShelfEvent','sap/viz/controls/common/views/menu/PopUpMenu','sap/viz/controls/common/views/menu/PopUpMenuEvent','sap/viz/controls/common/views/menu/DockStrategy','sap/viz/controls/common/views/menu/MenuGroup','sap/viz/controls/common/views/menu/MenuItem','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/feeds/HierarchyLevelObject'],function($,O,U,C,a,D,b,F,P,c,d,M,e,L,A,f,g,H){var h=function(i,s){h.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedingShelf";this._dom$.addClass(C.FEEDINGSHELF_PREFIX+"view");this._list$=null;this._ghostCard$=null;this._draggingCard$=null;this._addIndicator$=null;this._addIcon$=null;this._activeHandler=$.proxy(this._active,this);this._dropIndicator$=$(document.createElement('hr')).addClass(C.FEEDINGSHELF_PREFIX+'drop-indicator');this._shelf=s;this._createChildren();this._droppable();this._enableFeeding=true};O.extend(h,a);h.CARD_HEIGHT=24;h.prototype.shelf=function(){return this._shelf};h.prototype.popUpDock=function(){var o=this._list$.offset();return{'x':o.left,'y':o.top+h.CARD_HEIGHT/2,'shelfWidth':this._list$.width()}};h.prototype.analyses=function(v){if(arguments.length>0){var i;var j={};for(i=0;i<v.length;){if(!j[v[i].id()]){j[v[i].id()]=true;i++}else{v.splice(i,1)}}this._traversalCards(function(){$(this).remove()},true,true);for(i=0;i<v.length;i++){this._addCardAt(v[i],-1)}this._analysesChanged();return this}else{var k=[];this._traversalCards(function(l){var m=$(this);var n=m.data('__analysis');if(n){k.push(n)}},true,true);return k}};h.prototype._numCards=function(){var n=0;this._traversalCards(function(i){n++},true,true);return n};h.prototype.addAnalysis=function(i){return this._addAnalysisAt(i,-1)};h.prototype._addAnalysisAt=function(i,j){var k=this._addCardAt(i,j);this._analysesChanged();return k};h.prototype.destroy=function(){this.removeAllEventListeners();$('body').off('mouseup',this._activeHandler);h.superclass.destroy.apply(this,arguments)};h.prototype._createChildren=function(){var i=$(document.createElement('div')).appendTo(this._dom$).addClass(C.FEEDINGSHELF_PREFIX+'item');var j=$(document.createElement('div')).appendTo(i).addClass(C.FEEDINGSHELF_PREFIX+'item-title');j.text(this._shelf.name);var k=$(document.createElement('div')).appendTo(i).addClass(C.FEEDINGSHELF_PREFIX+'item-content');var l=this._list$=$(document.createElement('div')).appendTo(k).addClass(C.FEEDINGSHELF_PREFIX+'item-list');var m=this._addIndicator$=$(document.createElement('div')).appendTo(l);m.addClass(C.FEEDINGSHELF_PREFIX+'item-ph');var n=$(document.createElement('a')).appendTo(m);n.addClass(C.FEEDINGSHELF_PREFIX+'item-ph-text');var o=this._addIcon$=$(document.createElement('div')).appendTo(k).addClass(C.COMMON_PREFIX+'havanaVXTabSprite16');o.addClass(C.FEEDINGSHELF_PREFIX+'item-add-icon');var p=$.proxy(this._dispatchAddFeedingEvent,this);m.on('mousedown',this._activeHandler).on('mouseenter',this._activeHandler).on('mouseleave',this._activeHandler).on('click',p);o.on('mousedown',this._activeHandler).on('mouseenter',this._activeHandler).on('mouseleave',this._activeHandler).on('click',p);$('body').on('mouseup',this._activeHandler)};h.prototype._dispatchAddFeedingEvent=function(){this._dispatchEvent(new F(F.CLICK_ADD_FEEDING,this))};h.prototype._active=function(i){if(i.type==='mouseup'||i.type==='mouseleave'){this._list$.removeClass(C.FEEDINGSHELF_PREFIX+'item-list_active');this._addIcon$.removeClass(C.FEEDINGSHELF_PREFIX+'item-add-icon_active')}else if(i.type==='mousedown'||i.type==='mouseenter'){this._list$.addClass(C.FEEDINGSHELF_PREFIX+'item-list_active');this._addIcon$.addClass(C.FEEDINGSHELF_PREFIX+'item-add-icon_active')}};h.prototype._isValidToken=function(j){if(this._draggingCard$){return true}var t=j.type();var k=j.dataType();var l=t?t.toLowerCase():t;var m=k?k.toLowerCase():k;var s=this._shelf.feedItemType;var v=g.feedCompatible(s,l,m);if(v){var n=this.analyses();for(var i=0;i<n.length;i++){if(n[i].id()===j.id()){v=false;break}}}return v};h.prototype._droppable=function(){var _=this;var j;var k;this._list$.droppable({tolerance:'pointer',accept:'.'+D.DRAGGABLE_CLASS_ANALYSIS,activate:function(i,u){},deactivate:$.proxy(function(i,u){if(this._ghostCard$){this._ghostCard$.remove()}if(this._dropIndicator$){this._dropIndicator$.detach()}},this),drop:$.proxy(function(i,u){var l=u.helper;var t=D.instance().getAnalysisToken(l);var m=t.analysisObject;if(t.currentAction()!==b.DENY&&this._isValidToken(m)){t.killRevertAnimation();if(j){t.currentAction(b.ACCEPT_AS_REPLACEMENT);$(j).detach()}else{t.currentAction(b.ACCEPT)}this._addAnalysisAt(m,k)}else{t.currentAction(b.DENY)}t.dropTarget(this._shelf);if(this._ghostCard$){this._ghostCard$.remove()}this._dropIndicator$.detach()},this),over:function(l,u){var m=u.helper;U.defer(function(){var t=D.instance().getAnalysisToken(m);var n=t.analysisObject;if(_._isValidToken(n)){if(_._numCards()===0){if(!_._enableFeeding){t.currentAction(b.DENY);var w=L.get('VIZ_COMMON_DIMENSION_LIMITATION_WARN');t.showWarn(w);return}else{_._ghostCard$=_._addGhostAnalysisAt(n,0);t.currentAction(b.ACCEPT)}}else{m.on('sap.viz.controls.analysisDrag.events.drag',function(l,p,o){var q=[];var r=-1;_._traversalCards(function(y){if(_._draggingCard$&&_._draggingCard$[0]===this){r=y}q.push({'card':this,'offset':$(this).offset()})},false,true);k=-1;j=null;for(var i=0;i<q.length;i++){var s=q[i].offset.top;if(o<s+h.CARD_HEIGHT-6){k=i;if(o>=s+2){}break}}if(k===-1){k=q.length}if(n.type===A.MND){k=(k<q.length/2)?0:q.length}if(!_._draggingCard$&&_._numCards()===_._shelf.capacity){j=q[k===q.length?k-1:k].card}var v=r!==-1;var x=v&&(r===k||(r+1===k&&!j));if(v){j=null}_._dropIndicator$.detach();if(j){t.currentAction(b.ACCEPT_AS_REPLACEMENT)}else{t.currentAction(b.ACCEPT);if(!x){_._addElementAt(_._list$,_._dropIndicator$,k)}}})}}else{t.currentAction(b.DENY)}})},out:$.proxy(function(i,u){var l=u.helper;l.off('sap.viz.controls.analysisDrag.events.drag');var t=D.instance().getAnalysisToken(l);t.playDefaultAction();if(this._ghostCard$){this._ghostCard$.remove()}this._dropIndicator$.detach();t.showWarn()},this)})};h.prototype._traversalCards=function(j,k,l){var m=this._list$.children();var n=0;for(var i=0;i<m.length;i++){var o=m[i];if(this._addIndicator$&&this._addIndicator$[0]===o){continue}if(this._dropIndicator$&&this._dropIndicator$[0]===o){continue}if(k&&this._draggingCard$&&this._draggingCard$[0]===o){continue}if(l&&this._ghostCard$&&this._ghostCard$[0]===o){continue}j.call(o,n);n++}};h.prototype._addGhostAnalysisAt=function(i,j){var k=this._addCardAt(i,j);k.addClass(C.FEEDINGSHELF_PREFIX+'card-ghost');return k};h.prototype._removeCard=function(i){i.remove();this._analysesChanged()};h.prototype._analysesChanged=function(){var n=this._numCards();if(n>=1){this._addIndicator$.addClass(C.FEEDINGSHELF_PREFIX+'item-ph-half')}else{this._addIndicator$.removeClass(C.FEEDINGSHELF_PREFIX+'item-ph-half')}if(n>=this._shelf.capacity){this._addIcon$.css('display','none');this._addIndicator$.detach()}else{this._addIcon$.css('display','block');this._addIndicator$.appendTo(this._list$)}this._dispatchEvent(new F(F.FEEDING_CHANGED,this))};h.prototype._updateCard=function(i,j){var k;if(j.type()===A.HIERARCHY){k=j.selectedHierarchyLevel().name()}else{k=j.name()}i.data('__analysis',j);i.attr('title',k);var t=$('.'+C.FEEDINGSHELF_PREFIX+'card-text',i);t.text(k)};h.prototype._genHierarchyMenuGroups=function(j){var m=[];var k=j.hierarchyLevels();for(var i=0;i<k.length;i++){var l=k[i];var n=new e(l.id(),l.name());n.selected(l.selected());m.push(n)}var o=[new M(m,true)];return o};h.prototype._genMeasureMenuGroups=function(i){return i.actions()};h.prototype._addCardAt=function(k,l){var m=$(document.createElement('div')).addClass(C.FEEDINGSHELF_PREFIX+'card');var n=0;var i,j;var o,p,q,s;if(k.type()===A.HIERARCHY){var r=$(document.createElement('span')).appendTo(m);r.addClass([C.FEEDINGSHELF_PREFIX+'hierarchy-card-icon',C.COMMON_PREFIX+'UVBSharedSprite'].join(' '));this._createCardAction(m,this._genHierarchyMenuGroups,$.proxy(function(w){k=k.clone();k.selectedHierarchyLevelID(w.data.selectedItem.id());this._updateCard(m,k);this._dispatchEvent(new F(F.FEEDING_CHANGED,this))},this),k);n++}else if(k.type()===A.MEASURE&&k.actions()&&k.actions().length>0){this._createCardAction(m,this._genMeasureMenuGroups,$.proxy(function(w){this._dispatchEvent(new F(F.ACTION_CHANGED,this,{'feedItemID':this._shelf.id,'analysisObjectID':k.id(),'actionID':w.data.selectedItem.id()}))},this),k);n++}var t=$(document.createElement('div')).appendTo(m);t.attr('style','width:19px; height:22px;');t.addClass(C.FEEDINGSHELF_PREFIX+'card-operation-div');var u=$(document.createElement('span')).appendTo(t);u.addClass(C.FEEDINGSHELF_PREFIX+'card-operation '+C.COMMON_PREFIX+'havanaSharedSprite16');t.click($.proxy(function(){this._removeCard(m)},this));n++;var v=$(document.createElement('div')).appendTo(m);v.addClass([C.FEEDINGSHELF_PREFIX+'card-text',C.FEEDINGSHELF_PREFIX+'card-text-with-icon-'+n].join(' '));v.addClass(C.COMMON_PREFIX+'text-ellipsis');this._updateCard(m,k);this._addElementAt(this._list$,m,l);this._draggable(m);return m};h.prototype._createCardAction=function(i,m,j,k){var l=$(document.createElement('div')).appendTo(i);l.attr('style','width:19px; height:22px;');l.addClass(C.FEEDINGSHELF_PREFIX+'action-icon-div');var n=$(document.createElement('span')).appendTo(l);if(k.type()===A.HIERARCHY){i.addClass(C.FEEDINGSHELF_PREFIX+'card-hierarchy');n.addClass([C.FEEDINGSHELF_PREFIX+'action-icon-hierarchy',C.COMMON_PREFIX+'UVBSharedSprite'].join(' '))}if(k.type()===A.MEASURE){i.addClass(C.FEEDINGSHELF_PREFIX+'card-measure');n.addClass([C.FEEDINGSHELF_PREFIX+'action-icon-measure',C.COMMON_PREFIX+'havanaSharedSprite16'].join(' '))}l.on('click',$.proxy(function(){var o=new P(document.createElement('div'),m.call(this,i.data('__analysis')));o.addEventListener(c.ITEM_SELECTED,j,this);o.open(l,d.DOWN_WITH_ARROW)},this));return l};h.prototype._addElementAt=function(i,j,k){var l=i.children();if(k!==-1&&k<l.length){$(l[k]).before(j)}else{i.append(j)}};h.prototype._draggable=function(i){var _=this;D.enableDraggableFeeding(i[0],i.data('__analysis'));i.draggable({containment:document.body,revert:'valid',helper:function(j){var k=D.getDefaultHelper(this);var t=D.instance().getAnalysisToken($(k));t.defaultAction(b.AS_TRASH);return k},start:$.proxy(function(j,u){this._draggingCard$=$(this);this._draggingCard$.addClass(C.FEEDINGSHELF_PREFIX+'card-ghost');var k=u.helper;var t=D.instance().getAnalysisToken(k);var l=t.analysisObject;var m={'analysisObject':l,'feedId':this._shelf.id};this._dispatchEvent(new F(F.FEEDING_EMPTY_CHANGED,this,m))},this),stop:function(j,u){var k=u.helper;if(_._draggingCard$){_._draggingCard$.removeClass(C.FEEDINGSHELF_PREFIX+'card-ghost');_._draggingCard$=null}var t=D.instance().getAnalysisToken(k);if(!t.dropTarget()||t.currentAction()===b.ACCEPT||t.currentAction()===b.ACCEPT_AS_REPLACEMENT){_._removeCard($(this))}else{var l={'analysisObject':t.analysisObject,'feedId':_._shelf.id};_._dispatchEvent(new F(F.FEEDING_DROP_DENY,this,l))}},drag:function(j,u){}})};h.prototype.enableFeeding=function(i){if(arguments.length>0){this._enableFeeding=i;this._updateFeedingEnabled(i)}else{return this._enableFeeding}};h.prototype._updateFeedingEnabled=function(i){var j=C.FEEDINGSHELF_PREFIX+'item-list-feeding-disable';if(i){this._list$.removeClass(j);this._addIcon$.css('display','block')}else{this._list$.addClass(j);this._addIcon$.css('display','none')}};h.langProps={'changeCalculation':'VIZ_COMMON_CHANGE_CALCULATION','sum':'VIZ_COMMON_SUM','average':'VIZ_COMMON_AVERAGE','min':'VIZ_COMMON_MIN','max':'VIZ_COMMON_MAX','countDistinct':'VIZ_COMMON_COUNT_DISTINCT','countAll':'VIZ_COMMON_COUNT_ALL','none':'VIZ_COMMON_NONE','sum_short':'VIZ_COMMON_SUM_SHORT','average_short':'VIZ_COMMON_AVERAGE_SHORT','min_short':'VIZ_COMMON_MIN_SHORT','max_short':'VIZ_COMMON_MAX_SHORT','countDistinct_short':'VIZ_COMMON_COUNT_DISTINCT_SHORT','countAll_short':'VIZ_COMMON_COUNT_ALL_SHORT','none_short':'VIZ_COMMON_NONE_SHORT'};return h});define('sap/viz/controls/common/views/feed/FeedListEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedListEvent"};O.extend(F,E);F.DROP_DOWN_OPENED="dropDownOpened";F.DROP_DOWN_CLOSED="dropDownClosed";F.ITEM_SELECTED="itemSelected";return F});define('sap/viz/controls/common/constants/KeyboardEventConst',[],function(){var K={};K.UP=38;K.DOWN=40;K.ENTER=13;K.SPACE=32;K.ESC=27;return K});define('sap/viz/controls/common/views/feed/FeedList',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/constants/KeyboardEventConst'],function($,C,u,O,U,F,L,A,a,b,K){var c=function(e,f,g,h){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedList";this._dom$=$(e);this._analyses=f;this._feedingType=g;this._dataProvider=[];var i,j;var k=function(m){for(var i=0;i<h.length;i++){if(h[i].id()===m){return true}}return false};if(f){for(i=0;i<f.length;i++){var l=f[i];if(k(l.id())){continue}if(b.feedCompatible(this._feedingType,l.type(),l.dataType())){this._dataProvider.push({'label':l.name(),'analysis':l})}}}this._header={'label':L.get(c.langProps[this._feedingType]),'suffix':this._dataProvider.length};this._container$=null;this._content$=null;this._header$=null;this._ul$=null;this._arrow$=null;this._createChildren();this._documentHandler=null;this._keyDownHandlerProvider=$.proxy(this._keyDownHandler,this);this._mouseMoveHandlerProvider=$.proxy(this._mouseMoveHandler,this)};O.extend(c,U);c.langProps={'Measure':'VIZ_COMMON_MEASURES','Dimension':'VIZ_COMMON_DIMENSIONS','Geography':'VIZ_COMMON_DIMENSIONS'};var S='down';var d='up';c.prototype.locate=function(e,o){var f=this._dom$;var g=this._ul$;var h=g.outerHeight();var i=$("body").innerHeight();var m=i-this._header$.outerHeight()-15;if(h>m){h=m;g.outerHeight(h)}var j=h+this._header$.outerHeight()+5;var k=Math.max(g.outerWidth(),this._header$.outerWidth());var l='left';if(o==='left'||o==='right'){l=o}else if(k>e.x){l='right'}var n=8;var p=this._arrow$.outerHeight()+18;var q=Math.max(0,e.y-i+p/2+n);e.y=Math.min(e.y,i-p/2-n);var t=Math.max(e.y-q+p/2+n-j,5);var r=Math.min(e.y-t-12,i-p-n-t-q);if(l==='right'){this._container$.addClass(C.COMMON_PREFIX+'feedlist-container-right');f.css({"left":e.x+e.shelfWidth,"top":t});this._arrow$.css({"left":-12,"top":r})}else if(l==='left'){this._container$.addClass(C.COMMON_PREFIX+'feedlist-container-left');f.css({"left":e.x-k-24,"top":t});this._arrow$.css({"left":k-20,"top":r})}this._content$.css({'width':k+'px','height':j+'px'});this._container$.css({'width':k+2+'px','height':j+'px'})};c.prototype.open=function(e){this._dock=e;var f=this._dom$;f.appendTo($("body"));this._dispatchEvent(new F(F.DROP_DOWN_OPENED,this));this.locate(e);this._documentHandler=$.proxy(function(g){if(!$.contains(this._dom,g.target)){this.close()}},this);document.addEventListener("mousedown",this._documentHandler,true);document.addEventListener("keydown",this._keyDownHandlerProvider,true);this._cursorShowed=true};c.prototype.close=function(){var e=this._dom$;var f=1;if(this._classVisible){e.removeClass(this._classVisible);f=2000}setTimeout(function(){e.detach()},f);document.removeEventListener("mousedown",this._documentHandler,true);document.removeEventListener("keydown",this._keyDownHandlerProvider,true);document.removeEventListener("mousemove",this._mouseMoveHandlerProvider,true);this._dispatchEvent(new F(F.DROP_DOWN_CLOSED,this));if(!this._cursorShowed){$('.'+C.COMMON_PREFIX+'hide-cursor').removeClass(C.COMMON_PREFIX+'hide-cursor')}this.destroy()};c.prototype._createChildren=function(e){this._dom$.addClass(C.COMMON_PREFIX+'feedlist');var _=this;var f=this._container$=$(document.createElement('div')).appendTo(this._dom$);f.addClass(C.COMMON_PREFIX+'feedlist-container');var g=this._arrow$=$(document.createElement('div')).appendTo(f);g.addClass(C.COMMON_PREFIX+'feedlist-arrow');g.addClass(C.PREFIX+'feedlist');var h=this._content$=$(document.createElement('div')).appendTo(f);h.addClass(C.COMMON_PREFIX+'feedlist-content');var j=this._header$=$(document.createElement('div')).appendTo(h).text(this._header.label);j.addClass(C.COMMON_PREFIX+'feedlist-content-header');var k=this._ul$=$(document.createElement('ul')).appendTo(h);k.addClass(C.COMMON_PREFIX+'scrollable');k.addClass(C.COMMON_PREFIX+'scrollable-y');var i;var l;for(i=0;i<this._dataProvider.length;i++){var m=$(document.createElement('li')).appendTo(k);var n=$(document.createElement('a')).appendTo(m);l=this._dataProvider[i];var o,p;var q=l.analysis.dataType();var r=b.isGeoHierarchyFeed(this._feedingType,l.analysis.type(),q);if((this._feedingType===a.DIMENSION&&l.analysis.type()===A.HIERARCHY)||r){var s=this._setHierarchyAnalysis(l.analysis.clone(),0);m.data('__item',s);o=$(document.createElement('div')).appendTo(m);o.addClass(C.COMMON_PREFIX+'feedlist-li-hierarchy-indicator');p=$(document.createElement('div')).appendTo(o);p.addClass(C.COMMON_PREFIX+'UVBSharedSprite');if(q&&q.toLowerCase()===a.GEOGRAPHY.toLowerCase()){p.addClass(C.COMMON_PREFIX+'geography')}else{p.addClass(C.COMMON_PREFIX+'feedlist-li-hierarchy-Icon')}var t=$(document.createElement('div')).appendTo(m);t.data('__items',l.analysis);t.addClass(C.COMMON_PREFIX+'feedlist-li-button');var v=$(document.createElement('div')).appendTo(t);v.addClass(C.COMMON_PREFIX+'havanaVXTabSprite16 '+C.COMMON_PREFIX+'feedlist-li-plus-icon');t.attr('command','open');t.click(function(w){w.stopPropagation();_._expandButtonHandler(w)});m.click($.proxy(this._analysisSelectedHandler,this))}else{if(q&&q.toLowerCase()===a.GEOGRAPHY.toLowerCase()){o=$(document.createElement('div')).appendTo(m);o.addClass(C.COMMON_PREFIX+'feedlist-li-hierarchy-indicator');p=$(document.createElement('div')).appendTo(o);p.addClass(C.COMMON_PREFIX+'geography')}m.data('__item',l.analysis);m.click($.proxy(this._analysisSelectedHandler,this))}m.hover($.proxy(function(w){this._highlightItem($(w.currentTarget))},this),$.proxy(function(w){this._unhighlightItem($(w.currentTarget))},this));n.text(l.label);n.addClass(C.COMMON_PREFIX+'text-ellipsis');if(l.suffix){n.addClass(C.COMMON_PREFIX+'feedlist-li-a_suffix').attr('__suffix',l.suffix)}if(l.icon){}}};c.prototype._expandButtonHandler=function(e){var f=$(e.currentTarget);if(f.attr('command')==='open'){this._openHierarchyItem(f)}else{this._closeHierarchyItem(f)}};c.prototype._setHierarchyAnalysis=function(h,i){var e=h.hierarchyLevels();for(var j=0;j<e.length;j++){var l=e[j];if(j===i){l.selected(true)}else{l.selected(false)}}return h};c.prototype._analysisSelectedHandler=function(e){var _=this;var l=$(e.currentTarget);var i=l.data('__item');_._dispatchEvent(new F(F.ITEM_SELECTED,_,{'selectedItem':i}));_.close()};c.prototype._keyDownHandler=function(e){var k=e.keyCode;if(!e.ctrlKey&&(k===K.DOWN||k===K.UP)){if(this._cursorShowed){$("*").addClass(C.COMMON_PREFIX+'hide-cursor');this._cursorShowed=false;setTimeout($.proxy(function(){document.addEventListener('mousemove',this._mouseMoveHandlerProvider,true)},this),200)}}var l=$('.'+C.COMMON_PREFIX+'feedlist-li-highlight',this._ul$);switch(k){case K.UP:if(e.ctrlKey){var m=$('.'+C.COMMON_PREFIX+'feedlist-li-minus-icon',l);if(m[0]){this._closeHierarchyItem(m.parent())}}else if(l[0]!=this._ul$[0].firstChild){this._unhighlightItem(l);this._highlightItem(l.prev());if(l.offset().top-this._ul$.offset().top<l.height()){this._updateScrollBarPosition(l,d)}}break;case K.DOWN:if(e.ctrlKey){var p=$('.'+C.COMMON_PREFIX+'feedlist-li-plus-icon',l);if(p[0]){this._openHierarchyItem(p.parent())}}else{if(!l[0]){this._highlightItem($(this._ul$[0].firstChild))}else if(l[0]!=this._ul$[0].lastChild){this._unhighlightItem(l);this._highlightItem(l.next());if(l.offset().top+l.height()>this._ul$.offset().top+this._ul$.height()){this._updateScrollBarPosition(l,S)}}}break;case K.ENTER:case K.SPACE:if(l[0]){this._selectItem(l)}break;case K.ESC:this.close();break}};c.prototype._mouseMoveHandler=function(e){if(!this._cursorShowed){$('.'+C.COMMON_PREFIX+'hide-cursor').removeClass(C.COMMON_PREFIX+'hide-cursor');this._cursorShowed=true;document.removeEventListener('mousemove',this._mouseMoveHandlerProvider,true);var l=$('.'+C.COMMON_PREFIX+'feedlist-li-highlight',this._ul$);this._unhighlightItem(l)}};c.prototype._highlightItem=function(l){l.addClass(C.COMMON_PREFIX+'feedlist-li-highlight')};c.prototype._unhighlightItem=function(l){l.removeClass(C.COMMON_PREFIX+'feedlist-li-highlight')};c.prototype._selectItem=function(l){var i=l.data('__item');this._dispatchEvent(new F(F.ITEM_SELECTED,this,{'selectedItem':i}));this.close()};c.prototype._openHierarchyItem=function(e){var f=e.data('__items');var h=f.hierarchyLevels();var g=e.parent();for(var i=0;i<h.length;i++){var l=$(document.createElement('li'));$(g).after(l);g=l;var s=$(document.createElement('span')).appendTo(l);var j=this._setHierarchyAnalysis(f.clone(),i);l.data('__item',j);s.text(h[i].name());s.addClass(C.COMMON_PREFIX+'text-ellipsis');l.click($.proxy(this._analysisSelectedHandler,this));l.hover($.proxy(function(k){this._highlightItem($(k.currentTarget))},this),$.proxy(function(k){this._unhighlightItem($(k.currentTarget))},this))}e.attr('command','close');e.addClass(C.COMMON_PREFIX+'feedlist-li-button-close');e.children().attr('class',C.COMMON_PREFIX+'havanaVXTabSprite16 '+C.COMMON_PREFIX+'feedlist-li-minus-icon');this._updateAllExpandButtons()};c.prototype._closeHierarchyItem=function(e){var f=e.data('__items');var h=f.hierarchyLevels();for(var j=0;j<h.length;j++){e.parent().next().remove()}e.attr('command','open');e.removeClass(C.COMMON_PREFIX+'feedlist-li-button-close');e.children().attr('class',C.COMMON_PREFIX+'havanaVXTabSprite16 '+C.COMMON_PREFIX+'feedlist-li-plus-icon');this._updateAllExpandButtons()};c.prototype._updateAllExpandButtons=function(){var h=this._ul$[0].scrollHeight>this._ul$.outerHeight();$('.'+C.COMMON_PREFIX+'feedlist-li-button').each(function(){$(this).removeClass(C.COMMON_PREFIX+'feedlist-li-button-offset');if(h){$(this).addClass(C.COMMON_PREFIX+'feedlist-li-button-offset')}})};c.prototype._updateScrollBarPosition=function(l,e){var f=this._ul$.scrollTop();if(e===S){var n=l.nextAll();var g=l.height()*n.length;if(g<=this._ul$.height()){f+=g}else{f+=(this._ul$.scrollHeight()/l.height())}}else{var p=l.prevAll();var h=l.height()*p.length;if(h<=this._ul$.height()){f=0}else{f-=(this._ul$.scrollHeight()/l.height())}}this._cursorShowed=true;this._ul$.scrollTop(f);setTimeout($.proxy(function(){this._cursorShowed=false},this),500)};return c});define('sap/viz/controls/mapbuilder/widgets/WidgetFeeding',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/views/feed/FeedingShelf","sap/viz/controls/common/views/feed/FeedingShelfEvent","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedUtils",'sap/viz/controls/common/views/feed/FeedList','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/events/FeedEvent',"sap/viz/controls/mapbuilder/constants/Const","sap/viz/controls/mapbuilder/widgets/WidgetBase","sap/viz/controls/mapbuilder/widgets/WidgetTitle"],function($,O,U,C,L,F,a,b,c,d,f,g,h,W,k){var G={id:"location",name:"VIZ_MAPBUILDER_GEO",capacity:1,analysisType:"dimension",feedItemType:"Geography"};var P={id:"color",name:"VIZ_MAPBUILDER_GEO_COLOR",capacity:1,analysisType:"measure",feedItemType:"Measure"};var l={id:"color",name:"VIZ_MAPBUILDER_GEO_COLOR",capacity:1,analysisType:"dimension",feedItemType:"Dimension"};var m={id:"size",name:"VIZ_MAPBUILDER_GEO_SIZE",capacity:1,analysisType:"measure",feedItemType:"Measure"};var n=function(e,i){n.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetFeeding";this._feedMap=this._config.feedMap;this._measures=null;this._attributes=null;this._measures$=null;this._attributes$=null;this._feedingSelves={};this._feedingPanel$=$("<div/>").appendTo(e);this._vizType=this._config.vizType!=null?this._config.vizType:h.VIZ_TYPE_CHOROPLETH;this._titleMeasure=null;this._creatControls();this.update({feeding:this._config.feeding})};O.extend(n,W);n.prototype._prepareFeeding=function(v){if(v==h.VIZ_TYPE_CHOROPLETH){this._measures=[U.clone(P)];this._attributes=[U.clone(G)]}else if(v==h.VIZ_TYPE_BUBBLE){this._measures=[U.clone(m),U.clone(l)];this._attributes=[U.clone(G)]}else if(v==h.VIZ_TYPE_MARKER){this._measures=[];this._attributes=[U.clone(G)]}else{throw L.get('VIZ_MAPBUILDER_NOT_SUPPORT_ERROR')}var o=function(e){var u=e.target();this._uiShelf=u;if(this._config.feedingPanel&&this._config.feedingPanel.useBuildInFeedList===true){var s=u.shelf();var t=document.createElement('div');var w=this._getFeed(s.id);var x=w?w.values():[];var y=new d(t,this._allAnalyses,s.feedItemType,x);y.addEventListener(f.ITEM_SELECTED,function(z){var A=z.data.selectedItem;u.addAnalysis(A)},this);y.open(u.popUpDock())}else{this._dispatchEvent(new g(g.REQUEST_FEED,this,{'feedId':u.shelf().id,'fieldLocalPosition':u.popUpDock()}))}};if(this._measures.length>0){this._measures$.show();for(var i=0;i<this._measures.length;i++){var p=L.get(this._measures[i].name);this._measures[i].name=p?p:"Color";var q=new F(this._measures$,this._measures[i],this._feedMap);q.addEventListener(a.FEEDING_CHANGED,function(e){this._dispatchEvent(e)},this);q.addEventListener(a.CLICK_ADD_FEEDING,o,this);this._feedingSelves[this._measures[i].id]=q}}else{this._measures$.hide()}if(this._attributes.length>0){for(var j=0;j<this._attributes.length;j++){this._attributes[j].name=L.get(this._attributes[j].name);var r=new F(this._attributes$,this._attributes[j],this._feedMap);r.addEventListener(a.FEEDING_CHANGED,function(e){this._dispatchEvent(e)},this);r.addEventListener(a.CLICK_ADD_FEEDING,o,this);this._feedingSelves[this._attributes[j].id]=r}}};n.prototype._creatControls=function(){var r=$(this._dom);this._attributes$=$('<div/>').appendTo(r).addClass(C.MAPBUILDER_PREFIX+'feeding-container');this._measures$=$('<div/>').appendTo(r).addClass(C.MAPBUILDER_PREFIX+'feeding-container');this._prepareFeeding(this._vizType)};n.prototype.update=function(e){var j=e.feeding;if(j){for(var i=0;i<j.length;i++){var o=j[i];if(o){this._feedingSelves[o.id()].enableDispatchEvent(false);this._feedingSelves[o.id()].analyses(o.values());this._feedingSelves[o.id()].enableDispatchEvent(true)}}}};n.prototype.changeFeeding=function(t){this._measures$.empty();for(var e in this._feedingSelves){if(this._feedingSelves.hasOwnProperty(e)){this._feedingSelves[e].removeAllEventListeners()}}this._feedingSelves={};this._attributes$.empty();this._prepareFeeding(t)};n.prototype.getFeeds=function(){var e=[];for(var i in this._feedingSelves){if(this._feedingSelves.hasOwnProperty(i)){var s=this._feedingSelves[i].shelf();e.push(new b(s.id,c.convertFeedType(s.feedItemType),this._feedingSelves[i].analyses()))}}return e};n.prototype._getFeed=function(e){var j=this.getFeeds();for(var i=0;i<j.length;i++){var o=j[i];if(o.id()===e){return o}}return null};n.prototype.save=function(){var e=[];for(var i=0;i<this.getFeeds().length;i++){e[i]=b.toJSON(this.getFeeds()[i])}var j={feeding:e};return j};n.prototype.feedingFromJson=function(j){if(!j){return}var e=[];for(var i=0;i<j.feeding.length;i++){e[i]=b.fromJSON(j.feeding[i])}return e};n.prototype._analysisObjectsForPicker=function(e){if(arguments.length>0){this._allAnalyses=e}else{return this._allAnalyses}};return n});define('sap/viz/controls/mapbuilder/widgets/WidgetProperties',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/widgets/WidgetBase","sap/viz/controls/mapbuilder/events/GeoEvent"],function($,O,C,L,W,G){var a=function(d,c){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetProperties";this._properties=this._config.properties;this._settings=this._config.settings;this._settings$={};this._creatControls()};O.extend(a,W);a.prototype._creatSettings=function(){var r=$(this._dom);for(var i=0;i<this._settings.length;i++){var s=this._settings[i];var b;if(s.type==="check"){b=$("<div/>").appendTo(r);var c=$("<input type=\"checkbox\"></input>").appendTo(b).addClass(C.MAPBUILDER_PREFIX+"inline-block");var n=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"inline-block").html(L.get(s.name)).addClass(C.MAPBUILDER_PREFIX+"inline-block").addClass(C.MAPBUILDER_PREFIX+"property-text").appendTo(b);c.on("click",$.proxy(this._clickCheckBoxHandler,c,s,this));c.attr("checked",s.value);this._settings$[s.id]=c;if((i===0)&&!(this._config.showLegend)){b.hide()}}}};a.prototype._creatControls=function(){this._creatSettings()};a.prototype._clickCheckBoxHandler=function(s,p,e){if(s.checkedEvent&&s.uncheckedEvent){if(this.attr("checked")){p._dispatchEvent(new G(s.checkedEvent,this))}else{p._dispatchEvent(new G(s.uncheckedEvent,this))}}if(s.event){p._dispatchEvent(new G(s.event,this,{id:s.id,value:this.attr("checked")!=null?true:false}))}};a.prototype.update=function(c){$.each(c,function(i,n){if(this.settings[n].type==="check"){this.setting$[n].attr("checked",c[n])}})};a.prototype.changeSetting=function(s){this._settings=s;$(this._dom).empty();this._settings$={};this._creatSettings()};return a});define('sap/viz/controls/mapbuilder/utils/UIHelper',['sap/viz/controls/common/managers/LangManager',"sap/viz/controls/common/utils/Utils","sap/viz/controls/mapbuilder/constants/Const","sap/viz/controls/mapbuilder/events/GeoEvent"],function(L,U,C,G){var P={id:"legendVisible",name:"VIZ_MAPBUILDER_SHOW_LEGEND",type:"check",value:true,checkedEvent:G.SHOW_LEGEND,uncheckedEvent:G.HIDE_LEGEND};var a={id:"markerCluster",name:"VIZ_MAPBUILDER_MARKER_CLUSTER",type:"check",value:false,event:G.CHANGE_VIZ_PROPERITIES};var b={id:"bubbleCluster",name:"VIZ_MAPBUILDER_BUBBLE_CLUSTER",type:"check",value:false,event:G.CHANGE_VIZ_PROPERITIES};var c=function(){this.__className="sap.viz.controls.geo.utils.UIHelper"};c.getAvailableSettings=function(v){if(v===C.VIZ_TYPE_CHOROPLETH){return[U.clone(P)]}else if(v===C.VIZ_TYPE_MARKER){return[U.clone(P),U.clone(a)]}else if(v===C.VIZ_TYPE_BUBBLE){return[U.clone(P),U.clone(b)]}else{throw L.get('VIZ_MAPBUILDER_NOT_SUPPORT_ERROR')}};return c});define('sap/viz/controls/mapbuilder/sections/GeoVizLayerSection',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/views/feed/FeedingShelfEvent","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/AnalysisObject","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/mapbuilder/constants/Const","sap/viz/controls/mapbuilder/events/GeoEvent","sap/viz/controls/mapbuilder/sections/SectionBase","sap/viz/controls/mapbuilder/widgets/WidgetTitle","sap/viz/controls/mapbuilder/widgets/WidgetDataPoint","sap/viz/controls/mapbuilder/widgets/WidgetFeeding","sap/viz/controls/mapbuilder/widgets/WidgetProperties","sap/viz/controls/mapbuilder/utils/UIHelper"],function($,O,C,F,L,a,A,b,c,G,S,W,d,f,g,U){var h=function(e,i){h.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.sections.GeoVizLayerSection";this._feedMap=this._config.feedMap;this._feeding=null;this._dataType=null;this._properties=null;this._vizType=this._config.vizType?this._config.vizType:c.VIZ_TYPE_CHOROPLETH;this._lableTitle=null;this._lableText=null;this._geoLocationFeedId="";this._geoFeatureColorFeedId="";this._geoFeatureSizeFeedId="";this._geoLocationFeedName="";this._geoFeatureColorFeedName="";this._geoFeatureSizeFeedName="";this._colorAnalysisType="";this._locationLength="";this._colorMeasureLength="";this._colorDimensionLength="";this._sizeLength="";this._showIconDom=false;this._clusterChecked=false;this._lableTitleText=L.get("VIZ_MAPBUILDER_CHOROPLETH");this._allAnalyses=null};O.extend(h,S);h.prototype.update=function(e){if(e.vizType){this._feeding.changeFeeding(e.vizType)}if(e.feeding){this._feeding.update({feeding:e.feeding})}if(e.title){this.title(e.title,true)}if(e.properties){this._properties.update(e.properties)}};h.prototype._createChildControl=function(e){var t=new W(e,{title:L.get("VIZ_MAPBUILDER_DATA_POINTS")+": "});this._lableTitle=$(document.createElement("div")).appendTo(e).addClass(C.MAPBUILDER_PREFIX+"chartType-icon-title");this._lableText=$('<div/>').appendTo(this._lableTitle).addClass(C.MAPBUILDER_PREFIX+"chartType-icon-title-text");this._lableText.text(this._lableTitleText);var i=$(document.createElement("div")).appendTo(e).addClass(C.MAPBUILDER_PREFIX+"datapointchooser");this._dataType=new d(i,{title:L.get("VIZ_MAPBUILDER_TYPE")+": ",selected:this._vizType});var j=$(document.createElement("div")).appendTo(e);this._feeding=new f(j,{feedMap:this._feedMap,vizType:this._vizType,feeding:this._config.feeding?this._config.feeding:[],feedingPanel:this._config.feedingPanel});this._feeding._analysisObjectsForPicker(this._allAnalyses);var p=$(document.createElement("div")).appendTo(e).addClass(C.MAPBUILDER_PREFIX+"properites");this._properties=new g(p,{properites:this._config.properties,settings:U.getAvailableSettings(this._vizType),showLegend:this._config.showLegend})};h.prototype._addEventHandler=function(){this._feeding.addEventListener(F.FEEDING_CHANGED,function(e){this._dispatchEvent(new F(F.FEEDING_CHANGED,this,{sectionIdx:this.getSectionIdx()}))},this);this._dataType.addEventListener(G.CHANGE_LAYER_VIZTYPE,function(e){this._changeVizType(e.data.vizType)},this);if(this._config.showLegend){this._properties.addEventListener(G.SHOW_LEGEND,function(e){this._dispatchEvent(new G(G.SHOW_LEGEND,this,{sectionIdx:this.getSectionIdx()}))},this);this._properties.addEventListener(G.HIDE_LEGEND,function(e){this._dispatchEvent(new G(G.HIDE_LEGEND,this,{sectionIdx:this.getSectionIdx()}))},this)}this._properties.addEventListener(G.CHANGE_VIZ_PROPERITIES,function(e){this._clusterChecked=e.data.value;this._dispatchEvent(new G(G.CHANGE_VIZ_PROPERITIES,this,{sectionIdx:this.getSectionIdx(),id:e.data.id,value:this._clusterChecked}))},this)};h.prototype._createChildControlPanel=function(e){this._createChildControl(e);this._addEventHandler()};h.prototype.getFeeds=function(){return this._feeding.getFeeds()};h.prototype.destory=function(){this.getSectionDom().detach()};h.prototype._changeVizType=function(v){var o=this._vizType;this._vizType=v;var e=[];var k=this.getFeeds();var l;for(var i=0;i<k.length;i++){l=k[i];var m=l.values().length;if(l.id()==="location"){this._locationLength=m}else if(l.id()==="color"){if(l.type()==="Measure"){this._colorMeasureLength=m}else{this._colorDimensionLength=m}}else if(l.id()==="size"){this._sizeLength=m}for(var j=0;j<m;j++){var n=l.values()[j].id();var p=l.values()[j].name();if(l.id()==="location"){this._geoLocationFeedName=p;this._geoLocationFeedId=n}else if(l.id()==="color"){this._geoFeatureColorFeedName=p;this._geoFeatureColorFeedId=n;this._colorAnalysisType=l.type()}else if(l.id()==="size"){this._geoFeatureSizeFeedName=p;this._geoFeatureSizeFeedId=n}}}if(this._vizType===c.VIZ_TYPE_CHOROPLETH){this.title("",false);this._iconDom.hide();this._showIconDom=false;this._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-marker");this._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-bubble");this._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-choropleth");this._lableTitleText=L.get("VIZ_MAPBUILDER_CHOROPLETH");if(this._geoLocationFeedId&&this._locationLength>0){e[0]=new a("location","Dimension",[new A(this._geoLocationFeedId,this._geoLocationFeedName,null,b.DIMENSION,null)])}if(this._geoFeatureColorFeedId&&this._colorAnalysisType==="Measure"&&this._colorMeasureLength>0){e[1]=new a("color","Measure",[new A(this._geoFeatureColorFeedId,this._geoFeatureColorFeedName,null,b.MEASURE,null)]);if(e[0]){this.title(this._geoFeatureColorFeedName,false);this._iconDom.show();this._showIconDom=true}}if(this._geoFeatureSizeFeedId&&this._sizeLength>0){e[1]=new a("color","Measure",[new A(this._geoFeatureSizeFeedId,this._geoFeatureSizeFeedName,null,b.MEASURE,null)]);if(e[0]){this.title(this._geoFeatureSizeFeedName,false);this._iconDom.show();this._showIconDom=true}}}else if(this._vizType===c.VIZ_TYPE_MARKER){this.title("",false);this._iconDom.hide();this._showIconDom=false;this._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-choropleth");this._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-bubble");this._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-marker");this._lableTitleText=L.get("VIZ_MAPBUILDER_MARKER");if(this._geoLocationFeedId&&this._locationLength>0){e[0]=new a("location","Dimension",[new A(this._geoLocationFeedId,this._geoLocationFeedName,null,b.DIMENSION,null)]);this.title(this._geoLocationFeedName,false);this._iconDom.show();this._showIconDom=true}}else if(this._vizType===c.VIZ_TYPE_BUBBLE){this.title("",false);this._iconDom.hide();this._showIconDom=false;this._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-choropleth");this._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-marker");this._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-bubble");this._lableTitleText=L.get("VIZ_MAPBUILDER_BUBBLE");if(this._geoLocationFeedId&&this._locationLength>0){e[0]=new a("location","Dimension",[new A(this._geoLocationFeedId,this._geoLocationFeedName,null,b.DIMENSION,null)]);this.title(this._geoLocationFeedName,false);this._iconDom.show();this._showIconDom=true}if(this._geoFeatureSizeFeedId&&this._sizeLength>0){if(this._colorDimensionLength===0&&this._geoFeatureSizeFeedName===this._geoFeatureColorFeedName&&this._geoFeatureSizeFeedId===this._geoFeatureColorFeedId){}else{e[1]=new a("size","Measure",[new A(this._geoFeatureSizeFeedId,this._geoFeatureSizeFeedName,null,b.MEASURE,null)]);if(e[0]){this.title(this._geoFeatureSizeFeedName,false);this._iconDom.show();this._showIconDom=true}}}if(this._geoFeatureColorFeedId&&this._colorMeasureLength>0&&this._colorAnalysisType==="Measure"){e[1]=new a("size","Measure",[new A(this._geoFeatureColorFeedId,this._geoFeatureColorFeedName,null,b.MEASURE,null)]);if(e[0]){this.title(this._geoFeatureColorFeedName,false);this._iconDom.show();this._showIconDom=true}}if(this._geoFeatureColorFeedId&&this._colorAnalysisType==="Dimension"&&this._colorDimensionLength>0){e[2]=new a("color","Dimension",[new A(this._geoFeatureColorFeedId,this._geoFeatureColorFeedName,null,b.DIMENSION,null)])}}this._lableText.text(this._lableTitleText);this._feeding.changeFeeding(this._vizType);this.update({feeding:e});this._properties.changeSetting(U.getAvailableSettings(this._vizType));this._dispatchEvent(new G(G.CHANGE_LAYER_VIZTYPE,this,{sectionIdx:this.getSectionIdx(),vizType:this._vizType,feeding:((e.length===1&&this._geoLocationFeedId&&this._locationLength>0)||o===this._vizType)?null:e}));this._dispatchEvent(new F(F.FEEDING_CHANGED,this,{sectionIdx:this.getSectionIdx()}))};h.prototype._analysisObjectsForPicker=function(e){if(arguments.length>0){this._allAnalyses=e}else{return this._allAnalyses}};h.prototype.save=function(){var s={vizType:this._vizType,feedMap:this._feedMap,feeding:this._feeding.save(),title:this.title(),checked:this._isChecked,checkable:this._checkable,configable:this._configable,expand:this._isExpand,sortable:this._sortable,titleText:this._lableTitleText,clusterChecked:this._vizType===c.VIZ_TYPE_CHOROPLETH?null:this._clusterChecked,showLegend:this._config.showLegend,showIconDom:this._showIconDom};return s};return h});define('sap/viz/controls/mapbuilder/models/Analysis',[],function(){var A=function(){this.__className="sap.viz.controls.geo.models.Analysis";this.id=null;this.name=null;this.type=null};return A});define('sap/viz/controls/mapbuilder/models/VizLayer',[],function(){var V=function(){this.__className="sap.viz.controls.geo.models.VizLayer";this._feedItems=[]};V.prototype.feedItems=function(_){if(!arguments.length){return this._feedItems}else{this._feedItems=_}};return V});define('sap/viz/controls/mapbuilder/widgets/WidgetESRIMapStyle',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/widgets/WidgetBase","sap/viz/controls/mapbuilder/widgets/WidgetTitle","sap/viz/controls/mapbuilder/events/GeoEvent"],function($,O,C,L,W,a,G){var E=[{name:"VIZ_MAPBUILDER_ESRI_MAP_STYLE_MAP",type:"topo"},{name:"VIZ_MAPBUILDER_ESRI_MAP_STYLE_SATELLITE",type:"satellite"},{name:"VIZ_MAPBUILDER_ESRI_MAP_STYLE_TERRAIN",type:"national-geographic"},{name:"VIZ_MAPBUILDER_ESRI_MAP_STYLE_STREETS",type:"streets"}];var b=function(d,c){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetESRIMapStyle";this._creatControls()};O.extend(b,W);b.prototype._creatControls=function(){var r=$(this._dom).addClass(C.MAPBUILDER_PREFIX+"map-styles");var t=new a(r,{title:"STYLES"});var c=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"map-styles-container").appendTo(r);for(var i=0;i<E.length;i++){var s=E[i];var d=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"map-style").appendTo(c);var e=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"map-style-title").appendTo(d);e.html(L.get(s.name)+": ");var f=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"map-style-esri-"+s.type).appendTo(d);f.addClass(C.MAPBUILDER_PREFIX+"map-style-esri-icon");f.data("__basemapType",s.type);var _=this;f.on("click tap",function(){$("."+C.MAPBUILDER_PREFIX+"map-style-esri-icon").removeClass(C.MAPBUILDER_PREFIX+"map-style-esri-icon-selected");$(this).addClass(C.MAPBUILDER_PREFIX+"map-style-esri-icon-selected");_._dispatchEvent(new G(G.CHANGE_BASEMAP_TYPE,this,{basemapType:$(this).data("__basemapType")}))})}};return b});define('sap/viz/controls/mapbuilder/sections/GeoBasemapLayerSection',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/events/GeoEvent","sap/viz/controls/mapbuilder/sections/SectionBase","sap/viz/controls/mapbuilder/widgets/WidgetTitle","sap/viz/controls/mapbuilder/widgets/WidgetESRIMapStyle"],function($,O,C,L,G,S,W,a){var b="<select id=\"combobox\"><select>";var c=function(d,e){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.sections.GeoBasemapLayerSection";this._config=e;this._providers=this._config.providers;this._changable=this._config.changable;this._$providerSelector=null;this._esriMapStyle=null;this._esriMapStyle$=null};O.extend(c,S);c.prototype._createChildControl=function(d){var t=new W(d,{title:L.get("VIZ_MAPBUILDER_MAP")});var p=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"map-provider").appendTo(d);$(document.createElement("div")).html(L.get("VIZ_MAPBUILDER_PROVIDERS")+":").addClass(C.MAPBUILDER_PREFIX+"section-sub-title-text").appendTo(p);this._$providerSelector=$(b).appendTo(p);var e=0;for(var i=0;i<this._providers.length;i++){var o;if(this._config.defaultProvider==this._providers[i]){o="<option selected=\"selected\" value=\""+this._providers[i]+"\">"+this._providers[i]+"</option>"}else{o="<option value=\""+this._providers[i]+"\">"+this._providers[i]+"</option>"}$(o).appendTo(this._$providerSelector)}this._esriMapStyle$=$(document.createElement("div")).appendTo(d);this._esriMapStyle=new a(this._esriMapStyle$);if(this._config.defaultProvider!=="ESRI"){this._esriMapStyle$.hide()}};c.prototype._addEventHandler=function(){this._$providerSelector.change(function(){this._dispatchEvent(new G(G.CHANGE_BASEMAP_PROVIDER,this,{basemapProvider:this._$providerSelector.val()}));if(this._$providerSelector.val()!=="ESRI"){this._esriMapStyle$.hide()}else{this._esriMapStyle$.show()}}.bind(this));this._esriMapStyle.addEventListener(G.CHANGE_BASEMAP_TYPE,function(e){this._dispatchEvent(e)},this)};c.prototype._createChildControlPanel=function(d){this._createChildControl(d);this._addEventHandler()};return c});define('sap/viz/controls/mapbuilder/widgets/WidgetContextMenu',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/widgets/WidgetBase","sap/viz/controls/mapbuilder/events/GeoEvent"],function($,O,C,L,W,G){var M={iconClass:C.MAPBUILDER_PREFIX+"contextmenu-delete",actionType:G.DELETE_LAYER,name:"VIZ_MAPBUILDER_DELETE"};var a={iconClass:C.MAPBUILDER_PREFIX+"contextmenu-moveup",actionType:G.REORDER_LAYER,name:"VIZ_MAPBUILDER_MOVEUP"};var b={iconClass:C.MAPBUILDER_PREFIX+"contextmenu-movedown",actionType:G.REORDER_LAYER,name:"VIZ_MAPBUILDER_MOVEDOWN"};var c=function(d,e){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetContextMenu";this._menu$=null;this._text$=null;this._buttonCancel$=null;this._buttonOk$=null;this._actionType="";this._container$=null;this._layerName=null;this._moveName=null;this._layerIndex=null;this._layerCount=null;this._instanceDom=null;this._beforeInstanceDom=null;this._afterInstanceDom=null;this._firstInstanceDom=null;this._showHideMenu=null;this._showHideMenuItem=null;this._actionContainer$=null;this._warning$=null;this._creatControls()};O.extend(c,W);c.prototype._creatControls=function(){var r=$(document.createElement("div")).appendTo($(this._dom)).addClass(C.MAPBUILDER_PREFIX+"contextmenu-container");this._container$=r;var m=document.createElement("ul");this._menu$=$(m).addClass(C.MAPBUILDER_PREFIX+"contextmenu");this._createMenuItem(this._menu$,a);this._createMenuItem(this._menu$,b);this._createMenuItem(this._menu$,M);this._menu$.appendTo(r);this._actionContainer$=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"contextmenu-action-container").appendTo(r);this._warning$=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"contextmenu-action-warning").appendTo(this._actionContainer$);var d=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"contextmenu-action-title").appendTo(this._actionContainer$);this._text$=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"contextmenu-action-name").appendTo(d);var e=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"contextmenu-action").appendTo(r);this._buttonCancel$=$("<button type=\"button\"></button>").addClass(C.MAPBUILDER_PREFIX+"contextmenu-action-cancel").appendTo(e);this._buttonOk$=$("<button type=\"button\"></button>").addClass(C.MAPBUILDER_PREFIX+"contextmenu-action-button").addClass(C.MAPBUILDER_PREFIX+"contextmenu-action-ok").appendTo(e);this._actionContainer$.hide();this._text$.hide();this._buttonCancel$.hide();this._buttonOk$.hide();this._warning$.hide();this._buttonOk$.click(function(){if(this._actionType==G.DELETE_LAYER){this._dispatchEvent(new G(G.DELETE_LAYER,this))}this._close()}.bind(this));this._buttonCancel$.click(function(){this._close()}.bind(this))};c.prototype._createMenuItem=function(m,d){var e=$(document.createElement("li")).addClass(C.MAPBUILDER_PREFIX+"menuitem");$(document.createElement("div")).appendTo(e).addClass(d.iconClass);var f=$(document.createElement("div")).appendTo(e).addClass(C.MAPBUILDER_PREFIX+"menutext");f.text(L.get(d.name));e.appendTo(m);e.data("actionType",d.actionType);e.click($.proxy(this._clickHanlder,this))};c.prototype._clickHanlder=function(e){var _=this;this._actionType=$(e.currentTarget).data('actionType');this._moveName=e.currentTarget.children[1].innerText;this._menu$.hide();this._actionContainer$.show();this._warning$.hide();this._text$.show();if(this._actionType===G.DELETE_LAYER){this._warning$.show();this._text$.html(L.get('VIZ_MAPBUILDER_DELETE_GEO_LAYER')+"?");this._buttonCancel$.show();this._buttonOk$.show();this._container$.removeClass(C.MAPBUILDER_PREFIX+"contextmenu-container");this._container$.addClass(C.MAPBUILDER_PREFIX+"configmenu-container");var r=$(this._dom);r.css({top:this._container$.offset().top,left:this._container$.offset().left-35,position:"absolute"})}else if(this._actionType===G.REORDER_LAYER){var f=this._layerIndex;var t;if(this._moveName===L.get('VIZ_MAPBUILDER_MOVEUP')){t=f+1;this._instanceDom.insertBefore(this._beforeInstanceDom)}else if(this._moveName===L.get('VIZ_MAPBUILDER_MOVEDOWN')){t=f-1;this._instanceDom.insertAfter(this._afterInstanceDom)}this._dispatchEvent(new G(G.REORDER_LAYER,this,{from:f,to:t}));this._close()}};c.prototype._mouseDownHandler=function(e){if(!$.contains(this._dom,e.srcElement)){this._close()}};c.prototype.show=function(o){var r=$(this._dom);r.css({top:o.top,left:o.left+85,position:"absolute"});r.appendTo($("body"));if(this._layerCount>0){if(this._layerCount===1){this._menu$[0].style.display="block";this._menu$[0].children[0].style.display="none";this._menu$[0].children[1].style.display="none";this._menu$[0].children[2].style.display="block"}else if(this._layerCount>1&&this._layerIndex===this._layerCount-1){this._menu$[0].style.display="block";this._menu$[0].children[0].style.display="none";this._menu$[0].children[1].style.display="block";this._menu$[0].children[2].style.display="block"}else if(this._layerCount>1&&this._layerIndex===0){this._menu$[0].style.display="block";this._menu$[0].children[0].style.display="block";this._menu$[0].children[1].style.display="none";this._menu$[0].children[2].style.display="block"}else{this._menu$[0].style.display="block";this._menu$[0].children[0].style.display="block";this._menu$[0].children[1].style.display="block";this._menu$[0].children[2].style.display="block"}}this._text$.hide();this._buttonCancel$.hide();this._buttonOk$.hide();this._warning$.hide();this._actionContainer$.hide();document.addEventListener("mousedown",$.proxy(this._mouseDownHandler,this),true);this._container$.removeClass(C.MAPBUILDER_PREFIX+"configmenu-container");this._container$.addClass(C.MAPBUILDER_PREFIX+"contextmenu-container")};c.prototype._close=function(){$(this._dom).detach();document.removeEventListener("mousedown",$.proxy(this._mouseDownHandler,this),true)};c.prototype.setLayerIdx=function(_){this._layerIndex=_};c.prototype.setLayerCount=function(_){this._layerCount=_};c.prototype.setInstanceDom=function(_){this._instanceDom=_};c.prototype.setBeforeInstanceDom=function(_){this._beforeInstanceDom=_};c.prototype.setAfterInstanceDom=function(_){this._afterInstanceDom=_};c.prototype.setFirstInstanceDom=function(_){this._firstInstanceDom=_};return c});define('sap/viz/controls/mapbuilder/MapBuilder',["jquery",'sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/constants/CSSConst',"sap/viz/controls/mapbuilder/constants/Const",'sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/mapbuilder/sections/SectionBase','sap/viz/controls/mapbuilder/sections/GeoVizLayerSection','sap/viz/controls/mapbuilder/models/Analysis','sap/viz/controls/mapbuilder/models/VizLayer','sap/viz/controls/common/views/feed/FeedingShelfEvent','sap/viz/controls/mapbuilder/sections/GeoBasemapLayerSection','sap/viz/controls/mapbuilder/events/GeoEvent','sap/viz/controls/mapbuilder/widgets/WidgetContextMenu'],function($,G,O,U,V,F,C,a,L,b,S,c,A,d,f,g,h,k){var r=function(e,i,t){e.splice(t,0,e.splice(i,1)[0])};var M=function(e,u){M.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.MapBuilder";this._uiConfig=u;this._feedMap=!this._uiConfig.feedMap?{}:this._uiConfig.feedMap;this._$controller=null;this._$header=null;this._$headerPlus=null;this._$headerText=null;this._vizSectionsContainer=null;this._vizSections=[];this._vizLayers=[];this._baseMapSection=null;this._contextMenu=null;this._createChildren();this._currentSettingLayer=-1;this._loadConfig()};O.extend(M,V);M.VERSION='1.0';M.prototype.config=function(e,l){this._vizSections[l].update(e)};M.prototype._createHeader=function(){this._$header=$("<div/>").appendTo(this._$controller).addClass(C.MAPBUILDER_PREFIX+"header");this._$headerPlus=$("<div><div/>").appendTo(this._$header).addClass(C.MAPBUILDER_PREFIX+"header-plus");this._$headerText=$("<div></div>").appendTo(this._$header).addClass(C.MAPBUILDER_PREFIX+"header-text").html(L.get("VIZ_MAPBUILDER_ADD_NEW_LAYER"));this._$headerPlus.bind('tap click',this._addHeaderEventHandler.bind(this));this._$headerText.bind('tap click',this._addHeaderEventHandler.bind(this))};M.prototype._addHeaderEventHandler=function(e){if(this._vizLayers.length>=5){this._$header.disabled=true;this._$headerPlus.removeClass(C.MAPBUILDER_PREFIX+"header-plus");this._$headerPlus.addClass(C.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerText.css("color","#a6a6a6")}else if(this._vizLayers.length<5){this._$header.disabled=false;this._$headerText.css("color","#008fd3");this._$headerPlus.removeClass(C.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerPlus.addClass(C.MAPBUILDER_PREFIX+"header-plus");this._vizModel().extensionValues({mapBuilder:{layer:{action:'add'}}});if(this._vizLayers.length===4){this._addVizSection();this._$header.disabled=true;this._$headerPlus.removeClass(C.MAPBUILDER_PREFIX+"header-plus");this._$headerPlus.addClass(C.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerText.css("color","#a6a6a6")}else{this._addVizSection()}e.stopPropagation();e.preventDefault()}};M.prototype.reset=function(){for(var i=0;i<this._vizSections.length;i++){this._vizSections[i].destory()}this._vizSections.length=0;this._vizLayers.length=0};M.prototype._createChildren=function(){var i=$("<div/>").appendTo(this._dom).addClass(C.PREFIX+"mapbuilder");this._$controller=$("<div/>").appendTo(i).addClass(C.MAPBUILDER_PREFIX+"area");this._createHeader();var s=document.createElement('div');$(s).addClass(C.MAPBUILDER_PREFIX+"section-container");var j=document.createElement('div');this._vizSectionsContainer=document.createElement('div');if(this._uiConfig.showBaseMap){this._baseMapSection=new g(j,{title:L.get('VIZ_MAPBUILDER_BASE_MAP_NAME'),providers:this._uiConfig.basemap.providers,changeable:this._uiConfig.basemap.changable,checkable:false,sortable:false,configable:false,defaultProvider:this._uiConfig.basemap.selected});this._baseMapSection.addEventListener(h.CHANGE_BASEMAP_PROVIDER,function(e){this._dispatchEvent(e)},this);this._baseMapSection.addEventListener(h.CHANGE_BASEMAP_TYPE,function(e){this._dispatchEvent(e)},this)}s.appendChild(this._vizSectionsContainer);s.appendChild(j);$(s).appendTo(this._$controller);this._contextMenu=new k(document.createElement("div"),{});this._contextMenu.addEventListener(h.DELETE_LAYER,function(e){this._removeLayer(this._currentSettingLayer)},this);this._contextMenu.addEventListener(h.REORDER_LAYER,function(e){this._reorderLayer(e.data.from,e.data.to)},this)};M.prototype._loadConfig=function(){var l=this._uiConfig.layers;if(l){for(var i=0;i<l.length;i++){var e=l[i];var s=this._createVizLayerSection({vizType:e.vizType,feeding:e.feeding,title:e.title,showLegend:this._uiConfig.showLegend})}}};M.prototype.save=function(){var e=[];for(var i=0;i<this._vizSections.length;i++){var v=this._vizSections[i];if(v){var s=v.save();e.push(s)}}return e};M.prototype.load=function(e){if(!e){return}this.reset();for(var i=0;i<e.length;i++){var s=e[i];var l=[];for(var j=0;j<s.feeding.feeding.length;j++){l[j]=F.fromJSON(s.feeding.feeding[j])}var m=this._createVizLayerSection({feedMap:s.feedMap,vizType:s.vizType,feeding:l,title:s.title,checkable:s.checkable,configable:s.configable,sortable:s.sortable,showLegend:s.showLegend});if(s.showIconDom){m._showIconDom=true;m._iconDom.show();if(s.vizType===a.VIZ_TYPE_CHOROPLETH){m._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-marker");m._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-bubble");m._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-choropleth")}else if(s.vizType===a.VIZ_TYPE_BUBBLE){m._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-marker");m._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-choropleth");m._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-bubble")}else if(s.vizType===a.VIZ_TYPE_MARKER){m._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-bubble");m._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-choropleth");m._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-marker")}}m._lableText.text(s.titleText);m._lableTitleText=s.titleText;if(!s.checked){m._checkBoxDom.checked=s.checked;m._isChecked=s.checked;$(m._labelDom).css("color","#a6a6a6")}if(!s.expand){m._isExpand=s.expand}if(s.clusterChecked){m._clusterChecked=true;if(s.vizType===a.VIZ_TYPE_MARKER){m._properties._settings$.markerCluster[0].checked=true}else{m._properties._settings$.bubbleCluster[0].checked=true}}}if(e.length>=5){this._$header.disabled=true;this._$headerPlus.removeClass(C.MAPBUILDER_PREFIX+"header-plus");this._$headerPlus.addClass(C.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerText.css("color","#a6a6a6")}for(var j=0;j<e.length;j++){if(e[j].expand&&e[j].checked){this._vizSections[j]._expandSectionHandler()}else{this._vizSections[j]._hideSectionHandler()}}};M.prototype._getLayerCount=function(){return this._vizLayers.length};M.prototype._createVizLayerSection=function(j){var v=new c(this._vizSectionsContainer,{feedMap:this._feedMap,title:j.title,checkable:j.checkable?j.checkable:true,configable:j.configable?j.configable:true,sortable:j.sortable?j.sortable:true,vizType:j.vizType,feeding:j.feeding,showLegend:j.showLegend,feedingPanel:this._uiConfig.feedingPanel});v._analysisObjectsForPicker(this._allAnalyses);v._expandSectionHandler();if(v._sortable){$(v._instanceDom).sortable("disable")}v.addEventListener(f.FEEDING_CHANGED,function(e){this._layerFeedChange(this._getLayerIdxBySectionIdx(e.data.sectionIdx))},this);v.addEventListener(h.EXPAND_SECTION,function(e){var m=this._getLayerIdxBySectionIdx(e.data.sectionIdx);this._dispatchEvent(new h(h.EXPAND_SECTION,this,{layerIdx:m}));if(this._vizSections.length>=1){for(var i=0;i<this._vizSections.length;i++){if(i===m&&!(v._isExpand)&&v._isChecked){this._vizSections[i]._expandSectionHandler()}else{if(v._isChecked){this._vizSections[i]._hideSectionHandler()}}if(this._vizSections[i]._sortable){$(this._vizSections[i]._instanceDom).sortable("disable")}}}},this);v.addEventListener(h.HIDE_SECTION,function(e){var m=this._getLayerIdxBySectionIdx(e.data.sectionIdx);this._dispatchEvent(new h(h.HIDE_SECTION,this,{layerIdx:m}));if(this._vizSections.length>=1){for(var i=0;i<this._vizSections.length;i++){if(i===m&&v._isExpand){this._vizSections[i]._hideSectionHandler()}if(this._vizSections[i]._sortable){$(this._vizSections[i]._instanceDom).sortable("enable")}}}},this);v.addEventListener(h.SHOW_LAYER,function(e){var m=this._getLayerIdxBySectionIdx(e.data.sectionIdx);this._vizModel().extensionValues({mapBuilder:{layer:{action:'show',idx:m}}});this._dispatchEvent(new h(h.SHOW_LAYER,this,{layerIdx:m}));if(v._isChecked){$(v._labelDom).css("color","#333333");for(var i=0;i<this._vizSections.length;i++){if(i===m&&v._isChecked){this._vizSections[i]._expandSectionHandler()}else{this._vizSections[i]._hideSectionHandler()}if(this._vizSections[i]._sortable){$(this._vizSections[i]._instanceDom).sortable("disable")}}}},this);v.addEventListener(h.HIDE_LAYER,function(e){var m=this._getLayerIdxBySectionIdx(e.data.sectionIdx);this._vizModel().extensionValues({mapBuilder:{layer:{action:'hide',idx:m}}});this._dispatchEvent(new h(h.HIDE_LAYER,this,{layerIdx:m}));if(!v._isChecked){$(v._labelDom).css("color","#a6a6a6");v._hideSectionHandler();$(v._instanceDom).sortable("enable")}},this);v.addEventListener(h.DISPLAY_SETTINGMENU,function(e){this._displaySettingMenu(this._getLayerIdxBySectionIdx(e.data.sectionIdx),e.data.position)},this);v.addEventListener(h.REORDER_LAYER,function(e){this._reorderLayer(this._getLayerIdxBySectionIdx(e.data.from),this._getLayerIdxBySectionIdx(e.data.to))},this);v.addEventListener(h.CHANGE_LAYER_VIZTYPE,function(e){var m=this._getLayerIdxBySectionIdx(e.data.sectionIdx);var n=e.data.vizType;var o=e.data.feeding;this._vizModel().extensionValues({mapBuilder:{layer:{action:'changeVizType',idx:m,vizType:n,feeding:o}}});this._dispatchEvent(new h(h.CHANGE_LAYER_VIZTYPE,this,{layerIdx:m,vizType:n,feeding:o}))},this);v.addEventListener(h.CHANGE_VIZ_PROPERITIES,function(e){var m=this._getLayerIdxBySectionIdx(e.data.sectionIdx);var p=e.data.id;var n=e.data.value;this._vizModel().extensionValues({mapBuilder:{layer:{action:'changeProperties',idx:m,propKey:p,propValue:n}}});this._dispatchEvent(new h(h.CHANGE_VIZ_PROPERITIES,this,{layerIdx:m,id:p,value:n}))},this);this._vizSections.push(v);if(this._vizSections.length>1){for(var i=0;i<this._vizSections.length;i++){if(i===this._vizSections.length-1){this._vizSections[i]._expandSectionHandler()}else{this._vizSections[i]._hideSectionHandler()}}}if(j.title){v.title(j.title,true)}else{var l=this._vizSections.length}this._vizLayers.push(new d());return v};M.prototype._addVizSection=function(){this._createVizLayerSection({showLegend:this._uiConfig.showLegend});this._dispatchEvent(new h(h.ADD_LAYER,this,{layerIdx:this._vizSections.length-1}))};M.prototype._getLayerIdxBySectionIdx=function(s){return this._vizSections.length-s-1};M.prototype._createAnalysis=function(i,n,t){var e=new A();e.id=i;e.name=n;e.type=t;this._feedMap[i]=e;return e};M.prototype._layerFeedChange=function(l){var e=this._vizLayers[l];var s=this._vizSections[l];var v=s._vizType;var m=s.getFeeds();e.feedItems(m);var n,o,p,q,t;for(var i=0;i<m.length;i++){var u=m[i];for(var j=0;j<u.values().length;j++){n=u.values()[j].name();if(u.id()==="location"){o=n}else if(u.id()==="color"){p=n;t=u.type()}else if(u.id()==="size"){q=n}}}if(v===a.VIZ_TYPE_CHOROPLETH){s.title("",false);s._iconDom.hide();s._showIconDom=false;if(p!=undefined&&o!=undefined&&t==="Measure"){s.title(p,false);s._iconDom.show();s._showIconDom=true}}else if(v===a.VIZ_TYPE_BUBBLE){s.title("",false);s._iconDom.hide();s._showIconDom=false;if(o!=undefined){if(q!=undefined){s.title(q,false)}else{s.title(o,false)}s._iconDom.show();s._showIconDom=true}}else if(v===a.VIZ_TYPE_MARKER){s.title("",false);s._iconDom.hide();s._showIconDom=false;if(o!=undefined){s.title(o,false);s._iconDom.show();s._showIconDom=true}}var w=this._vizModel().feedingItems();w[l]=m;this._vizModel().feedingItems(w);this._dispatchEvent(new h(h.UPDATE_LAYER_DATA,this,{"feedItems":m,"layerIdx":l}))};M.prototype._removeLayer=function(i){this._vizSections[i].destory();this._vizSections.splice(i,1);this._vizLayers.splice(i,1);this._vizModel().extensionValues({mapBuilder:{layer:{action:'delete',idx:i}}});this._dispatchEvent(new h(h.DELETE_LAYER,this,{layerIdx:i}));if(this._vizLayers.length<5){this._$header.disabled=false;this._$headerPlus.removeClass(C.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerPlus.addClass(C.MAPBUILDER_PREFIX+"header-plus");this._$headerText.css("color","#008fd3")}else if(this._vizLayers.length>=5){this._$header.disabled=true;this._$headerText.css("color","#a6a6a6");this._$headerPlus.removeClass(C.MAPBUILDER_PREFIX+"header-plus");this._$headerPlus.addClass(C.MAPBUILDER_PREFIX+"disable-header-plus")}};M.prototype._reorderLayer=function(e,t){r(this._vizSections,e,t);r(this._vizLayers,e,t);this._vizModel().extensionValues({mapBuilder:{layer:{action:'reorder',from:e,to:t}}});this._dispatchEvent(new h(h.REORDER_LAYER,this,{from:e,to:t}))};M.prototype._displaySettingMenu=function(l,p){this._currentSettingLayer=l;var s=this._vizSections[this._currentSettingLayer].getSectionDom();var e,i;if(this._vizSections.length>0){if(this._vizSections.length===1){e=null;i=null}else if(this._vizSections.length>1&&this._currentSettingLayer===this._vizSections.length-1){e=null;i=this._vizSections[this._currentSettingLayer-1].getSectionDom()}else if(this._vizSections.length>1&&this._currentSettingLayer===0){e=this._vizSections[this._currentSettingLayer+1].getSectionDom();;i=null}else{e=this._vizSections[this._currentSettingLayer+1].getSectionDom();i=this._vizSections[this._currentSettingLayer-1].getSectionDom()}}var o=s.offset();this._contextMenu.setLayerIdx(this._currentSettingLayer);this._contextMenu.setLayerCount(this._vizSections.length);this._contextMenu.setInstanceDom(s);this._contextMenu.setBeforeInstanceDom(e);this._contextMenu.setAfterInstanceDom(i);this._contextMenu.show(o)};M.prototype._onVizModelChanged=function(e){if(this._vizLayers.length===0){var v=this._vizModel().type();if(e.data.vizTypeChanged&&b.isGeo(v)){this._addVizSection()}}};M.prototype.analysisObjectsForPicker=function(e){if(arguments.length>0){this._allAnalyses=e}else{return this._allAnalyses}};return M});define('sap/viz/controls/switchbar/SwitchBarEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event','jquery'],function(O,E,$){var S=function(t,a,d){S.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.SwitchBarEvent"};O.extend(S,E);S.VIZ_TYPE_CHANGED="vizTypeChanged";return S});define('sap/viz/controls/switchbar/views/SwitcherEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var S=function(t,a,d){S.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.views.SwitcherEvent"};O.extend(S,E);S.TYPE_CHANGED="typeChanged";return S});define('sap/viz/controls/switchbar/views/DropDownListEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var D=function(t,a,d){D.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.views.DropDownListEvent"};O.extend(D,E);D.DROP_DOWN_OPENED="dropDownOpened";D.DROP_DOWN_CLOSED="dropDownClosed";D.ITEM_SELECTED="itemSelected";return D});define('sap/viz/controls/switchbar/views/DropDownList',['jquery','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/UIControl','sap/viz/controls/switchbar/views/DropDownListEvent'],function($,C,a,u,O,b,U,D){var c=a.SWITCHBAR_PREFIX;var d=function(e,h,t){d.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.views.DropDownList";this._header=h;this._typeObjects=t;this._selectedChartList=null;this._dom$=$(e);this._$container=null;this._$content=null;this._$arrow=null;this._mousedownHandler=$.proxy(this._globalMouseDownHandler,this);this._createChildren()};O.extend(d,U);d.prototype.open=function(e){this._dispatchEvent(new D(D.DROP_DOWN_OPENED,this));this._dom$.appendTo($("body"));this._locate(e);document.addEventListener("mousedown",this._mousedownHandler,true);this._$container.css('opacity','1');this._$container.css('top','15px')};d.prototype._globalMouseDownHandler=function(e){var t=e.srcElement?e.srcElement:e.target;if(!$.contains(this._dom,t)){this.close()}};d.prototype._updateDropdownPosition=function(e){var m=this._$li.outerHeight()*11+this._$content.outerHeight()%this._$li.outerHeight();var n=this._$content.outerHeight()>m;if(n){this._$content.outerWidth(this._$li.outerWidth()+28);this._$content.outerHeight(m)}else{this._$content.outerWidth(this._$li.outerWidth()+14)}var f=this._$content.outerWidth();var g=this._$content.outerHeight();this._$container.css({'width':f+'px','height':g+'px'});var i=-5;var h=this._$container.outerWidth();var j=(h/3)*2+1;if(j/2>e){j+=j/2-e}var k=i+j;this._$arrow.css({"left":k});this._$container.css({"left":-j})};d.prototype._locate=function(e){var s=document.body.scrollWidth-document.body.clientWidth;var f=$(window).outerWidth()-e.offset().left;this._updateDropdownPosition(f+s);this._dom$.css({"right":f,"top":e.offset().top+e.outerHeight()})};d.prototype.close=function(){var e=$(this._dom);var f=1;if(this._classVisible){e.removeClass(this._classVisible);f=2000}setTimeout(function(){e.detach()},f);this._dispatchEvent(new D(D.DROP_DOWN_CLOSED,this));document.removeEventListener("mousedown",this._mousedownHandler,true);this.destroy()};d.prototype._createChildren=function(){var _=this;this._dom$.addClass(c+'dropDownList');var e=this._$container=$('<div/>').appendTo(this._dom$);this._$container.addClass(c+'dropDownList-container');var f=this._$arrow=$('<div/>').appendTo(e);this._$arrow.addClass(c+'dropDownList-arrow uvb-dropDownList');var g=this._$content=$('<div/>').appendTo(e);this._$content.addClass([c+'dropDownList-content',a.COMMON_PREFIX+'scrollable',a.COMMON_PREFIX+'scrollable-y'].join(' '));var h=this._$ul=$('<ul/>').appendTo(g);this._$ul.addClass(c+'chart-list-container');var j=$('<div/>').appendTo(h).text(this._header);j.addClass(c+'chart-list-header');var i;var o;for(i=0;i<this._typeObjects.length;i++){o=this._typeObjects[i];this._$li=$('<li/>').appendTo(h).attr('class','chartList');var k=this._$li;k.data('type',o);k.click($.proxy(this._chartListClickHandler,this));var l=$('<div/>');l.addClass(c+'dropDownList-chart-list');var v=o.id;if((b.isBuildInType(v))||v===C.TYPE_TABLE||v===C.TYPE_FUNNEL||v===C.TYPE_PC){l.append($("<div/>",{"class":c+"chart-icon"+" "+c+"chart-icon-"+o.icon}),$("<span/>",{"class":c+"chart-text","text":o.caption}))}else{if(!o.srcIcon){l.append($("<div/>",{"class":c+"chart-icon"+" "+c+"chart-icon-extension"}),$("<span/>",{"class":c+"chart-text","text":o.caption}))}else{l.append($("<img/>",{"class":c+"chart-icon","src":o.srcIcon}),$("<span/>",{"class":c+"chart-text","text":o.caption}));l.children('img').css('background','none')}}$(l[0].firstChild).css('margin','3px 5px 3px 0px');l.appendTo(k)}};d.prototype._chartListClickHandler=function(e){this._dispatchEvent(new D(D.ITEM_SELECTED,this,{'selectedTypeObject':$(e.currentTarget).data('type')}));this.close()};d.prototype.updateSelectedUI=function(s){var e=this._$ul.children('li');for(var i=0;i<e.length;i++){var f=$(e[i]);if(f.text()===s){f.addClass(c+'dropDownList-chart-list-selected');break}}};return d});define('sap/viz/controls/switchbar/views/Switcher',['jquery','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/UIControl','sap/viz/controls/switchbar/views/SwitcherEvent','sap/viz/controls/switchbar/views/DropDownList','sap/viz/controls/switchbar/views/DropDownListEvent'],function($,C,a,u,O,b,U,S,D,c){var d=a.SWITCHBAR_PREFIX;var e=a.COMMON_PREFIX;var f=function(g,h,t){f.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.switchbar.views.Switcher';this._caption=h;this._typeObjects=t;this._selectedTypeObject=null;this._dom$=$(g);this._chartIcon$=null;this._arrow$=null;this._createChildren();this._commitSelectedType();this.size({'width':58,'height':34})};O.extend(f,U);f.prototype.selectedType=function(v){if(arguments.length>0){var t=null;if(v){for(var i=0;i<this._typeObjects.length;i++){if(this._typeObjects[i].id===v){t=this._typeObjects[i];break}}}this.selectedTypeObject(t)}else{return this._selectedTypeObject?this._selectedTypeObject.id:null}};f.prototype.selectedTypeObject=function(v){if(arguments.length>0){if(this._selectedTypeObject!=v||(this._selectedTypeObject&&v&&this._selectedTypeObject.id!=v.id)){this._selectedTypeObject=v;this._commitSelectedType();this._dispatchEvent(new S(S.TYPE_CHANGED,this))}}else{return this._selectedTypeObject}};f.prototype._createChildren=function(){this._dom$.addClass([d+'chart',d+'switcher'].join(' '));var s=this._typeObjects[0].srcIcon;if(!s){this._chartIcon$=$(document.createElement('div'))}else{this._chartIcon$=$(document.createElement('img'))}this._chartIcon$.addClass(d+'chart-icon');this._chartIcon$.click($.proxy(this._chartIconClickHandler,this));this._updateChartIcon(this._typeObjects[0],false);this._chartIcon$.appendTo(this._dom$);var g=this._arrow$=$(document.createElement('div'));g.addClass(d+'splitter');g.appendTo(this._dom$);var h=this._arrow$=$(document.createElement('div'));h.addClass(d+'dropdown-arrow');$(document.createElement('div')).addClass([d+'dropdown-arrow-icon',e+'havanaSharedSprite16-mask'].join(' ')).appendTo(h);h.click($.proxy(this._arrowClickHandler,this));h.appendTo(this._dom$)};f.prototype._chartIconClickHandler=function(g){this.selectedTypeObject(this._chartIcon$.data('type'))};f.prototype._arrowClickHandler=function(g){var h=this._dropDownList=new D(document.createElement('div'),this._caption,this._typeObjects);h.addEventListener(c.ITEM_SELECTED,function(g){this.selectedTypeObject(g.data.selectedTypeObject)},this);if(this._selectedTypeObject){h.updateSelectedUI(this._selectedTypeObject.caption)}h.open(this._arrow$)};f.prototype._commitSelectedType=function(){if(this._selectedTypeObject){this._updateChartIcon(this._selectedTypeObject,true);this._dom$.removeClass(d+'chart');this._dom$.addClass(d+'chart-selected')}else{this._updateChartIcon(this._selectedTypeObject,false);this._dom$.addClass(d+'chart');this._dom$.removeClass(d+'chart-selected')}};f.prototype._updateChartIcon=function(t,s){if(!t){t=this._chartIcon$.data('type')}var v=t.id;if((b.isBuildInType(v))||v===C.TYPE_TABLE||v===C.TYPE_FUNNEL||v===C.TYPE_PC){this._chartIcon$.attr({'class':d+'chart-icon'+' '+d+'chart-icon-'+(s?t.whiteIcon:t.icon),'title':t.caption}).data('type',t)}else{if(!t.srcIcon){if(this._chartIcon$[0].nodeName==='IMG'){this._chartIcon$=$(document.createElement("div")).replaceAll(this._chartIcon$)}this._chartIcon$.attr({'class':d+'chart-icon'+' '+d+'chart-icon-'+(s?'extension-white':'extension'),'title':t.caption}).data('type',t)}else{if(this._chartIcon$[0].nodeName==='DIV'){this._chartIcon$=$(document.createElement("img")).replaceAll(this._chartIcon$)}this._chartIcon$.attr({'class':d+'chart-icon','src':s?t.srcWhiteIcon:t.srcIcon,'title':t.caption}).data('type',t);this._chartIcon$.css('background','none')}}};return f});define('sap/viz/controls/switchbar/SwitchBar',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/switchbar/SwitchBarConfig','sap/viz/controls/switchbar/SwitchBarEvent','sap/viz/controls/switchbar/views/Switcher','sap/viz/controls/switchbar/views/SwitcherEvent'],function($,V,G,C,a,L,O,u,b,R,S,c,d,f){var g=C.SWITCHBAR_PREFIX;var h=function(e,i){h.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.SwitchBar";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_switchbar_control');this._vizGroups=null;this._selectedTypeObject=null;this._uiSwitchers=null;this._dom$=$(this._dom);this._dom$.addClass(C.SWITCHBAR_PREFIX+"view");this._container$=null;if(!i){i=G.defaultUIConfig(G.DEFAULT_UICONFIG_TYPE_SWITCHBAR)}this._parseConfiguration(i);this._horizontalGap=24;this._verticalGap=14;this._createChildren();this._validateSize();if(this._vizModel().type()===i.defaultVizType){this._applyModel()}else{this._vizModel().type(i.defaultVizType)}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_switchbar_control')};O.extend(h,V);h.VERSION='2.0';h.prototype.vizType=function(v){if(arguments.length>0){if(!u.isString(v)){return}var e=this._vizModel();var n=b.getType(e.type(),v);e.type(n);return this}else{return this._selectedTypeObject?this._selectedTypeObject.id:null}};h.prototype.horizontalGap=function(v){if(arguments.length>0){if(isNaN(v)){throw L.get('VIZ_CONTROLS_API_PARAMETER_ERROR')}v=Number(v);if(this._horizontalGap!==v){this._horizontalGap=v;this._validateSize()}return this}else{return this._horizontalGap}};h.prototype.verticalGap=function(v){if(arguments.length>0){if(isNaN(v)){throw L.get('VIZ_CONTROLS_API_PARAMETER_ERROR')}v=Number(v);if(this._verticalGap!==v){this._verticalGap=v;this._validateSize()}return this}else{return this._verticalGap}};h.prototype.selectedTypeObject=function(v){if(arguments.length>0){if(this._selectedTypeObject!=v||(this._selectedTypeObject&&v&&this._selectedTypeObject.id!=v.id)){this._selectedTypeObject=v;this._commitSelectedTypeObject()}return this}else{return this._selectedTypeObject}};h.prototype.save=function(){var j={};j['type']=this.vizType();return j};h.prototype.load=function(v){this.vizType(v.type)};h.prototype._onConnect=function(v){var e=this._vizModel();var n=b.getVizType(e.type());this._changeVizType(n)};h.prototype._onVizModelChanged=function(e){if(e.data.vizTypeChanged){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:change_switchbar_viz_type');this._applyModel();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:change_switchbar_viz_type')}};h.prototype._applyModel=function(e){this._changeVizType(b.getVizType(this._vizModel().type()))};h.prototype._changeVizType=function(v){var e=false;for(var i=0;i<this._vizGroups.length;i++){var k=this._vizGroups[i];for(var j=0;j<k.typeObjects.length;j++){var t=k.typeObjects[j];if(t.id===v){this.selectedTypeObject(t);e=true;break}}if(e){break}}if(!e){this.selectedTypeObject(null)}};h.prototype._commitSelectedTypeObject=function(){var s=this._selectedTypeObject?this._selectedTypeObject.id:null;for(var i=0;i<this._uiSwitchers.length;i++){this._uiSwitchers[i].selectedType(s)}this._dispatchEvent(new c(c.VIZ_TYPE_CHANGED,this,{'vizType':s}))};h.prototype._parseConfiguration=function(e){var l=function(l){};try{this._vizGroups=[];var k={};var m=e.groups;if(m&&m.length){for(var i=0;i<m.length;i++){var n=m[i];var o=n.types;if(!o||o.length===0){continue}var v={'caption':n.name,'typeObjects':[]};for(var j=0;j<o.length;j++){var p=o[j];var q=p.id;if(k[q]){continue}var r=sap.viz.api.manifest.Viz.get(q);if(!r||!r[0]){continue}k[q]=true;var t=b.getVizTypeObject(q);if(!t){t={'id':q};var s=sap.viz.api.manifest.Viz.get(t.id);t.caption=(s&&s[0])?s[0].name:'';t.srcIcon=p.icon;t.srcWhiteIcon=p.whiteIcon}v.typeObjects.push(t)}if(v.typeObjects.length>0){this._vizGroups.push(v)}}}}catch(w){l("Invalid config format")}};h.prototype._createChildren=function(){this._uiSwitchers=[];var e=this._container$=$(document.createElement('div')).addClass(g+'switcher-container');for(var i=0;i<this._vizGroups.length;i++){var j=this._vizGroups[i];var s=$(document.createElement('div'));var k=new d(s[0],j.caption,j.typeObjects);k.addEventListener(f.TYPE_CHANGED,this._switcherTypeChanged,this);s.appendTo(e);this._uiSwitchers.push(k)}e.appendTo(this._dom$)};h.prototype._switcherTypeChanged=function(e){var i=e.target();if(i.selectedTypeObject()){var j=this._vizModel();var n=b.getType(j.type(),i.selectedTypeObject().id);j.type(n)}};h.prototype._validateSize=function(){var e=this._dom$.width();var o=0;var j=0;for(var i=0;i<this._uiSwitchers.length;i++){var k=this._uiSwitchers[i];var s=k.size();var l=$(k._dom);l.css({'left':o,'top':j});o=o+s.width+this._horizontalGap;if(i+1<this._uiSwitchers.length){var n=this._uiSwitchers[i+1];if(o+n.size().width>e){o=0;j=j+s.height+this._verticalGap}}}};return h});define('sap/viz/controls/common/utils/VizUtils',['sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/AnalysisObject'],function(D,C,U,F,A){var V={};V.hasFakeData=function(d){var h=true;if(d){h=false;if(U.isFunction(d.hasFakeData)){h=d.hasFakeData()}else{h=d.isFake===true?true:false}}return h};V.getDatasetType=function(d){if(d){if(d instanceof sap.viz.api.data.CrosstableDataset){return D.CrosstableDataset}else if(d instanceof sap.viz.api.data.FlatTableDataset){return D.FlatTableDataset}else{return D.RawDataset}}return D.CrosstableDataset};V.isEmptyData=function(t,d){var a=C.getDatasetType(t);if(a===D.RawDataset){return false}else if(a===D.FlatTableDataset){return false}else{var b=d?(d.data()?d.data().analysisAxis:null):null;var m=d?(d.data()?d.data().measureValuesGroup:null):null;if((!b||b&&b.length===0)&&(!b||m&&m.length===0)){return true}}return false};V.isArrayOfFeedItem=function(o){return V._isArrayOf(o,F)};V.isArrayOfAnalysisObject=function(o){return V._isArrayOf(o,A)};V._isArrayOf=function(o,c){if(U.isArray(o)){for(var i=0;i<o.length;i++){if(!(o[i]instanceof c)){return false}}return true}return false};return V});define('sap/viz/controls/feeding/FeedingPanelEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.FeedingPanelEvent"};O.extend(F,E);F.ACTION_CHANGED="actionChanged";return F});define('sap/viz/controls/feeding/FeedingPanel',['jquery','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/views/feed/FeedList','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/views/feed/FeedingShelf','sap/viz/controls/common/views/feed/FeedingShelfEvent','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/feeding/FeedingPanelConfig','sap/viz/controls/feeding/FeedingPanelEvent','sap/viz/controls/common/services/BVRService'],function($,G,F,u,O,V,C,L,b,A,c,d,f,g,h,j,R,k,l,m,n,o,B){var p=C.COMMON_PREFIX;var q=function(a,e){q.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.feeding.FeedingPanel";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_feedingpanel_control');this._dom$=$(a);this._dom$.addClass([C.FEEDINGPANEL_PREFIX+"view",p+'scrollable',p+'scrollable-y'].join(' '));this._uiShelf=null;this._dicUIShelf={};this._trellisArrowIcon$=null;this._trellisCollapsed=true;this._trellisContainer$=null;this._allAnalyses=null;this._uiConfig=e?e:G.defaultUIConfig(G.DEFAULT_UICONFIG_TYPE_FEEDING);this._enableTrellis=(this._uiConfig.enableTrellis!==false);this._feedsUpdatedRequested=false;if(this._vizModel().type()===this._uiConfig.defaultVizType){this._applyModel()}else{this._vizModel().type(this._uiConfig.defaultVizType)}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_feedingpanel_control')};O.extend(q,b);q.VERSION='2.0';q.prototype.feeds=function(v){if(arguments.length>0){if(v!=null&&!V.isArrayOfFeedItem(v)){return}var t=this._vizModel().type();if(l.isGeo(t)){var a=[];for(var i=0;i<v.length;i++){a[i]=m.cloneFeeds(v[i])}this._vizModel().feedingItems(a,this._enableTrellis)}else{var a=m.cloneFeeds(v);this._vizModel().feedingItems(a,this._enableTrellis)}return this}else{return this._vizModel().feedingItems()}};q.prototype.analysisObjectsForPicker=function(a){if(arguments.length>0){if(a!=null&&!V.isArrayOfAnalysisObject(a)){return}this._allAnalyses=a}else{return this._allAnalyses}};q.prototype.feedAnalysisObjects=function(a,e){if(a!=null&&!V.isArrayOfAnalysisObject(a)){return}var i=this._vizModel();var r;if(e===true){r=B.suggestFeeds(i.type(),i.explicitFeedingItems(),a)}else{r=B.suggestFeeds(i.type(),a)}if(r){i.feedingItems(r.feeds)}return r.feeds};q.prototype.save=function(){var a={};var t=this._vizModel().type();a['type']=t;if(l.isGeo(t)){var e=[];var r=this.feeds();for(var i=0;i<r.length;i++){e[i]=c.toJSON(r[i])}a["feedingItems"]=e}else{a["feedingItems"]=c.toJSON(this.feeds())}a['mndVisible']=this._vizModel().isMNDVisible();return a};q.prototype.load=function(v){var t=v.type;this._vizModel().type(t);var a=v.feedingItems;if(a){if(l.isGeo(t)){var e=[];for(var i=0;i<a.length;i++){e[i]=c.fromJSON(a[i])}this.feeds(e)}else{var e=c.fromJSON(a);if(e&&e.length>0){this.feeds(e)}}}this._vizModel().isMNDVisible(v.mndVisible)};q.langProps={'measures':'VIZ_COMMON_MEASURES','dimensions':'VIZ_COMMON_DIMENSIONS','trellis':'VIZ_COMMON_TRELLIS'};q.prototype._onConnect=function(v,a){if(a){this._vizModel().extensionValues({feedingPanel:{enableTrellis:this._enableTrellis}});this._applyModel()}};q.prototype._onVizModelChanged=function(e){var t=this._vizModel().type();if(l.isGeo(t)){return}if(e.data.vizTypeChanged){this._applyModel()}else if(e.data.feedingItemsChanged||e.data.isMNDVisibleChanged){this._applyModel(false)}};q.prototype._getFeed=function(a){var e=this._vizModel().feedingItems()||[];for(var i=0;i<e.length;i++){var r=e[i];if(r.id()===a){return r}}return null};q.prototype._applyModel=function(r){if(r!==false){this._createShelves()}this._updateShelves()};q.prototype._createShelves=function(){var s=k.getInitialShelves(this._vizModel().type());this._redrawShelves(s.measure,s.attribute,s.trellis)};q.prototype._updateShelves=function(){var a=this._vizModel().explicitFeedingItems()||[];var t=function(r){for(var s in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(s)){var v=this._dicUIShelf[s];var w=[];for(var i=0;i<a.length;i++){var x=a[i];if(x.id()===v.shelf().id){w=x.values()}}r(v,w)}}};var e=[];t.call(this,function(r,v){for(var i=0;i<v.length;i++){var s=v[i];if(A.compatible(A.MEASURE,s.type())){e.push(s.name())}}});t.call(this,function(r,v){for(var i=0;i<v.length;i++){var s=v[i];if(A.compatible(A.MND,s.type())){s.name('('+e.join(',')+')')}}r.analyses(v)})};q.prototype._redrawShelves=function(a,e,t){var i;this._dom$.empty();for(var s in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(s)){i=this._dicUIShelf[s];i.destroy()}}this._dicUIShelf={};this._createSection(L.get(q.langProps['measures']),a);this._createSection(L.get(q.langProps['dimensions']),e);if(this._enableTrellis){this._createSection(L.get(q.langProps['trellis']),t)}for(var r in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(r)){i=this._dicUIShelf[r];i.addEventListener(j.CLICK_ADD_FEEDING,this._clickAddFeeding,this);i.addEventListener(j.FEEDING_CHANGED,this._deferFeedsUpdated,this);i.addEventListener(j.FEEDING_EMPTY_CHANGED,this._dragToUpdateShelvesStatus,this);i.addEventListener(j.FEEDING_DROP_DENY,this._updateShelvesStatus,this);i.addEventListener(j.ACTION_CHANGED,this._actionChangedHandler,this)}}};q.prototype._clickAddFeeding=function(e){var a=e.target();this._uiShelf=a;if(this._uiConfig&&this._uiConfig.useBuildInFeedList===true){var s=a.shelf();var i=document.createElement('div');var r=this._getFeed(s.id);var t=r?r.values():[];var v=new f(i,this._allAnalyses,s.feedItemType,t);v.addEventListener(g.ITEM_SELECTED,function(e){var w=e.data.selectedItem;a.addAnalysis(w)},this);v.open(a.popUpDock())}else{this._dispatchEvent(new F(F.REQUEST_FEED,this,{'feedId':a.shelf().id,'fieldLocalPosition':a.popUpDock()}))}};q.prototype._actionChangedHandler=function(e){this._dispatchEvent(new o(o.ACTION_CHANGED,this,{'feedItemID':e.data.feedItemID,'analysisObjectID':e.data.analysisObjectID,'actionID':e.data.actionID}))};q.prototype._deferFeedsUpdated=function(e){if(!this._feedsUpdatedRequested){this._feedsUpdatedRequested=true;u.defer($.proxy(function(){this._feedsUpdatedRequested=false;if(this._dom){this._feedsUpdated()}},this))}};q.prototype._createSection=function(t,s){if(s.length===0){return}var a=$(document.createElement('div')).appendTo(this._dom$);var e=$(document.createElement('div')).appendTo(a);e.addClass(C.FEEDINGPANEL_PREFIX+"title-without-icon");var r=$(document.createElement('label')).appendTo(e);r.addClass(C.FEEDINGPANEL_PREFIX+"title-text");r.text(t);var v=$(document.createElement('div')).appendTo(a);v.addClass(C.FEEDINGPANEL_PREFIX+"separator");var w=$(document.createElement('div')).appendTo(a);w.addClass(C.FEEDINGPANEL_PREFIX+"container");for(var i=0;i<s.length;i++){var x=s[i];var y=new h(document.createElement('div'),x,this._uiConfig.measure);w.append(y._dom);this._dicUIShelf[x.id]=y}if(s[0].type==="trellis"){e.removeClass(C.FEEDINGPANEL_PREFIX+"title-without-icon");e.addClass(C.FEEDINGPANEL_PREFIX+"title-with-icon");var z=this._trellisArrowIcon$=$(document.createElement('div'));z.appendTo(e);z.click($.proxy(this._trellisArrowIconClickHandler,this));r.click($.proxy(this._trellisArrowIconClickHandler,this));this._trellisContainer$=w;this._updateTrellisSection(this._trellisCollapsed)}};q.prototype._feedsUpdated=function(){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:update_feeds');var v=this._vizModel();var a=[];for(var s in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(s)){var e=this._dicUIShelf[s];var i=e.shelf();a.push(new c(i.id,m.convertFeedType(i.feedItemType),e.analyses()))}}var r=v.explicitFeedingItems();var t=!m.equal(r,a);if(t){v.feedingItems(a);this._dispatchEvent(new F(F.FEEDS_CHANGED,this,{'feeds':this.feeds()}))}this._updateShelvesStatus();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:update_feeds')};q.prototype._dragToUpdateShelvesStatus=function(e){var r=e.data;var s=r.analysisObject;var t=r.feedId;var v=this._vizModel();if(v){var w=m.cloneFeeds(v.feedingItems());for(var i=0;i<w.length;i++){var x=w[i];if(x.id()===t){var y=x.values();for(var i=0;i<y.length;i++){var a=y[i];if(a.id()===s.id()){y.splice(i,1);break}}break}}var z=v.type();var D=m.getManifestFeedsMap(z);if(!l.isMultipleChart(z)&&l.supportMultiChart(z)){var E=l.toMultiChartType(z);var H=m.getManifestFeedsMap(E);var I=H[m.MultiplierFeedingName];D[m.MultiplierFeedingName]=I}var J=v.isMNDVisible();var K=(s.type()===A.MND);for(var M in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(M)){var N=this._dicUIShelf[M];if(N&&N.shelf().analysisType!==A.MEASURE){var P;if(M===m.RowsFeedingName||M===m.ColumnsFeedingName){P=D[m.MultiplierFeedingName]}else{P=D[M]}var Q=m.canAddValue(w,M,P,J,K);N.enableFeeding(Q)}}}}};q.prototype._updateShelvesStatus=function(){var v=this._vizModel();if(v){var a=m.cloneFeeds(v.feedingItems());var t=v.type();var e=m.getManifestFeedsMap(t);if(!l.isMultipleChart(t)&&l.supportMultiChart(t)){var i=l.toMultiChartType(t);var r=m.getManifestFeedsMap(i);var s=r[m.MultiplierFeedingName];e[m.MultiplierFeedingName]=s}var w=v.isMNDVisible();var x=false;for(var y in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(y)){var z=this._dicUIShelf[y];if(z&&z.shelf().analysisType!==A.MEASURE){var D;if(y===m.RowsFeedingName||y===m.ColumnsFeedingName){D=e[m.MultiplierFeedingName]}else{D=e[y]}var E=m.canAddValue(a,y,D,w,x);z.enableFeeding(E)}}}var H=m.hasRowOrColumn(a);if(H){this._CollapseTrellis(false)}}};q.prototype._validateSize=function(){var s=this.size();this._dom$.height(s.height);this._dom$.width(s.width)};q.prototype._trellisArrowIconClickHandler=function(){this._CollapseTrellis(!this._trellisCollapsed)};q.prototype._updateTrellisSection=function(i){if(!this._trellisArrowIcon$){return}this._trellisArrowIcon$.removeClass();this._trellisArrowIcon$.addClass(C.COMMON_PREFIX+"UVBSharedSprite");if(i){this._trellisArrowIcon$.addClass(C.FEEDINGPANEL_PREFIX+"collapse-icon");this._trellisContainer$.hide()}else{this._trellisArrowIcon$.addClass(C.FEEDINGPANEL_PREFIX+"expand-icon");this._trellisContainer$.show()}};q.prototype._CollapseTrellis=function(i){if(arguments.length>0){if(this._trellisCollapsed!==i){this._trellisCollapsed=i;this._updateTrellisSection(i)}}else{return this._trellisCollapsed}};return q});define('sap/viz/controls/Version',[],function(){var V={};V.VERSION='1.1';return V});define('sap/viz/controls/builder/VizBuilder',['jquery','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/VizControlHost','sap/viz/controls/common/views/feed/FeedingShelfEvent','sap/viz/controls/common/managers/LangManager','sap/viz/controls/builder/VizBuilderConfig','sap/viz/controls/builder/VizBuilderEvent','sap/viz/controls/mapbuilder/MapBuilder','sap/viz/controls/mapbuilder/events/GeoEvent','sap/viz/controls/switchbar/SwitchBar','sap/viz/controls/switchbar/SwitchBarEvent','sap/viz/controls/feeding/FeedingPanel','sap/viz/controls/feeding/FeedingPanelEvent','sap/viz/controls/Version','sap/viz/controls/feeding/FeedingPanelConfig','sap/viz/controls/mapbuilder/MapBuilderConfig','sap/viz/controls/switchbar/SwitchBarConfig'],function($,G,C,a,F,O,u,b,V,c,L,d,e,M,f,S,g,h,j,k,l,m,n){var o=a.COMMON_PREFIX;var p=function p(q,r){p.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.builder.VizBuilder";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_vizbuilder_control');this._dom=q;this._dom$=$(this._dom);this._dom$.addClass([a.BUILDER_PREFIX+'area',o+'scrollable',o+'scrollable-y'].join(' '));this._uiConfig=r?r:G.defaultUIConfig(G.DEFAULT_UICONFIG_TYPE_BUILDER);this._vizModel().type(this._uiConfig.defaultVizType);for(var i in this._uiConfig.controls){if(this._uiConfig.controls.hasOwnProperty(i)){var s=this._uiConfig.controls[i];if(s.defaultVizType&&s.defaultVizType!==this._uiConfig.defaultVizType){s.defaultVizType=this._uiConfig.defaultVizType}}}this._layout=null;this._divContainer=null;this._switchBar=null;this._feedingPanel=null;this._mapBuilder=null;this._switchBarDiv=null;this._feedingPanelDiv=null;this._mapBuilderDiv=null;this._activeFeedingDiv=null;this._trellisHistory={};this._attributeHistory={};this._measureHistory={};this._createChildren();var t=this._vizModel().type()?this._vizModel().type():this._uiConfig.defaultVizType;if(t===this._uiConfig.defaultVizType){this._updateActiveFeedingDiv()}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_vizbuilder_control')};O.extend(p,V);p.VERSION='2.0';p.prototype._createChildren=function(){this._layout=$(document.createElement('div')).addClass(a.BUILDER_PREFIX+"view-list");var i=this._uiConfig.controls;var q;var r=true;if(this._uiConfig.header){r=this._uiConfig.header.visible===false?false:true}var s=this._divContainer=$(document.createElement('div'));s.addClass(a.BUILDER_PREFIX+'switcher-container');s.appendTo(this._layout);var t=i.switchBar?i.switchBar:n.instance();if(t){if(r){var v=$(document.createElement('div'));v.addClass(a.BUILDER_PREFIX+'header');var w=$(document.createElement('span'));w.addClass(a.BUILDER_PREFIX+'header-text').text(L.get('VIZ_BUILDER_CHART'));var x=$('<span/>');x.addClass(a.BUILDER_PREFIX+'header-value');w.appendTo(v);x.appendTo(v);v.appendTo(s)}this._switchBarDiv=$(document.createElement('div'));this._switchBar=new S(this._switchBarDiv,t);this._switchBar.size({'width':212,'height':150});this._switchBar.horizontalGap(15);this._switchBar.addEventListener(g.VIZ_TYPE_CHANGED,function(B){var D=this._switchBar.selectedTypeObject();x.text(D?D.caption:'')},this);var y=this._switchBar.vizType();if(r&&y&&y.length>0){x.text(b.getVizTypeObject(y).caption)}this._switchBarDiv.appendTo(s);this._addChild(this._switchBar,['vizType'],[g.VIZ_TYPE_CHANGED])}var z=i.feedingPanel?i.feedingPanel:l.instance();if(z){q=z;this._feedingPanelDiv=$(document.createElement('div'));this._feedingPanel=new h(this._feedingPanelDiv,q);this._addChild(this._feedingPanel,['feeds','feed','feedAnalysisObjects'],[F.REQUEST_FEED,F.FEEDS_CHANGED,j.ACTION_CHANGED])}var A=i.mapBuilder?i.mapBuilder:m.instance();if(A){q=A;q.feedingPanel.useBuildInFeedList=i.feedingPanel.useBuildInFeedList;this._mapBuilderDiv=$(document.createElement('div'));this._mapBuilder=new M(this._mapBuilderDiv,q);this._addChild(this._mapBuilder,['config'],[f.CHANGE_BASEMAP_PROVIDER,f.CHANGE_BASEMAP_TYPE,f.SHOW_LAYER,f.HIDE_LAYER,f.CHANGE_LAYER_VIZTYPE,f.SHOW_LEGEND,f.HIDE_LEGEND,f.CHANGE_VIZ_PROPERITIES,f.ADD_LAYER,f.UPDATE_LAYER_DATA,f.DELETE_LAYER,f.REORDER_LAYER,f.RENAME_LAYER])}$(this._layout).appendTo(this._dom)};p.prototype._validateSize=function(){};p.prototype._onVizModelChanged=function(i){if(i.data.vizTypeChanged){this._updateActiveFeedingDiv()}};p.prototype._updateActiveFeedingDiv=function(){var i=this._vizModel();if(i.type()===C.TYPE_GEO_MAP){this._activeFeedingDiv=this._replaceDiv(this._layout,this._activeFeedingDiv,this._mapBuilderDiv);if(this._mapBuilder){this._mapBuilder.reset()}}else{this._activeFeedingDiv=this._replaceDiv(this._layout,this._activeFeedingDiv,this._feedingPanelDiv)}};p.prototype._replaceDiv=function(i,s,t){if(s!==t){if(s){s.detach()}if(t){t.appendTo(i);s=t}}return s};p.prototype.analysisObjectsForPicker=function(i){if(arguments.length>0){if(this._feedingPanel){this._feedingPanel.analysisObjectsForPicker.apply(this._feedingPanel,arguments)}if(this._mapBuilder){this._mapBuilder.analysisObjectsForPicker.apply(this._mapBuilder,arguments)}}else{if(this._feedingPanel){return this._feedingPanel.analysisObjectsForPicker.apply(this._feedingPanel)}if(this._mapBuilder){return this._mapBuilder.analysisObjectsForPicker.apply(this._mapBuilder)}}};p.prototype.save=function(){var i={};i['version']=k.VERSION;if(this._switchBar){i['switchBar']=this._switchBar.save()}if(this._feedingPanel){i['feedingPanel']=this._feedingPanel.save()}if(this._mapBuilder){i['mapBuilder']=this._mapBuilder.save()}return i};p.prototype.load=function(v){if(!v){return}var i=v["switchBar"];if(i&&this._switchBar){this._switchBar.load(i)}i=v["feedingPanel"];if(i&&this._feedingPanel){this._feedingPanel.load(i)}i=v["mapBuilder"];if(i&&this._mapBuilder){this._mapBuilder.load(i)}};p.prototype.feedingPanel=function(){return this._feedingPanel};p.prototype.switchBar=function(){return this._switchBar};p.prototype.mapBuilder=function(){return this._mapBuilder};return p});define('sap/viz/controls/common/constants/EventTypeConst',[],function(){var E={};E.VC_CHANGE_VIZ_TYPE="vc-changeVizType";E.PRESS_FILTER_BUTTON="vc-filter";E.PRESS_EXCLUDE_BUTTON="vc-exclude";E.PRESS_DRILLDOWN_BUTTON="vc-drillDown";E.SELECT_SHOW_LEGEND="vc-showLegend";E.SELECT_SHOW_DATALABELS="vc-showDataLabels";E.SELECT_CHANGE_DIRECTION="vc-changeDirection";E.SELECT_CHANGE_STACKING="vc-changeStacking";E.SELECT_INSERT_COMMENT="vc-insertComment";E.SELECT_CHART_EDITOR="vc-chartEditor";E.SHOW_MESSAGE="vc-showMessage";E.CLEAR_MESSAGE="vc-clearMessage";E.VIZ_DEFINITION_CHANGED='vizDefinitionChanged';E.REQUEST_FILTER_VALUES='requestFilterValues';return E});define('sap/viz/controls/chart/views/ChartEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var C=function(t,a,d){C.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ChartEvent"};O.extend(C,E);C.CHANGED_SELECTED_DATA="changeSelectedData";C.TRIGGER_CVOM_EVENT="triggerCVOMEvent";C.CHART_CHANGING="ChartChanging";C.CHART_CHANGED="ChartChanged";C.CVOM_INITIALIZED="CVOMChartInitialized";C.CLICK_FILTER_BUTTON="clickFilterButton";C.CLICK_EXCLUDE_BUTTON="clickExcludeButton";C.CLICK_DRILLDOWN_BUTTON="clickDrillDownButton";C.CHANGE_FEEDING="changeFeeding";C.ANALYSIS_DROPPED="analysisDropped";C.TITLE_CHANGED="TitleChanged";C.VIZTYPE_CHANGED="vizTypeChanged";C.SELECT_PROPERTY_ZONE="selectPropertyZone";return C});define('sap/viz/controls/annotation/AnnotationEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var A=function(t,a,d){A.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.AnnotationEvent"};O.extend(A,E);A.COMMENT_CHANGED_EVENT="commentChanged";return A});define('sap/viz/controls/annotation/views/DialogEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var D=function(t,a,d){D.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.DialogEvent"};O.extend(D,E);D.OK="OK";D.Cancel="Cancel";return D});define('sap/viz/controls/annotation/views/ConfirmDialog',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/annotation/views/DialogEvent','jquery'],function(O,U,C,L,D,$){var a=function(){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.ConfirmDialog";this._confirmDialog$=null;this._needConfirm=true;this._visible=false;this._createChildren()};O.extend(a,U);a.prototype._createChildren=function(){var _=this;this._confirmDialog$=$(document.createElement('div'));this._confirmDialog$.addClass(C.ANNOTATION_PREFIX+'confirmdialog');var d=$(document.createElement('div'));d.addClass(C.ANNOTATION_PREFIX+'confirmdialog-header');this._confirmDialog$.append(d);var b=$(document.createElement('span'));b.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerleft');d.append(b);var c=$(document.createElement('span'));c.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerleft-label');b.append(c);var e=$(document.createElement('span'));e.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerright');d.append(e);var f=$(document.createElement('a'));f.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerright-close');e.append(f);f.click(function(){_.hide()});var g=$(document.createElement('div'));g.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content');this._confirmDialog$.append(g);var h=$(document.createElement('div'));h.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-up');h.appendTo(g);var i=$(document.createElement('div'));i.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-icon');i.appendTo(h);var j=$(document.createElement('div'));j.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-info');j.text(L.get("VIZ_COMMON_DELETE_COMMENT_MESSAGE"));j.appendTo(h);var k=$(document.createElement('div'));k.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-down');k.appendTo(g);this._checkBoxNeedConfirm$=$(document.createElement("input"));this._checkBoxNeedConfirm$.attr("type","checkbox");this._checkBoxNeedConfirm$.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-checkbox');this._checkBoxNeedConfirm$.appendTo(k);var l=$(document.createElement('div'));l.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-checkboxlabel');l.text(L.get("VIZ_COMMON_DONT_SHOW_MESSAGE"));l.appendTo(k);var m=$(document.createElement('div'));m.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer');this._confirmDialog$.append(m);var n=$(document.createElement('div'));n.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer-buttons');m.append(n);var o=$(document.createElement('button'));o.text(L.get("VIZ_COMMON_OK"));o.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer-button');o.addClass(C.COMMON_PREFIX+'button');n.append(o);o.click(function(){_.hide();_._needConfirm=!(_._checkBoxNeedConfirm$.prop("checked"));_._dispatchEvent(new D(D.OK,_,_._needConfirm))});var p=$(document.createElement('button'));p.text(L.get("VIZ_COMMON_CANCEL"));p.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer-button');p.addClass(C.COMMON_PREFIX+'button');n.append(p);p.click(function(){_.hide()});this._blockLayout$=$(document.createElement('div'));this._blockLayout$.addClass(C.ANNOTATION_PREFIX+'block-layer')};a.prototype.show=function(p){this._visible=true;$(document.body).append(this._blockLayout$);$(document.body).append(this._confirmDialog$);if(p){this.setPos(p)}};a.prototype.hide=function(){this._visible=false;this._blockLayout$.detach();this._confirmDialog$.detach()};a.prototype.setPos=function(p){this._confirmDialog$.css({position:"absolute",left:p.pageX-this._confirmDialog$.width()/2,top:p.pageY-this._confirmDialog$.height()/2})};a.prototype.isVisible=function(){return this._visible};return a});define('sap/viz/controls/annotation/models/Comment',['sap/viz/controls/common/managers/LangManager'],function(L){var C=function(d,a,s){this._dimension=d;this._dimension2=a;this._series=s;this._text='';this._createTime=L.get("VIZ_ANNOTATION_COMMENT")};C.prototype.dimension=function(v){if(arguments.length>0){this._dimension=v;return this}else{return this._dimension}};C.prototype.dimension2=function(v){if(arguments.length>0){this._dimension2=v;return this}else{return this._dimension2}};C.prototype.series=function(v){if(arguments.length>0){this._series=v;return this}else{return this._series}};C.prototype.createTime=function(v){if(arguments.length>0){this._createTime=v;return this}else{return this._createTime}};C.prototype.text=function(v){if(arguments.length>0){this._text=v;return this}else{return this._text}};return C});define('sap/viz/controls/annotation/views/Comments',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/annotation/views/DialogEvent','sap/viz/controls/annotation/views/ConfirmDialog','sap/viz/controls/annotation/models/Comment'],function($,C,O,a,U,V,E,b,D,c,d){var F='#F1AB00';var T=12;var L=4;var M=200;var I=8;var f={width:14,height:16};var g="font-family:Arial;font-size:12px;font-weight:bold;fill:#000000;";var h="font-family:Arial;font-size:12px;font-weight:normal;fill:#000000;";var j=function(){this._commentsMap={};this._commentsPositionMap={};this._vizData=null;this._vizType=null;this._eventHandlers={};this._needConfirm=true;this._currentComment=null};O.extend(j,b);j.Event_EditComment='Event_EditComment';j.Event_RemoveComment='Event_RemoveComment';j.Event_DragComment='Event_DragComment';j.prototype._showConfirmDialog=function(){this._getConfirmDialog().show({pageX:$(this._parent).offset().left+$(this._parent).width()/2,pageY:$(this._parent).offset().top+$(this._parent).height()/2})};j.prototype._getConfirmDialog=function(){if(!this._confirmDialog){this._confirmDialog=new c();this._confirmDialog.addEventListener(D.OK,this._confirmChangedHandler,this)}return this._confirmDialog};j.prototype._confirmChangedHandler=function(e){this._needConfirm=e.data;this._onRemoveComment(this._currentComment)};j.prototype.assetFolder=function(v){if(arguments.length>0){this._assetFolder=v;return this}else{return this._assetFolder}};j.prototype.setChartInfo=function(v){if(arguments.length>0){this._vizData=v.vizData;this._vizType=v.vizType;return this}else{return this._vizData}};j.prototype.feedsChanged=function(){this._commentsPositionMap={}};j.prototype._initDIV=function(){if(this._parent){this._parent.empty()}else{var e=document.createElement("DIV");this._parent=$(e);this._chartHolderDiv=$('div.'+C.PREFIX+'chart-holder')[0];this._parent.appendTo(this._chartHolderDiv).attr('id',"comments-parent");this._parent.attr('style','overflow:hidden;position:absolute;pointer-events:none;left:0px;top:0px;')}this._triangleHolder=null;this._lineHolder=null};j.prototype.redraw=function(){this._initDIV();var v=this._vizType;if(!A.supportType[v]||V.hasFakeData(this._vizData)){return}for(var i in this._commentsMap){if(this._commentsMap.hasOwnProperty(i)){this._drawComment(i)}}};j.prototype.clean=function(){this._initDIV()};j.prototype._getPathInfo=function(e,v){var w=e.dii_a1;var x=e.mi;var y=v._crosstableDataset;var z=y.getAnalysisAxisByIdx(0);var B=null;if(z){B='';z=z.getDimensionLabels();for(var i=0;i<z.length;i++){B+=z[i].getValues()[w]}}else{B=y.getMeasureValuesGroupByIdx(0).getMeasureValues()[w].getId()}var G=y.getAnalysisAxisByIdx(1);var H=null;if(G){H='';G=G.getDimensionLabels();for(var n=0;n<G.length;n++){H+=G[n].getValues()[e.dii_a2]}}var J={dimensionIndex:w,seriesIndex:x,dimension:B,dimension2:H};J.series=y.getMeasureValuesGroupByIdx(e.mg).getMeasureValues()[x].getId();return J};j.prototype._findDataPoint=function(e){var n=d3.selectAll('.v-datapoint')[0];var v=e.dimension();var w=e.dimension2();var x=e.series();for(var i=0;i<n.length;i++){var y=n[i].__data__;if(y){var z;if(U.isArray(y.ctx)){z=this._getPathInfo(y.ctx[0].path,this._vizData);if(z.dimension===v&&z.dimension2===w&&z.series==x){return n[i]}}else{z=this._getPathInfo(y.ctx.path,this._vizData);if(z.dimension===v&&z.dimension2===w&&z.series==x){return n[i]}}}}};function k(e){var i=e.__data__;if(i&&i.r&&i.midAngle){var n=i.midAngle();var x=i.r*Math.sin(n);var y=i.r-i.r*Math.cos(n);var v=$(e).parentsUntil('.v-m-plot');if(v.length>0){var w=$(v[v.length-1]).parent()[0];var z=w.getElementsByTagName('rect');var B=z[0].getAttribute('height');var G=z[0].getAttribute('width');var H=w.getBoundingClientRect();var J=H.left+G/2;var K=H.top+6+i.r;var N={width:1,height:1,top:K-i.r+y,left:J+x};return N}else{return e.getBoundingClientRect()}}else{return e.getBoundingClientRect()}}function l(e){var i=e.dimension()+"-"+e.dimension2()+"-"+e.series();i=i.replace(/[^(0-9|A-z)]/g,"_");return i}function m(e){return e+'-line'}function o(e){return e+'-triangle'}function p(e){var i=e.currentTarget.parentNode.__data;if(e.data&&i){if(e.data._needConfirm){e.data._currentComment=i;e.data._showConfirmDialog()}else{e.data._onRemoveComment(i)}}e.stopPropagation()}function q(e){var i=e.currentTarget.parentNode.__data;if(e.data&&i){e.data._onEditComment(i)}e.stopPropagation()}function r(e){var i=e.target;if(i&&i.className!=='ui-draggable'){var n=$(i).parentsUntil(e.data._parent);if(n&&n.length>0){i=n[n.length-1]}}if(e.data&&i&&i.className==='ui-draggable'){$(i).detach();$(i).appendTo(e.data._parent)}e.stopPropagation()}function u(e,i,n,v,w){var x={x:e.left,y:e.top+e.height/2};var y={x:i.left+i.width/2,y:i.top};var z=x.x-y.x;var B=x.y-y.y;var G=Math.sqrt(z*z+B*B);var H=Math.asin(B/G)*180/Math.PI;if(x.x<y.x){H=180-H}var J='rotate('+H+'deg)';var K="0 0";v.css({'transform':J,'transform-origin':K,'-webkit-transform':J,'-webkit-transform-origin':K,'-ms-transform':J,'-ms-transform-origin':K,'-moz-transform':J,'-moz-transform-origin':K,width:Math.floor(G)-L+'px',left:(y.x-n.left)+'px',top:y.y-n.top+'px'});J='rotate('+(H+90)+'deg)';K="50% 100%";w.css({'transform':J,'transform-origin':K,'-webkit-transform':J,'-webkit-transform-origin':K,'-ms-transform':J,'-ms-transform-origin':K,'-moz-transform':J,'-moz-transform-origin':K,left:(y.x-n.left-T/2)+'px',top:(y.y-n.top-T)+'px'})}function s(e,w){var i='height:0px;width:0px;margin:0px;padding:0px;';i+='border-top-width:'+e+'px;border-left-width: '+w/2+'px;border-right-width: '+w/2+'px;';i+='border-bottom-width: 0px;border-style: solid;border-color: '+F+' transparent transparent transparent;';return i}j.prototype._initCommentUI=function(i,n,v){var w=k(i);var x=this._parent[0].getBoundingClientRect();var y=0;var z=0;var B=n.attr('id');if(this._commentsPositionMap.hasOwnProperty(B)&&this._commentsPositionMap[B].hasOwnProperty(this._vizType)){y=this._commentsPositionMap[B][this._vizType].left;z=this._commentsPositionMap[B][this._vizType].top}else{y=0;z=w.top-x.top-80;var G=i.__data__;if(G&&G.r&&G.midAngle&&Math.sin(G.midAngle())<0){y=w.left-Math.max(w.width,40)-x.left-150}else{y=w.left+Math.max(w.width,40)-x.left}}var H="pointer-events:auto;";H+="padding:4px;background-color:#FFFFCC;";H+='border-radius:4px;border-width:2px; border-color:'+F+'; border-style:solid;';H+="position:absolute;left: "+y+"px; top:"+z+"px;";H+="width:"+M+"px;";n.attr('style',H);n.bind('mouseenter',function(e){var B=$(e.currentTarget).attr('id');var J=$('div#'+B+' img');J.css('visibility','');var K=$('div#'+B+' div#'+'createTime');if(K){K.css('right','68px')}});n.bind('mouseleave',function(e){var B=$(e.currentTarget).attr('id');var J=$('div#'+B+' img');J.css('visibility','hidden');var K=$('div#'+B+' div#'+'createTime');if(K){K.css('right','18px')}});n.bind('contextmenu',function(e){e.stopPropagation()});if(y+n.outerWidth()>this._parent.innerWidth()){y=this._parent.innerWidth()-n.outerWidth()}if(z+n.outerHeight()>this._parent.innerHeight()){y=this._parent.innerHeight()-n.outerHeight()}n.css({left:y+'px',top:z+'px'})};j.prototype._addCommentUI=function(e,n,v){var w=I;for(var i=0;i<v.length;i++){var x=$(document.createElement("DIV")).appendTo(n).attr('style','position:absolute;padding:'+I+'px;left:0px;right:0px;top:'+w+'px;width:'+M+'px;height:auto;');var y=this._appendItem(x,v[i]);x.css('height',y+'px');w+=y+I;x[0].__data=v[i]}w-=I;n.css('height',w+'px');var z=k(e);var B=this._parent[0].getBoundingClientRect();var G=Number(n.css("left").replace('px',''));var H=Number(n.css("top").replace('px',''));G=Math.min(Math.max(G,0),B.width-M);H=Math.min(Math.max(H,0),B.height-w);n.css({left:G,top:H});var J=n[0].getBoundingClientRect();n[0].__dataPoint=e;n[0].__parent=this._parent[0];var K=n.attr('id');var N=o(K);var P=$('#'+N);if(P.length===0){P=$(document.createElement("DIV"));if(this._triangleHolder){P.insertAfter(this._triangleHolder)}else{P.insertBefore(n)}this._triangleHolder=P;P.attr('id',N).attr('style','position:absolute;'+s(T,T))}var Q=m(K);var R=$('#'+Q);if(R.length===0){R=$(document.createElement("DIV"));if(this._lineHolder){R.insertAfter(this._lineHolder)}else{R.insertBefore(n)}this._lineHolder=R;R.attr('id',Q).attr('style','position:absolute;border-left-width:'+L+'px; border-top-width:2px;border-bottom-width:0px;border-right-width:0px;border-color:'+F+' transparent; border-style:solid;width:1px;height:0px;')}u(J,z,B,R,P)};j.prototype._appendItem=function(e,i){var _=this;var n=null;var v=false;var w=0;var x=$(document.createElement("IMG")).appendTo(e);x.attr('src',this._assetFolder+'/edit.png').attr('style','position:absolute;pointer-events:auto;cursor:pointer;top:0px; right:'+(I*3+f.width)+'px;width:'+f.width+'px;height:'+f.height+'px;visibility:hidden;');x.bind('mousedown',this,q);var y=x[0].getBoundingClientRect();var z=$(document.createElement("IMG")).appendTo(e);z.attr('src',this._assetFolder+'/delete.png').attr('style','position:absolute;pointer-events:auto;cursor:pointer;top:0px; right:'+(I*2)+'px;width:'+f.width+'px;height:'+f.height+'px;visibility:hidden;');z.bind('mousedown',this,p);var B=z[0].getBoundingClientRect();var G=this._creatorDiv=$(document.createElement("DIV")).appendTo(e);G.attr('id','createTime');G.text(i.createTime()).attr('style','position:absolute;cursor:default;line-height:normal;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;left:5px;right:18px;top:0px;'+g);G.mouseover(function(K){if(G[0].scrollWidth>G[0].clientWidth){v=true;var N=setTimeout(function(){if(v){if(!n){n=$(document.createElement('div')).appendTo(e);n.attr('style','position:absolute;border-radius:4px;z-index:100;display:block;background-color:#F2F2F2;border:1px solid #7F7F7F;box-shadow:5px 5px 10px rgba(0,0,0,0.5);-webkit-box-shadow:5px 5px 10px rgba(0,0,0,0.5);-moz-box-shadow:5px 5px 10px rgba(0,0,0,0.5);');var P=$(document.createElement('span')).appendTo(n);P.attr('style','border-radius:4px;padding-left:4px;padding-right:4px;display:block;font-size:10px;white-space:nowrap;top:0px;overflow:hidden;');P.text(i.createTime())}var Q=$(G).offset();n.offset({'left':Q.left-5,'top':Q.top-10})}},500)}});G.mouseout(function(K){if(G[0].scrollWidth>G[0].clientWidth){v=false;if(n){n.remove();n=null}}});var H=G[0].getBoundingClientRect();w+=Math.max(y.height,H.height);var J=$(document.createElement("DIV"));J[0].innerHTML=i.text();J.attr('style','position:absolute;pointer-events:none;line-height:normal;word-wrap:break-word;overflow:hidden;top:'+w+'px;width:'+M+'px;'+h).appendTo(e);w+=J[0].getBoundingClientRect().height;return w};j.prototype._removeCommentUI=function(i){var e=m(i);var n=o(i);if(this._triangleHolder&&this._triangleHolder.attr('id')===n){this._triangleHolder=null}if(this._lineHolder&&this._lineHolder.attr('id')===e){this._lineHolder=null}$('div#'+i).remove();$('div#'+e).remove();$('div#'+n).remove();var v=this._parent.children();if(this._triangleHolder===null&&v.length>=3){this._triangleHolder=$(v[v.length/3-1])}if(this._lineHolder===null&&v.length>=3){this._lineHolder=$(v[v.length/3])}};function t(e){var i=$(e.target);var _=e.data;if(e.target.__dataPoint&&e.target.__parent){var n=i[0].getBoundingClientRect();var v=k(i[0].__dataPoint);var w=i[0].__parent.getBoundingClientRect();var x=i.attr('id');var y=$('#'+m(x));var z=$('#'+o(x));u(n,v,w,y,z);if(!_._commentsPositionMap.hasOwnProperty(x)){_._commentsPositionMap[x]={}}_._commentsPositionMap[x][_._vizType]={left:Number(i.css("left").replace('px','')),top:Number(i.css("top").replace('px',''))};e.stopPropagation();_._dispatchEvent(new E(j.Event_DragComment,_,_._commentsMap[x]))}}j.prototype._drawComment=function(i){var _=this;var n=this._commentsMap[i];if(!n||n.length===0){this._removeCommentUI(i);return}var v=this._findDataPoint(n[0]);if(!v){return}var w=$('div#'+i);if(w.length===0){w=$(document.createElement("DIV"));w.appendTo(this._parent).attr('id',i);this._initCommentUI(v,w)}else{w.empty()}this._addCommentUI(v,w,n);w.draggable({containment:"parent",start:function(e,x){e.target.__lastPosition={x:e.clientX,y:e.clientY}},stop:function(e,x){e.data=_;t(e)},drag:function(e,x){e.data=_;t(e)}});w.bind('click',this,r)};j.prototype._onEditComment=function(e){if(e==null){return}var i=l(e);var n=this._commentsMap[i];if(n==null){return}this._dispatchEvent(new E(j.Event_EditComment,this,e))};j.prototype._onRemoveComment=function(e){if(e==null){return}var n=l(e);var v=this._commentsMap[n];if(v==null){return}for(var i=0;i<v.length;i++){if(v[i]===e){v.splice(i,1);break}}this._drawComment(n);this._dispatchEvent(new E(j.Event_RemoveComment,this,e))};j.prototype.createComment=function(e){if(e.length===0){return}var i=e[e.length-1].ctx[0];var n=this._getPathInfo(i,this._vizData);var v=new d(n.dimension,n.dimension2,n.series);v.text('');return v};j.prototype.addComment=function(e){if(e==null){return}var i=l(e);if(this._commentsMap[i]==null){this._commentsMap[i]=[]}this._commentsMap[i].push(e);this._drawComment(i)};j.prototype.updateComment=function(e){if(e==null){return}var i=l(e);if(!this._commentsMap[i]){return}this._drawComment(i)};j.prototype.size=function(e){if(e){$('div#comments-parent').css(e);if(this._getConfirmDialog().isVisible()){this._getConfirmDialog().setPos({pageX:$(this._parent).offset().left+$(this._parent).width()/2,pageY:$(this._parent).offset().top+$(this._parent).height()/2})}}};j.prototype.json2CommentsMap=function(e){for(var n in e){if(e.hasOwnProperty(n)){if(this._commentsMap[n]==null){this._commentsMap[n]=[]}var v=e[n];for(var i=0;i<v.length;i++){var w=v[i];var x=new d(w.dimension,w.dimension2,w.series);x.createTime(w.createTime);x.text(w.text);this._commentsMap[n].push(x)}}}this._needConfirm=e["needConfirm"];this._commentsPositionMap=e["commentsPositionMap"]};j.prototype.commentsMap2Json=function(){var e={};for(var n in this._commentsMap){if(this._commentsMap.hasOwnProperty(n)){var v=this._commentsMap[n];e[n]=[];for(var i=0;i<v.length;i++){var w=v[i];e[n].push({"dimension":w.dimension(),"dimension2":w.dimension2(),"series":w.series(),"createTime":w.createTime(),"text":w.text()})}}}e["needConfirm"]=this._needConfirm;e["commentsPositionMap"]=this._commentsPositionMap;return e};var A={"name":"comment","text":"VIZ_CONTEXTMENU_INSERT_COMMENT","icon":{"show":"/contextmenu/annotation.png"},"supportType":{"viz/column":true,"viz/stacked_column":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true}};return j});define('sap/viz/controls/annotation/views/CommentEditorView',['sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/annotation/views/DialogEvent','jquery'],function(L,O,U,a,C,D,$){var M=140;var l="";var t=false;var b=function(d){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.CommentEditorView";this._div=d;this._comment="";this._visible=false;this._oRichTextDialog=null;this._createChildren()};O.extend(b,a);b.WIDTH=497;b.HEIGHT=213;b.prototype._createChildren=function(){var _=this;this._oRichTextDialog=document.createElement('div');this._oRichTextDialog.id="divRichTextDialog";$(this._oRichTextDialog).addClass(C.ANNOTATION_PREFIX+'richtextdialog');$(document.body).append(this._oRichTextDialog);this.hide();var d=document.createElement('div');d.id="RichTextDialogHeader";$(d).addClass(C.ANNOTATION_PREFIX+'richtextdialog-header');$(this._oRichTextDialog).append(d);var c=document.createElement('span');$(c).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerleft');$(d).append(c);var f=document.createElement('span');f.id="RichTextDialogHeaderLabel";$(f).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerleft-label');$(f).text(L.get("VIZ_ANNOTATION_COMMENT"));$(c).append(f);var g=document.createElement('span');$(g).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerright');$(d).append(g);var h=document.createElement('a');h.id="RichTextDialogHeaderClose";$(h).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerright-close');$(g).append(h);$(h).click(function(){_.hide()});var i=document.createElement('div');i.id="RichTextDialogContent";$(i).addClass(C.ANNOTATION_PREFIX+'richtextdialog-content');$(this._oRichTextDialog).append(i);var j=document.createElement('textarea');j.id="RichTextDialogContentTextArea";$(j).addClass('mceEditor');$(i).append(j);var k=document.createElement('div');k.id="RichTextDialogFooter";$(k).addClass(C.ANNOTATION_PREFIX+'richtextdialog-footer');$(this._oRichTextDialog).append(k);var m=document.createElement('div');$(m).addClass(C.ANNOTATION_PREFIX+'richtextdialog-footer-buttons');$(k).append(m);var n=document.createElement('button');n.id="RichTextDialogOKButton";$(n).text(L.get("VIZ_COMMON_OK"));$(n).addClass(C.ANNOTATION_PREFIX+'button');$(n).addClass(C.COMMON_PREFIX+'button');$(m).append(n);$(n).click(function(){_.hide();_._comment=tinymce.activeEditor.getContent();_._dispatchEvent(new D(D.OK,_,{userData:_._userData,comment:_._comment}))});var o=document.createElement('button');o.id="RichTextDialogCancelButton";$(o).text(L.get("VIZ_COMMON_CANCEL"));$(o).addClass(C.ANNOTATION_PREFIX+'button');$(o).addClass(C.COMMON_PREFIX+'button');$(m).append(o);$(o).click(function(){_.hide()});if(!t){t=true;tinymce.init({theme:"advanced",mode:"textareas",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,forecolor,backcolor,|,justifyleft,justifycenter,justifyright,justifyfull,|,fontselect,fontsizeselect",theme_advanced_path:false,theme_advanced_font_sizes:"8px,9px,10px,11px,12px,14px,16px,18px,20px,22px,24px,26px,28px,36px,48px,72px",theme_advanced_statusbar_location:"none",editor_selector:"mceEditor",setup:function(p){p.onEvent.add(function(p,e){var q=p.getContent({format:'text'});if(q.length>M){p.setContent(l);p.selection.select(p.getBody(),true);p.selection.collapse(false)}else{l=p.getContent()}})}})}this._blockLayout=document.createElement('div');this._blockLayout.id="blockLayout";$(this._blockLayout).addClass(C.ANNOTATION_PREFIX+'block-layer')};b.prototype.show=function(o){if(o){if(o.hasOwnProperty("userData")){this._userData=o.userData}if(o.hasOwnProperty("comment")&&U.isString(o.comment)){this._comment=o.comment;l=o.comment;if(tinymce.activeEditor){tinymce.activeEditor.setContent(this._comment)}}if(o.hasOwnProperty("position")){this.setPos(o.position)}}this._visible=true;$(document.body).append(this._blockLayout);$(this._oRichTextDialog).show()};b.prototype.hide=function(){this._visible=false;$(this._blockLayout).detach();$(this._oRichTextDialog).hide()};b.prototype.setPos=function(p){$(this._oRichTextDialog).css({position:"absolute",left:p.pageX-b.WIDTH/2,top:p.pageY-b.HEIGHT/2})};b.prototype.isVisible=function(){return this._visible};return b});define('sap/viz/controls/annotation/Annotation',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/annotation/AnnotationEvent','sap/viz/controls/annotation/views/Comments','sap/viz/controls/annotation/views/DialogEvent','sap/viz/controls/annotation/views/CommentEditorView'],function($,V,O,G,E,a,C,F,b,A,c,D,d){var f=function(e,u){f.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.Annotation";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_annotation_control');this._div=e;this._uiConfig=u?u:G.defaultUIConfig(G.DEFAULT_UICONFIG_TYPE_ANNOTATION);this._popupLayer=e;this._commentEditor=null;this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_annotation_control')};O.extend(f,V);f.VERSION="1.0";f.prototype._createChildren=function(){this._comments=new c();var e=this._uiConfig.commentsAssetFolderPath;this._comments.assetFolder(e?e:'../src/controls/frame/assets');this._comments.addEventListener(c.Event_EditComment,this._editCommentHandler,this);this._comments.addEventListener(c.Event_RemoveComment,this._removeCommentHandler,this);this._comments.addEventListener(c.Event_DragComment,this._dragCommentHandler,this)};f.prototype._getCommentEditor=function(){if(!this._commentEditor){var p=this._popupLayer;if(p){this._commentEditor=new d($(p));this._commentEditor.addEventListener(D.OK,this._commentChangedHandler,this)}}return this._commentEditor};f.prototype._editCommentHandler=function(e){var g=e.data;var h=this._getCommentEditor();h.show({userData:{isNew:false,comment:g},comment:g.text(),position:{pageX:$(this._div).offset().left+$(this._div).width()/2,pageY:$(this._div).offset().top+$(this._div).height()/2}})};f.prototype._removeCommentHandler=function(e){var g=e.data;this._dispatchEvent(new a(A.COMMENT_CHANGED_EVENT,this,g))};f.prototype._dragCommentHandler=function(e){var g=e.data;this._dispatchEvent(new a(A.COMMENT_CHANGED_EVENT,this,g))};f.prototype._commentChangedHandler=function(e){var i=e.data.userData.isNew;var g=e.data.userData.comment;var t=e.data.comment;g.createTime(new Date().toLocaleString());g.text(t);if(i){this._comments.addComment(g)}else{this._comments.updateComment(g)}var h={commentChanged:true};this._dispatchEvent(new a(E.VIZ_DEFINITION_CHANGED,this,h));this._dispatchEvent(new a(A.COMMENT_CHANGED_EVENT,this,g))};f.prototype.popupLayer=function(p){if(arguments.length>0){this._popupLayer=p;return this}else{return this._popupLayer}};f.prototype.validateSize=function(w,h){if(this._comments){this._comments.size({width:w,height:h})}if(this._commentEditor&&this._commentEditor.isVisible()){this._commentEditor.setPos({pageX:$(this._div).offset().left+$(this._div).width()/2,pageY:$(this._div).offset().top+$(this._div).height()/2})}};f.prototype.destroy=function(){if(this._commentEditor){this._commentEditor.removeAllEventListeners();this._commentEditor=null}if(this._popupLayer){this._popupLayer=null}$(this._div).remove()};f.prototype.addComment=function(s){var e=this._comments.createComment(s);if(e){var g=this._getCommentEditor();g.show({userData:{isNew:true,comment:e},comment:'',position:{pageX:$(this._div).offset().left+$(this._div).width()/2,pageY:$(this._div).offset().top+$(this._div).height()/2}})}};f.prototype.setChartInfo=function(v){this._comments.setChartInfo(v)};f.prototype.redraw=function(){this._comments.redraw()};f.prototype.clean=function(){this._comments.clean()};f.prototype.feedsChanged=function(){this._comments.feedsChanged()};f.prototype.save=function(){return this._comments.commentsMap2Json()};f.prototype.load=function(v){this._comments.json2CommentsMap(v)};return f});define('sap/viz/controls/services/FakeDataService',['sap/viz/controls/common/utils/FakeDataUtils'],function(F){var a=function(v,r,f){this._createChart(v,r,f)};a.feedItems2feed=function(f){return F.feedItems2feed(f)};a.prototype.getVizType=function(){return this._vizType};a.prototype.getVizDataset=function(){return this._vizDataset};a.prototype._createChart=function(v,r,f){this._vizType=v;var b=F.buildFakeData(v,f,r);this._vizDataset=b.dataset;this._vizFeeding=b.feeding};return a});define('sap/viz/controls/chart/ghost/IncompleteGhost',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/services/FakeDataService'],function(C,a,F){var I={};I.getDataset=function(t){if((!a.isBuildInType(t))&&t!==C.TYPE_PC&&t!==C.TYPE_FUNNEL&&!a.isTable(t)){var f=new F(t,{},[]);var d=new sap.viz.api.data.CrosstableDataset();var b=f.getVizDataset();d.data(b);return d}else{var b=I._DATA_BY_TYPE[t]?I._DATA_BY_TYPE[t]:I._DATA_COMMON;if(a.isTable(t)){return b}else{var d=new sap.viz.api.data.CrosstableDataset();d.data(b);return d}}};I._DATA_COMMON={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Country','values':['Country 1','Country 2','Country 3','Country 4','Country 5','Country 6','Country 7','Country 8','Country 9']}]},{'index':2,'data':[{'isFake':true,'type':'Dimension','name':'Product','values':['Product 1','Product 2','Product 3','Product 4']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':'Revenue','values':[[98,113,105,29,53,31,48,51,58],[87,103,27,61,28,74,50,32,65],[148,109,91,43,114,50,35,76,75],[71,102,80,29,43,101,69,38,58]]}]},{'index':2,'data':[{'isFake':true,'type':'Measure','name':'Cost','values':[[32,78,91,45,110,55,39,26,50],[86,108,27,50,17,28,89,116,123],[83,28,58,100,86,59,66,87,63],[39,100,88,18,85,96,72,37,59]]}]},{'index':3,'data':[{'isFake':true,'type':'Measure','name':'Margin','values':[[46,58,90,5,10,4,79,86,30],[56,98,20,20,7,58,39,16,23],[103,98,78,40,76,29,16,59,43],[59,80,98,8,45,16,120,97,39]]}]}]};I._DATA_BY_TYPE={};I._DATA_BY_TYPE[C.TYPE_COMBINATION]={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Country','values':['Country 1','Country 2','Country 3','Country 4','Country 5','Country 6','Country 7','Country 8','Country 9']}]},{'index':2,'data':[{'isFake':true,'type':'Dimension','name':'Product','values':['Product 1','Product 2','Product 3','Product 4']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':'Revenue','values':[[98,113,105,29,53,31,48,51,58],[87,103,27,61,28,74,50,32,65],[148,109,91,43,114,50,35,76,75],[71,102,80,29,43,101,69,38,58]]},{'isFake':true,'type':'Measure','name':'Cost','values':[[32,78,91,45,110,55,39,26,50],[86,108,27,50,17,28,89,116,123],[83,28,58,100,86,59,66,87,63],[39,100,88,18,85,96,72,37,59]]}]}]};I._DATA_BY_TYPE[C.TYPE_GEO_BUBBLE]=I._DATA_BY_TYPE[C.TYPE_GEO_CHOROPLETH]=I._DATA_BY_TYPE[C.TYPE_GEO_PIE]=I._DATA_BY_TYPE[C.TYPE_GEO_MAP]={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Region','values':['United Kingdom','Italy','United States','New Zealand','Germany','China','Russia','Canada','Brazil'],'infos':[{'featureId':'UK,NAVTEQ','latLong':undefined},{'featureId':'20110484,NAVTEQ','latLong':undefined},{'featureId':'21000001,NAVTEQ','latLong':undefined},{'featureId':'23060936,NAVTEQ','latLong':undefined},{'featureId':'20147700,NAVTEQ','latLong':undefined},{'featureId':'22928332,NAVTEQ','latLong':undefined},{'featureId':'20485579,NAVTEQ','latLong':undefined},{'featureId':'21041602,NAVTEQ','latLong':undefined},{'featureId':'23028911,NAVTEQ','latLong':undefined}]}]},{'index':2,'data':[{'isFake':true,'type':'Dimension','name':'Product','values':['Product 1','Product 2','Product 3','Product 4']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':'Revenue','values':[[98,113,105,29,53,31,48,51,58],[87,103,27,61,28,74,50,32,65],[148,109,91,43,114,50,35,76,75],[71,102,80,29,43,101,69,38,58]]}]},{'index':2,'data':[{'isFake':true,'type':'Measure','name':'Cost','values':[[32,78,91,45,110,55,39,26,50],[86,108,27,50,17,28,89,116,123],[83,28,58,100,86,59,66,87,63],[39,100,88,18,85,96,72,37,59]]}]},{'index':3,'data':[{'isFake':true,'type':'Measure','name':'Margin','values':[[46,58,90,5,10,4,79,86,30],[56,98,20,20,7,58,39,16,23],[103,98,78,40,76,29,16,59,43],[59,80,98,8,45,16,120,97,39]]}]}]};I._DATA_BY_TYPE[C.TYPE_SCATTER_MATRIX]={"analysisAxis":[{"index":1,"data":[{'isFake':true,'type':'Dimension',"name":"Country","values":["Country 1","Country 1","Country 2","Country 2"]},{'isFake':true,'type':'Dimension',"name":"Product","values":['Product 1','Product 2','Product 3','Product 4']}]}],"measureValuesGroup":[{"index":1,"data":[{'isFake':true,'type':'Measure',"name":"Revenue","values":[[43,31,43,41]]},{'isFake':true,'type':'Measure',"name":"Cost","values":[[252,124,370,170]]}]}]};I._DATA_BY_TYPE[C.TYPE_TREE]=I._DATA_BY_TYPE[C.TYPE_NETWORK]={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Country','values':['Country 1','Country 2','Country 3','Country 4','Country 1','Country 2','Country 3','Country 4','Country 1','Country 2','Country 3','Country 4','Country 1','Country 2','Country 3','Country 4']},{'isFake':true,'type':'Dimension','name':'Product','values':['Product 1','Product 1','Product 1','Product 1','Product 2','Product 2','Product 2','Product 2','Product 3','Product 3','Product 3','Product 3','Product 4','Product 4','Product 4','Product 4']}]}],'measureValuesGroup':[]};I._DATA_BY_TYPE[C.TYPE_PC]={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Country','values':['Country 1','Country 1','Country 1','Country 2','Country 2','Country 3','Country 4','Country 4','Country 4','Country 5','Country 6','Country 7','Country 8','Country 9','Country 9']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':'Revenue','values':[[5.1,4.9,4.7,4.6,5,7,6.4,6.9,5.5,6.5,6.3,5.8,7.1,6.3,6.5]]},{'isFake':true,'type':'Measure','name':'Cost','values':[[3.1,8.9,2.7,6.6,5,5,6.6,6.9,7.5,2.5,2.3,5.8,8.1,1.3,2.5]]}]}]};I._DATA_BY_TYPE[C.TYPE_TABLE]={"isFake":true,"queryResponse":[{"dimAxes":{"rowsDim":{"count":0,"values":[]}},"metadata":{"dictionary":{"rowsDim":[],"measures":[]}},"valueAxes":[],"ranges":{"cellsDim":[{"marksNum":[]}]},"executionStatus":{"status":"ok"}},{"valueAxes":[],"executionStatus":{"status":"ok"}}]};return I});define('sap/viz/controls/common/constants/MapProviderConst',[],function(){var M={};M.ESRI="ESRI";M.CVOM="CVOM";M.NAVTEQ="NAVTEQ";return M});define('sap/viz/controls/chart/views/DropZone',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/helpers/Rectangle'],function($,C,F,O,u,E,a,b,c,D,d,A,R){var f=function(t,z,g){f.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.DropZone";this._targetDiv=t;this._zoneProvider=z;this._feedValidator=g;this._enterDrop=false;this._dragActionArray=[];var s="position:absolute;visibility:hidden;left:0px;top:0px;width:0px;height:0px;";this._dom=$(document.createElement("DIV")).appendTo(this._targetDiv.parentNode).attr('style',s);var h=this;this._dom.droppable({accept:$.proxy(function(e){return this._isTriggerAllowed(e)===true},this),activate:function(e,i){h.enterDrop.apply(h,[e,i])},deactivate:function(e,i){u.defer(function(){h.exitDrop.apply(h,[e,i])})},over:function(e,i){h._onDragOver.apply(h,[e,i])}})};O.extend(f,a);f.DROP_ITEM_EVENT='DROP_ITEM_EVENT';var _=8;f.prototype._match=function(z,e){var t=e.type();if(t){t=t.toLowerCase()}var g=e.dataType();if(g){g=g.toLowerCase()}var h=z.feedDef;var j=h[0].id===F.geoFeeds.id?c.GEOGRAPHY:h[0].type;if(h.length===1&&F.feedCompatible(j,t,g)){return true}for(var i=0;i<h.length;i++){j=h[i].id===F.geoFeeds.id?c.GEOGRAPHY:h[i].type;if(F.feedCompatible(j,t,g)&&h[i].id!==F.MultiplierFeedingName){return true}}return false};f.prototype._onDragOver=function(e,g){if(!this._enterDrop){return}var z=e.target.__zone;var h=e.target.__areaIndex;var t=D.instance().getAnalysisToken(g.helper);if(!z){t.currentAction(d.DENY);return}this._hightlight(z,h);if(this._acceptable(z,t.analysisObject)){t.dropTarget(e.target);t.currentAction(d.ACCEPT)}else{t.currentAction(d.DENY)}for(var i in this._dragActionArray){if(this._dragActionArray[i].zoneName===z.name){this._dragActionArray.splice(i,1);break}}this._dragActionArray.push({"zoneName":z.name,"action":t.currentAction()})};f.prototype._acceptable=function(z,e){var m=this._match(z,e);if(!m){return false}var g=false;var h=z.feedDef;for(var i=0;i<h.length;i++){g=g||this._feedValidator(h[i],e,z.name)}return m&&g};f.prototype._onDragOut=function(e,g){if(!this._enterDrop){return}var z=e.target.__zone;var h=e.target.__areaIndex;if(z){this._unHightlight(z,h)}var t=D.instance().getAnalysisToken(g.helper);if(t.currentAction()===d.ACCEPT&&t.dropTarget()===e.target){t.currentAction(d.DENY);t.dropTarget(null)}for(var i in this._dragActionArray){if(this._dragActionArray[i].zoneName===z.name){this._dragActionArray.splice(i,1);break}}var l=this._dragActionArray.length;if(l>0){t.currentAction(this._dragActionArray[l-1].action)}};f.prototype._onDragDrop=function(e,g){var z=e.target.__zone;var t=D.instance().getAnalysisToken(g.helper);if(!z||!t){return}var l=this._dragActionArray.length;if(l>0){var h=this._dragActionArray[l-1];if(h.zoneName!==z.name){return}}var i=R.parseDOM($(this._targetDiv));var p=new R(e.pageX,e.pageY,0,0);if(!i.contains(p)){return}var j=t.analysisObject;if(this._acceptable(z,j)){t.currentAction(d.ACCEPT);this._dispatchEvent(new E(f.DROP_ITEM_EVENT,this,{'zone':z,'analysisObject':j}))}else{t.currentAction(d.DENY)}t.dropTarget(this._dom)};f.prototype._isTriggerAllowed=function(e){var g=e.hasClass(D.DRAGGABLE_CLASS_ANALYSIS);g=g&&!e.hasClass(C.FEEDINGSHELF_PREFIX+'card');return g};f.prototype._createDiv=function(p,g,t,r){var h=$(document.createElement("DIV"));var l=g[0][0],i=g[0][1],w=g[2][0]-g[0][0],j=g[2][1]-g[0][1];var s="visibility:hidden;left:"+l+"px;top:"+i+"px;width:"+w+"px;height:"+j+"px;";var k=this;h.attr('style',s).droppable({tolerance:'pointer',accept:$.proxy(function(e){return this._isTriggerAllowed(e)===true},this),drop:function(e,q){k._onDragDrop.apply(k,[e,q])},over:function(e,q){k._onDragOver.apply(k,[e,q])},out:function(e,q){k._onDragOut.apply(k,[e,q])}});h.addClass(C.CHART_PREFIX+'drop-zone').appendTo(p);if(t&&t.length>0){s="position:absolute;left:0px;top: 0px;";var m=$(document.createElement("DIV")).attr('style',s).text(t).appendTo(h);var n=m[0].getBoundingClientRect();var o=null;if(r){o="translate("+(w-n.width)/2+"px,"+((n.width-n.height)/2+_)+"px) rotate(-90deg);"}else{o="translate("+_+"px, "+(j-n.height)/2+"px);"}s+="transform: "+o;s+="-webkit-transform: "+o;s+="-ms-transform: "+o;s+="-moz-transform: "+o;m.attr('style',s)}return h};f.prototype.enterDrop=function(e,g){var t=D.instance().getAnalysisToken(g.helper);if(!t){return}if(this._enterDrop){return}this._enterDrop=true;this._targetRect=this._targetDiv.getBoundingClientRect();var s="position:absolute;left:0px;top:0px;width:"+this._targetRect.width+"px;height:"+this._targetRect.height+"px;";this._dom.empty().attr('style',s);var z=this._zoneProvider();if(!z){return}this._dragActionArray=[];for(var i=0;i<z.length;i++){var h=z[i].bound;for(var n=0;n<h.length;n++){var j=this._createDiv(this._dom[0],h[n],z[i].text,z[i].rotate);j[0].__zone=z[i];j[0].__areaIndex=n}}};f.prototype.exitDrop=function(){if(!this._enterDrop){return}this._dom.empty();this._dom.css('visibility','hidden');this._enterDrop=false};f.prototype.size=function(s){if(s){this._dom.css({width:s.width+"px",height:s.height+"px"})}};f.prototype._getDom=function(z,e){var g=this._dom.children();for(var i=0;i<g.length;i++){if(g[i].__zone===z&&g[i].__areaIndex===e){return g[i]}}return null};f.prototype._hightlight=function(z,e){var g=this._getDom(z,e);if(g){$(g).css('visibility','')}};f.prototype._unHightlight=function(z,e){var g=this._getDom(z,e);if(g){$(g).css('visibility','hidden')}};return f});define('sap/viz/controls/chart/morph/constant/MorphConst',[],function(){var M={};M.SHAPE_DATA="data";M.SHAPE_GLOBAL_TRANSLATE_X="translateX";M.SHAPE_GLOBAL_TRANSLATE_Y="translateY";M.MORPHER_DISABLE_COLOR="MORPHER_DISABLE_COLOR";M.MORPHER_DISABLE_LINE="MORPHER_DISABLE_LINE";M.MORPHER_DISABLE_PATH="MORPHER_DISABLE_PATH";M.MORPHER_DISABLE_RECT="MORPHER_DISABLE_RECT";M.MORPHER_DISABLE_TEXT="MORPHER_DISABLE_TEXT";M.MORPHER_DISABLE_TRANSFORM="MORPHER_DISABLE_TRANSFORM";M.CHART_TYPE_COLUMN="viz/column";M.CHART_TYPE_STACKED_COLUMN="viz/stacked_column";M.CHART_TYPE_100_STACKED_COLUMN="viz/100_stacked_column";M.CHART_TYPE_DUAL_COLUMN="viz/dual_column";M.CHART_TYPE_3D_COLUMN="viz/3d_column";M.CHART_TYPE_BAR="viz/bar";M.CHART_TYPE_STACKED_BAR="viz/stacked_bar";M.CHART_TYPE_100_STACKED_BAR="viz/100_stacked_bar";M.CHART_TYPE_DUAL_BAR="viz/dual_bar";M.CHART_TYPE_3D_BAR="viz/3d_bar";M.CHART_TYPE_LINE="viz/line";M.CHART_TYPE_HORIZONTAL_LINE="viz/horizontal_line";M.CHART_TYPE_DUAL_LINE="viz/dual_line";M.CHART_TYPE_DUAL_HORIZONTAL_LINE="viz/dual_horizontal_line";M.CHART_TYPE_AREA="viz/area";M.CHART_TYPE_HORIZONTAL_AREA="viz/horizontal_area";M.CHART_TYPE_100_AREA="viz/100_area";M.CHART_TYPE_100_HORIZONTAL_AREA="viz/100_horizontal_area";M.CHART_TYPE_COMBINATION="viz/combination";M.CHART_TYPE_HORIZONTAL_COMBINATION="viz/horizontal_combination";M.CHART_TYPE_DUAL_COMBINATION="viz/dual_combination";M.CHART_TYPE_DUAL_HORIZONTAL_COMBINATION="viz/dual_horizontal_combination";M.CHART_TYPE_BOXPLOT="viz/boxplot";M.CHART_TYPE_HORIZONTAL_BOXPLOT="viz/horizontal_boxplot";M.CHART_TYPE_WATERFALL="viz/waterfall";M.CHART_TYPE_HORIZONTAL_WATERFALL="viz/horizontal_waterfall";M.CHART_TYPE_PIE="viz/pie";M.CHART_TYPE_DONUT="viz/donut";M.CHART_TYPE_PIE_WITH_DEPTH="viz/pie_with_depth";M.CHART_TYPE_SCATTER="viz/scatter";M.CHART_TYPE_BUBBLE="viz/bubble";M.CHART_TYPE_SCATTER_MATRIX="viz/scatter_matrix";M.CHART_TYPE_GEO_BUBBLE="viz/geobubble";M.CHART_TYPE_GEO_CHOROPLETH="viz/choropleth";M.CHART_TYPE_GEO_PIE="viz/geopie";M.CHART_TYPE_HEATMAP="viz/heatmap";M.CHART_TYPE_TREEMAP="viz/treemap";M.CHART_TYPE_TABLE="viz/table";M.CHART_TYPE_RADAR="viz/radar";M.CHART_TYPE_TAG_CLOUD="viz/tagcloud";var _={};var m=function(t,h){_[t]=h};m(M.CHART_TYPE_COLUMN,M.CHART_TYPE_BAR);m(M.CHART_TYPE_STACKED_COLUMN,M.CHART_TYPE_STACKED_BAR);m(M.CHART_TYPE_100_STACKED_COLUMN,M.CHART_TYPE_100_STACKED_BAR);m(M.CHART_TYPE_DUAL_COLUMN,M.CHART_TYPE_DUAL_BAR);m(M.CHART_TYPE_3D_COLUMN,M.CHART_TYPE_3D_BAR);m(M.CHART_TYPE_LINE,M.CHART_TYPE_HORIZONTAL_LINE);m(M.CHART_TYPE_DUAL_LINE,M.CHART_TYPE_DUAL_HORIZONTAL_LINE);m(M.CHART_TYPE_AREA,M.CHART_TYPE_HORIZONTAL_AREA);m(M.CHART_TYPE_100_AREA,M.CHART_TYPE_100_HORIZONTAL_AREA);m(M.CHART_TYPE_COMBINATION,M.CHART_TYPE_HORIZONTAL_COMBINATION);m(M.CHART_TYPE_DUAL_COMBINATION,M.CHART_TYPE_DUAL_HORIZONTAL_COMBINATION);m(M.CHART_TYPE_BOXPLOT,M.CHART_TYPE_HORIZONTAL_BOXPLOT);m(M.CHART_TYPE_WATERFALL,M.CHART_TYPE_HORIZONTAL_WATERFALL);M.IS_V_H_MAP=function(t,a){if(_[t]&&_[t]===a){return true}if(_[a]&&_[a]===t){return true}return false};return M});define('sap/viz/controls/chart/morph/utils/Utils',[],function(){var u={};var _=0;u.genUID=function(){if(!_){_=0}return"mgen_"+(_++)};var c={'[object Boolean]':'boolean','[object Number]':'number','[object String]':'string','[object Function]':'function','[object Array]':'array','[object Date]':'date','[object RegExp]':'regexp','[object Object]':'object'};u.type=function(o){return!o?String(o):c[Object.prototype.toString.call(o)]||"object"};u.isFunction=function(o){return u.type(o)==="function"};u.isBoolean=function(o){return u.type(o)==="boolean"};u.isString=function(o){return u.type(o)==="string"};u.isArray=function(o){return u.type(o)==="array"};u.isNumber=function(o){return u.type(o)==="number"};u.isRegExp=function(o){return u.type(o)==="regexp"};u.sortArrayOn=function(d,p,e){if(u.isArray(d)&&u.isString(p)){d.sort(function(a,b){return e?(a[p]<b[p])-(a[p]>b[p]):(a[p]>b[p])-(a[p]<b[p])})}};u.noop=function(){};return u});define('sap/viz/controls/chart/morph/utils/SVGShapeMetadata',[],function(){var S={};var a="__vizmp__";S.set=function(s,n,v){if(!s[a]){s[a]={}}s[a][n]=v};S.get=function(s,n){if(s&&s[a]!==null&&s[a]!==undefined){return s[a][n]}return undefined};S.clone=function(n,o){n[a]=o[a];return n};return S});define('sap/viz/controls/chart/morph/vo/VizShape',[],function(){var V=function(f,t,d){this.from=f;this.to=t;this.display=d};return V});define('sap/viz/controls/chart/morph/vo/VizShapesHolder',[],function(){var V=function(){this.plotShapes=[];this.plotLines=[];this.xAxisLabels=[];this.xAxis2Labels=[];this.yAxisLabels=[];this.yAxis2Labels=[];this.backgrounds=[]};V.prototype.empty=function(){this.plotShapes=[];this.plotLines=[];this.xAxisLabels=[];this.xAxis2Labels=[];this.yAxisLabels=[];this.yAxis2Labels=[];this.backgrounds=[]};V.prototype.allByOrder=function(){return[].concat(this.backgrounds,this.xAxis2Labels,this.xAxisLabels,this.yAxis2Labels,this.yAxisLabels,this.plotLines,this.plotShapes)};V.prototype.toShapesBySvgType=function(){var a={};var b=[];a["all"]=b;var c=this.allByOrder();for(var i=0;i<c.length;i++){var v=c[i];if(v.to){var t=v.to.localName;var d=a[t];if(!d){a[t]=d=[]}d.push(v);b.push(v)}}return a};return V});define('sap/viz/controls/chart/morph/viz/MpShapesCapturer',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/vo/VizShape','sap/viz/controls/chart/morph/vo/VizShapesHolder'],function(M,S,V,a){var b={};b.getShapes=function(v){var d=new a();var g=d3.select(v).select(".v-m-root");var h=d3.select(v).select(".v-m-main");if(g.node()&&h.node()&&g.node().getScreenCTM!==undefined&&h.node().getScreenCTM!==undefined){var j=p(g);var k=g.node().getScreenCTM();d.plotShapes=c(h,".v-m-plot .v-morphable-datapoint",k,j);d.plotLines=c(h,".v-m-plot .v-morphable-line, "+".v-m-plot .v-morphable-areabg",k,j);d.xAxisLabels=c(h,".v-m-xAxis .v-morphable-label",k);d.xAxis2Labels=c(h,".v-m-xAxis2 .v-morphable-label",k);d.yAxisLabels=c(h,".v-m-yAxis .v-morphable-label",k);d.yAxis2Labels=c(h,".v-m-yAxis2 .v-morphable-label",k);d.backgrounds=c(g,".v-m-background .v-morphable-background",k);for(var i=0;i<d.backgrounds.length;i++){var l=d.backgrounds[i];S.set(l.to,M.MORPHER_DISABLE_RECT,true)}}return d};var c=function(g,s,o,v){var h=g.selectAll(s);var j=[];h.each(function(d,i){if(this.localName==="path"&&String(this.getAttribute("class")).indexOf("v-geo-choropleth-feature")>=0){return}var k=this.cloneNode(true);S.set(k,M.SHAPE_DATA,this.__data__);f(k,this,v);e(this,o,k);j.push(new V(null,k,null))});return j};var p=function(v){var g={};var h=false;var d=v.selectAll("defs");d.each(function(){var j=this;if(j.firstChild){var k=j.childNodes;for(var i=0;i<k.length;i++){var l=k[i];if(l){var m="";var s=[];var n="#000000";if(l.localName==="linearGradient"){m=l.getAttribute("id");s=l.childNodes;if(s.length===2){n=s[1].getAttribute("stop-color")}else if(s.length===4){n=s[3].getAttribute("stop-color")}else{n=s[s.length-1].getAttribute("stop-color")}g[m]=n;h=true}else if(l.localName==="radialGradient"){m=l.getAttribute("id");s=l.childNodes;if(s.length===3){n=s[1].getAttribute("stop-color")}else if(s.length===4){n=s[3].getAttribute("stop-color")}else{n=s[s.length-1].getAttribute("stop-color")}g[m]=n;h=true}}}}});if(h){g["__hasGradientColor"]=true}return g};var e=function(o,d,n){var g=o.getScreenCTM();var l=g.e-d.e;var t=g.f-d.f;n.setAttribute("transform","translate("+l+","+t+")");S.set(n,M.SHAPE_GLOBAL_TRANSLATE_X,l);S.set(n,M.SHAPE_GLOBAL_TRANSLATE_Y,t);return n};var f=function(s,o,v){if(s.localName==="path"&&s.getAttribute("class")&&s.getAttribute("class").indexOf("v-morphable-line")>=0){s.setAttribute("fill-opacity",0)}if(s.localName==="path"&&s.getAttribute("class")&&s.getAttribute("class").indexOf("v-morphable-datapoint")>=0&&s.getAttribute("visibility")==="hidden"){s.setAttribute("visibility","");s.setAttribute("d","M0,0L0,0Z")}if(o.localName==="rect"&&o.getAttribute("opacity")==="0"&&o.parentNode&&o.parentNode.parentNode&&o.parentNode.parentNode.getAttribute("class")&&o.parentNode.parentNode.getAttribute("class").indexOf("v-heatmap")>=0){s.setAttribute("opacity",1)}if(v&&v["__hasGradientColor"]===true&&o.getAttribute("fill")&&o.getAttribute("fill").indexOf("url(#")===0){var g=o.getAttribute("fill");g=g.substring(5,g.length-1);var d=v[g];d=d?d:"#000000";s.setAttribute("fill",d)}};return b});define('sap/viz/controls/chart/morph/utils/SVGShapeReplacer',['sap/viz/controls/chart/morph/utils/SVGShapeMetadata'],function(S){var a={};var b="http://www.w3.org/2000/svg";var c=["x","y","width","height","rx","ry","x1","x2","y1","y2"];var g=function(s,d){var r=parseFloat(s.getAttribute(d));return isNaN(r)?0:r};a.replace=function(s,n,d,k){if(s&&n){var e=document.createElementNS(b,n);if(k){var o=s.attributes;for(var i=0;i<o.length;i++){var f=o[i];if(c.indexOf(f.localName)===-1){e.setAttribute(f.localName,f.value)}}}for(var h in d){if(d.hasOwnProperty(h)){e.setAttribute(h,d[h])}}S.clone(e,s);if(s.parentNode){s.parentNode.replaceChild(e,s)}return e}return null};a.replaceToPath=function(s){if(s){var p=null;switch(s.localName){case"rect":var x=g(s,"x");var y=g(s,"y");var w=g(s,"width");var h=g(s,"height");var r=g(s,"rx");var d=g(s,"ry");p="M"+x+","+y+"L"+(w+x)+","+y+"L"+(w+x)+","+(h+y)+"L"+x+","+(h+y)+"L"+x+","+y+"Z";break;case"line":var e=g(s,"x1");var f=g(s,"y1");var i=g(s,"x2");var j=g(s,"y2");p="M"+e+","+f+"L"+i+","+j;break;default:}if(p){var k={d:p};return a.replace(s,"path",k,true)}}return null};return a});define('sap/viz/controls/chart/morph/viz/MpShapesMapper',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/utils/SVGShapeReplacer','sap/viz/controls/chart/morph/vo/VizShape'],function(M,u,S,a,V){var b={};b.map=function(n,f,g,h){m(n.plotShapes,f.plotShapes,c);m(n.plotLines,f.plotLines,c);if(M.IS_V_H_MAP(g,h)){m(n.xAxisLabels,f.yAxisLabels,c);m(n.xAxis2Labels,f.yAxis2Labels,c);m(n.yAxisLabels,f.xAxisLabels,c);m(n.yAxis2Labels,f.xAxis2Labels,c)}else{m(n.xAxisLabels,f.xAxisLabels,c);m(n.xAxis2Labels,f.xAxis2Labels,c);m(n.yAxisLabels,f.yAxisLabels,c);m(n.yAxis2Labels,f.yAxis2Labels,c)}m(n.backgrounds,f.backgrounds,e);return n};var c=function(f,t){if(t&&f&&S.get(t,M.SHAPE_DATA)&&S.get(f,M.SHAPE_DATA)&&S.get(f,M.SHAPE_DATA).ctx){var g=S.get(t,M.SHAPE_DATA).ctx;var h=S.get(f,M.SHAPE_DATA).ctx;if(u.isArray(g)){g=g[0]}if(u.isArray(h)){h=h[0]}if(g&&h){return d(g,h)}}if(t&&f&&u.isArray(S.get(t,M.SHAPE_DATA))&&u.isArray(S.get(f,M.SHAPE_DATA))){var j=S.get(t,M.SHAPE_DATA);var k=S.get(f,M.SHAPE_DATA);if(j.length==k.length&&j.length>0){for(var i=0;i<j.length;i++){if(!j[i]||!k[i]||d(j[i].ctx,k[i].ctx)===false){return false}}return true}}if(t&&f&&t.localName==="g"&&f.localName==="g"&&t.firstChild.localName==="text"&&f.firstChild.localName==="text"&&t.firstChild.textContent==f.firstChild.textContent){return true}return false};var d=function(f,g){if(!f&&!g){return true}if(!f||!g||f.type!==g.type||(!f.path||!g.path)||(f.path.dii_a1!=f.path.dii_a1)||(f.path.dii_a2!=f.path.dii_a2)||(f.path.mg!=f.path.mg)||(f.path.mi!=f.path.mi)){return false}return true};var e=function(f,t){if(t&&f&&t.localName==f.localName&&t.getAttribute("class")==f.getAttribute("class")){return true}};var m=function(n,f,g,h){var k=[];for(var i=0;i<n.length;i++){var l=n[i];for(var j=0;j<f.length;j++){var o=f[j];if(h||k.indexOf(o)===-1){if(g(l.to,o.display)){var p=r(l.to,o.display);l.to=p.newShape;l.from=p.currentShape;k.push(o);break}}}}};var r=function(n,f){var g={newShape:n,currentShape:f};var h;if(n.localName==="path"&&f.localName!=="path"){h=a.replaceToPath(f);if(h){g.currentShape=h}}if(n.localName!=="path"&&f.localName==="path"){h=a.replaceToPath(n);if(h){g.newShape=h}}return g};return b});define('sap/viz/controls/chart/morph/utils/Cache',[],function(){var C={};var r=function(a,b){for(var i=0,c=a.length;i<c;i++){if(a[i]===b){return a.push(a.splice(i,1)[0])}}};C.func=function(f,s,p){function n(){var a=Array.prototype.slice.call(arguments,0),b=a.join("\u2400"),c=n.cache=n.cache||{},d=n.count=n.count||[];if(c.hasOwnProperty(b)){r(d,b);return p?p(c[b]):c[b]}d.length>=1e3&&delete c[d.shift()];d.push(b);c[b]=f.apply(s,a);return p?p(c[b]):c[b]}return n};return C});define('sap/viz/controls/chart/morph/utils/ColorUtil',['sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/Cache'],function(u,C){var a={};var _=null;a.parse=function(c){if(!_){_=C.func(RGBColorStatic.parse)}return _(c)};a.numberToHexString=function(c){var r=((c&0xff0000)>>16).toString(16),g=((c&0x00ff00)>>8).toString(16),b=(c&0x0000ff).toString(16);var h="#"+((r.length===1)?"0"+r:r)+((g.length===1)?"0"+g:g)+((b.length===1)?"0"+b:b);return h};a.hexStringToNumber=function(h){if(!h){return 0}if(h.charAt(0)==='#'){h=h.substr(1)}var r=parseInt(h.substr(0,2),16),g=parseInt(h.substr(2,2),16),b=parseInt(h.substr(4,2),16);var c=(Math.max(0,Math.min(255,r))*65536)+(Math.max(0,Math.min(255,g))*256)+Math.max(0,Math.min(255,b));return c};a.numberToRGB=function(c){var r=(c&0xff0000)>>16,g=(c&0x00ff00)>>8,b=c&0x0000ff;return'rgb('+r+','+g+','+b+')'};a.numberToRGBA=function(c,d){var r=(c&0xff0000)>>16,g=(c&0x00ff00)>>8,b=c&0x0000ff;if(d===undefined||d<=0||d>1){d=1}return'rgba('+r+','+g+','+b+','+d+')'};a.RGBToNumber=function(r,g,b){var h=(Math.max(0,Math.min(255,r))*65536)+(Math.max(0,Math.min(255,g))*256)+Math.max(0,Math.min(255,b));return h};a.getColorMix=function(c,b,p){return a.getPercentageOfColor(c,1-p)+a.getPercentageOfColor(b,p)};a.getPercentageOfColor=function(b,p){p=Math.min(1,Math.max(0,p));var r=(b&0xff0000)>>16;var g=(b&0x00ff00)>>8;var c=b&0x0000ff;return(r*p)<<16|(g*p)<<8|(c*p)};a.adjustBrightness=function(c,d){var r=Math.max(Math.min(((c>>16)&0xFF)+d,255),0);var g=Math.max(Math.min(((c>>8)&0xFF)+d,255),0);var b=Math.max(Math.min((c&0xFF)+d,255),0);return(r<<16)|(g<<8)|b};a.adjustBrightness2=function(c,d){var r=NaN;var g=NaN;var b=NaN;if(d==0){return c}if(d<0){d=(100+d)/100;r=((c>>16)&0xFF)*d;g=((c>>8)&0xFF)*d;b=(c&0xFF)*d}else{d/=100;r=((c>>16)&0xFF);g=((c>>8)&0xFF);b=(c&0xFF);r+=((0xFF-r)*d);g+=((0xFF-g)*d);b+=((0xFF-b)*d);r=Math.min(r,255);g=Math.min(g,255);b=Math.min(b,255)}return(r<<16)|(g<<8)|b};a.rgbMultiply=function(r,b){var c=(r>>16)&0xFF;var g=(r>>8)&0xFF;var d=r&0xFF;var e=(b>>16)&0xFF;var f=(b>>8)&0xFF;var h=b&0xFF;return((c*e/255)<<16)|((g*f/255)<<8)|(d*h/255)};return a});define('sap/viz/controls/chart/morph/morphers/ColorMorpher',['sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/ColorUtil'],function(u,C){var a={};var g=function(s,b){var r=parseFloat(s.getAttribute(b));return isNaN(r)?1:r};a.getPercentage=function(f,t,p){p=p>100?100:p<0?0:p;var b=C.parse(f);var c=C.parse(t);if(b.length===0&&c.length===0){return""}if(b.length===0&&c.length===3){return"rgb("+c[0]+","+c[1]+","+c[2]+")"}if(b.length===3&&c.length===0){return""}return"rgb("+Math.round(b[0]+(c[0]-b[0])*p/100)+","+Math.round(b[1]+(c[1]-b[1])*p/100)+","+Math.round(b[2]+(c[2]-b[2])*p/100)+")"};a.svg=function(f,t,d,p){if(d&&t){var b=f?f.getAttribute("stroke"):"";var c=t.getAttribute("stroke");var e=f?f.getAttribute("fill"):"";var h=t.getAttribute("fill");if(b===c){d.setAttribute("stroke",c)}else{d.setAttribute("stroke",a.getPercentage(b,c,p))}if(e===h){d.setAttribute("fill",h)}else{d.setAttribute("fill",a.getPercentage(e,h,p))}var i;var j;if(f){var k=g(f,"fill-opacity");i=g(t,"fill-opacity");var l=g(f,"stroke-opacity");j=g(t,"stroke-opacity");if(k!=i){d.setAttribute("fill-opacity",k+(i-k)*p/100)}if(l!=j){d.setAttribute("stroke-opacity",l+(j-l)*p/100)}}else{if(t.getAttribute("fill-opacity")!==""){i=g(t,"fill-opacity");d.setAttribute("fill-opacity",0+(i-0)*p/100)}else{d.setAttribute("fill-opacity","")}if(t.getAttribute("stroke-opacity")!==""){j=g(t,"stroke-opacity");d.setAttribute("stroke-opacity",0+(j-0)*p/100)}else{d.setAttribute("stroke-opacity","")}}}};return a});define('sap/viz/controls/chart/morph/morphers/RectMorpher',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata'],function(M,S){var R={};R.NO_DEFAULT_DIRECTION=0;R.DEFAULT_DIRECTION_TO_NORTH=1;R.DEFAULT_DIRECTION_TO_SOUTH=2;R.DEFAULT_DIRECTION_TO_EAST=4;R.DEFAULT_DIRECTION_TO_WEST=8;R.getPercentageRect=function(f,t,p){return{w:f.w+(t.w-f.w)*p/100,h:f.h+(t.h-f.h)*p/100,x:f.x+(t.x-f.x)*p/100,y:f.y+(t.y-f.y)*p/100,r:f.r+(t.r-f.r)*p/100}};var g=function(s,b){var r=parseInt(s.getAttribute(b),10);return isNaN(r)?0:r};var a=function(s,b){var r=parseFloat(s.getAttribute(b));return isNaN(r)?0:r};R.svg=function(f,t,d,p,b){if(d&&t&&t.localName==="rect"){var c;var e;var h;var i;var j;var k;if(S.get(t,M.MORPHER_DISABLE_RECT)===true){c=a(t,"x");e=a(t,"rx");h=a(t,"y");i=a(t,"ry");j=a(t,"width");k=a(t,"height");var l=a(d,"x");var m=a(d,"rx");var n=a(d,"y");var o=a(d,"ry");var q=a(d,"width");var r=a(d,"height");if(c!==l){d.setAttribute("x",c)}if(e!==m){d.setAttribute("rx",e)}if(h!==n){d.setAttribute("y",h)}if(i!==o){d.setAttribute("ry",i)}if(j!==q){d.setAttribute("width",j)}if(k!==r){d.setAttribute("height",k)}}else if(f&&f.localName==="rect"){var s=a(f,"x");c=a(t,"x");var u=a(f,"rx");e=a(t,"rx");var v=a(f,"y");h=a(t,"y");var w=a(f,"ry");i=a(t,"ry");var x=a(f,"width");j=a(t,"width");var y=a(f,"height");k=a(t,"height");var z=(x>=1&&y>=1);var A=(j>=1&&k>=1);if(!z&&!A){p=100}d.setAttribute("x",s+(c-s)*p/100);d.setAttribute("y",v+(h-v)*p/100);d.setAttribute("rx",u+(e-u)*p/100);d.setAttribute("ry",w+(i-w)*p/100);d.setAttribute("width",x+(j-x)*p/100);d.setAttribute("height",y+(k-y)*p/100)}else if(!f){c=a(t,"x");e=a(t,"rx");h=a(t,"y");i=a(t,"ry");j=a(t,"width");k=a(t,"height");if(b==null||b<0){b=R.DEFAULT_DIRECTION_TO_NORTH|R.DEFAULT_DIRECTION_TO_WEST}if((b&R.DEFAULT_DIRECTION_TO_NORTH)&&(b&R.DEFAULT_DIRECTION_TO_SOUTH)){d.setAttribute("y",h+(k-0)*(100-p)/100/2);d.setAttribute("height",0+(k-0)*p/100)}else if(b&R.DEFAULT_DIRECTION_TO_NORTH){d.setAttribute("y",h+(k-0)*(100-p)/100);d.setAttribute("height",0+(k-0)*p/100)}else if(b&R.DEFAULT_DIRECTION_TO_SOUTH){d.setAttribute("y",h);d.setAttribute("height",0+(k-0)*p/100)}else{d.setAttribute("y",h);d.setAttribute("height",k)}if((b&R.DEFAULT_DIRECTION_TO_EAST)&&(b&R.DEFAULT_DIRECTION_TO_WEST)){d.setAttribute("x",c+(j-0)*(100-p)/100/2);d.setAttribute("width",0+(j-0)*p/100)}else if(b&R.DEFAULT_DIRECTION_TO_EAST){d.setAttribute("x",c+(j-0)*(100-p)/100);d.setAttribute("width",0+(j-0)*p/100)}else if(b&R.DEFAULT_DIRECTION_TO_WEST){d.setAttribute("x",c);d.setAttribute("width",0+(j-0)*p/100)}else{d.setAttribute("x",c);d.setAttribute("width",j)}}}};return R});define('sap/viz/controls/chart/morph/morphers/LineMorpher',[],function(){var L={};L.getPercentageLine=function(f,t,p){return{x:f.x+(t.x-f.x)*p/100,y:f.y+(t.y-f.y)*p/100,x2:f.x2+(t.x2-f.x2)*p/100,y2:f.y2+(t.y2-f.y2)*p/100}};var g=function(s,b){var r=parseInt(s.getAttribute(b),10);return isNaN(r)?0:r};var a=function(s,b){var r=parseFloat(s.getAttribute(b));return isNaN(r)?0:r};L.svg=function(f,t,d,p){if(d&&t&&t.localName==="line"){var b;var c;var e;var h;if(f&&f.localName==="rect"){var i=a(f,"x1");b=a(t,"x1");var j=a(f,"x2");c=a(t,"x2");var k=a(f,"y1");e=a(t,"y1");var l=a(f,"y2");h=a(t,"y2");d.setAttribute("x1",i+(b-i)*p/100);d.setAttribute("y1",k+(e-k)*p/100);d.setAttribute("x2",j+(c-j)*p/100);d.setAttribute("y2",l+(h-l)*p/100)}else if(!f){b=a(t,"x1");c=a(t,"x2");e=a(t,"y1");h=a(t,"y2");d.setAttribute("x1",b);d.setAttribute("y1",e);d.setAttribute("x2",0+(c-0)*p/100);d.setAttribute("y2",0+(h-0)*p/100)}}};return L});define('sap/viz/controls/chart/morph/morphers/PathMorpher',['sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/Cache','sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata'],function(u,C,M,S){var e="concat",f="apply",g="hasOwnProperty",s="split",l=String.prototype.toLowerCase,m=String.prototype.toUpperCase,n=parseFloat,o=parseInt,q=Math,v=q.max,w=q.min,A=q.abs,B=q.pow,P=q.PI,D="number",E="string",F="array",G="toString";var H=/,?([achlmqrstvxz]),?/gi,I=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,J=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig;var _=function(i){return i?i.join(",").replace(H,"$1"):this.join(",").replace(H,"$1")};var K=function(c,z){var d=[];for(var i=0,a=c.length;a-2*!z>i;i+=2){var p=[{x:+c[i-2],y:+c[i-1]},{x:+c[i],y:+c[i+1]},{x:+c[i+2],y:+c[i+3]},{x:+c[i+4],y:+c[i+5]}];if(z){if(!i){p[0]={x:+c[a-2],y:+c[a-1]}}else if(a-4===i){p[3]={x:+c[0],y:+c[1]}}else if(a-2===i){p[2]={x:+c[0],y:+c[1]};p[3]={x:+c[2],y:+c[3]}}}else{if(a-4===i){p[3]=p[2]}else if(!i){p[0]={x:+c[i],y:+c[i+1]}}}d.push(["C",(-p[0].x+6*p[1].x+p[2].x)/6,(-p[0].y+6*p[1].y+p[2].y)/6,(p[1].x+6*p[2].x-p[3].x)/6,(p[1].y+6*p[2].y-p[3].y)/6,p[2].x,p[2].y])}return d};var L=function(p){if(!p){return null}var d={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},h=[];if(!h.length){String(p).replace(I,function(a,b,c){var i=[],j=b.toLowerCase();c.replace(J,function(a,b){b&&i.push(+b)});if(j==="m"&&i.length>2){h.push([b][e](i.splice(0,2)));j="l";b=b==="m"?"l":"L"}if(j==="r"){h.push([b][e](i))}else{while(i.length>=d[j]){h.push([b][e](i.splice(0,d[j])));if(!d[j]){break}}}})}h.toString=_;return h};var N=function(p){if(!u.isArray(p)||!u.isArray(p&&p[0])){p=L(p)}if(!p||!p.length){return[["M",0,0]]}var a=[],x=0,y=0,b=0,c=0,d=0;if(p[0][0]==="M"){x=+p[0][1];y=+p[0][2];b=x;c=y;d++;a[0]=["M",x,y]}var h=p.length===3&&p[0][0]==="M"&&p[1][0].toUpperCase()==="R"&&p[2][0].toUpperCase()==="Z";for(var r,t,i=d,z=p.length;i<z;i++){a.push(r=[]);t=p[i];if(t[0]!=m.call(t[0])){r[0]=m.call(t[0]);switch(r[0]){case"A":r[1]=t[1];r[2]=t[2];r[3]=t[3];r[4]=t[4];r[5]=t[5];r[6]=+(t[6]+x);r[7]=+(t[7]+y);break;case"V":r[1]=+t[1]+y;break;case"H":r[1]=+t[1]+x;break;case"R":var X=[x,y][e](t.slice(1));for(var j=2,Y=X.length;j<Y;j++){X[j]=+X[j]+x;X[++j]=+X[j]+y}a.pop();a=a[e](K(X,h));break;case"M":b=+t[1]+x;c=+t[2]+y;break;default:for(j=1,Y=t.length;j<Y;j++){r[j]=+t[j]+((j%2)?x:y)}}}else if(t[0]==="R"){X=[x,y][e](t.slice(1));a.pop();a=a[e](K(X,h));r=["R"][e](t.slice(-2))}else{for(var k=0,Z=t.length;k<Z;k++){r[k]=t[k]}}switch(r[0]){case"Z":x=b;y=c;break;case"H":x=r[1];break;case"V":y=r[1];break;case"M":b=r[r.length-2];c=r[r.length-1];break;default:x=r[r.length-2];y=r[r.length-1]}}a.toString=_;return a};var O=function(x,y,a,b){return[x,y,a,b,a,b]};var Q=function(x,y,a,b,c,d){var h=1/3,i=2/3;return[h*x+i*a,h*y+i*b,h*c+i*a,h*d+i*b,c,d]};var R=function(a,b,r,c,d,j,p,z,Z,$){var a1=P*120/180,b1=P/180*(+d||0),d1=[],xy,g1=C.func(function(x,y,b1){var X=x*q.cos(b1)-y*q.sin(b1),Y=x*q.sin(b1)+y*q.cos(b1);return{x:X,y:Y}});if(!$){xy=g1(a,b,-b1);a=xy.x;b=xy.y;xy=g1(z,Z,-b1);z=xy.x;Z=xy.y;var h1=q.cos(P/180*d),i1=q.sin(P/180*d),x=(a-z)/2,y=(b-Z)/2;var h=(x*x)/(r*r)+(y*y)/(c*c);if(h>1){h=q.sqrt(h);r=h*r;c=h*c}var j1=r*r,k1=c*c,k=(j==p?-1:1)*q.sqrt(A((j1*k1-j1*y*y-k1*x*x)/(j1*y*y+k1*x*x))),cx=k*r*y/c+(a+z)/2,cy=k*-c*x/r+(b+Z)/2,f1=q.asin(((b-cy)/c).toFixed(9)),f2=q.asin(((Z-cy)/c).toFixed(9));f1=a<cx?P-f1:f1;f2=z<cx?P-f2:f2;f1<0&&(f1=P*2+f1);f2<0&&(f2=P*2+f2);if(p&&f1>f2){f1=f1-P*2}if(!p&&f2>f1){f2=f2-P*2}}else{f1=$[0];f2=$[1];cx=$[2];cy=$[3]}var df=f2-f1;if(A(df)>a1){var q1=f2,r1=z,t1=Z;f2=f1+a1*(p&&f2>f1?1:-1);z=cx+r*q.cos(f2);Z=cy+c*q.sin(f2);d1=R(z,Z,r,c,d,0,p,r1,t1,[f2,q1,cx,cy])}df=f2-f1;var c1=q.cos(f1),s1=q.sin(f1),c2=q.cos(f2),s2=q.sin(f2),t=q.tan(df/4),hx=4/3*r*t,hy=4/3*c*t,m1=[a,b],m2=[a+hx*s1,b-hy*c1],m3=[z+hx*s2,Z-hy*c2],m4=[z,Z];m2[0]=2*m1[0]-m2[0];m2[1]=2*m1[1]-m2[1];if($){return[m2,m3,m4][e](d1)}else{d1=[m2,m3,m4][e](d1).join()[s](",");var E1=[];for(var i=0,ii=d1.length;i<ii;i++){E1[i]=i%2?g1(d1[i-1],d1[i],b1).y:g1(d1[i],d1[i+1],b1).x}return E1}};var T=function(a,b){var p=N(a),c=b&&N(b),h={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},j={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},k=function(a,d){var Z,$;if(!a){return["C",d.x,d.y,d.x,d.y,d.x,d.y]}!(a[0]in{T:1,Q:1})&&(d.qx=d.qy=null);switch(a[0]){case"M":d.X=a[1];d.Y=a[2];break;case"A":a=["C"][e](R[f](0,[d.x,d.y][e](a.slice(1))));break;case"S":Z=d.x+(d.x-(d.bx||d.x));$=d.y+(d.y-(d.by||d.y));a=["C",Z,$][e](a.slice(1));break;case"T":d.qx=d.x+(d.x-(d.qx||d.x));d.qy=d.y+(d.y-(d.qy||d.y));a=["C"][e](Q(d.x,d.y,d.qx,d.qy,a[1],a[2]));break;case"Q":d.qx=a[1];d.qy=a[2];a=["C"][e](Q(d.x,d.y,a[1],a[2],a[3],a[4]));break;case"L":a=["C"][e](O(d.x,d.y,a[1],a[2]));break;case"H":a=["C"][e](O(d.x,d.y,a[1],d.y));break;case"V":a=["C"][e](O(d.x,d.y,d.x,a[1]));break;case"Z":a=["C"][e](O(d.x,d.y,d.X,d.Y));break}return a},r=function(d,i){if(d[i].length>7){d[i].shift();var Z=d[i];while(Z.length){d.splice(i++,0,["C"][e](Z.splice(0,6)))}d.splice(i,1);x=v(p.length,c&&c.length||0)}},t=function(d,b,Z,$,i){if(d&&b&&d[i][0]==="M"&&b[i][0]!=="M"){b.splice(i,0,["M",$.x,$.y]);Z.bx=0;Z.by=0;Z.x=d[i][1];Z.y=d[i][2];x=v(p.length,c&&c.length||0)}};for(var i=0,x=v(p.length,c&&c.length||0);i<x;i++){p[i]=k(p[i],h);r(p,i);c&&(c[i]=k(c[i],j));c&&r(c,i);t(p,c,h,j,i);t(c,p,j,h,i);var y=p[i],z=c&&c[i],X=y.length,Y=c&&z.length;h.x=y[X-2];h.y=y[X-1];h.bx=n(y[X-4])||h.x;h.by=n(y[X-3])||h.y;j.bx=c&&(n(z[Y-4])||j.x);j.by=c&&(n(z[Y-3])||j.y);j.x=c&&z[Y-2];j.y=c&&z[Y-1]}return c?[p,c]:p};var U=null;var V=function(p,a){if(!U){U=C.func(T)}return U(p,a)};var W={};W.getPercentagePath=function(a,t,p){if(!a||!t){return""}var c=V(String(a),String(t));var b=c[0];var d=c[1];var h=[];for(var i=0,k=b.length;i<k;i++){h[i]=[b[i][0]];for(var j=1,r=b[i].length;j<r;j++){h[i][j]=b[i][j]+(d[i][j]-b[i][j])*p/100}}return _(h)};W.svg=function(a,t,d,p){if(d&&t&&t.localName=="path"&&(!a||a.localName=="path")){var b=t.getAttribute("d");if(b&&b.length>1){var c;if(S.get(t,M.MORPHER_DISABLE_PATH)===true){c=d.getAttribute("d");if(b!==c){d.setAttribute("d",b)}}else{var h="";if(a){h=a.getAttribute("d")}if(!h){var i=b.match(I);if(i.length>0){h=i[0]}else{h="M0,0"}}c=W.getPercentagePath(h,b,p);d.setAttribute("d",c)}}}};return W});define('sap/viz/controls/chart/morph/utils/TransformParser',[],function(){var T={};var t=function(s){return s.replace(/^\s*/,"").replace(/\s*$/,"")};T.parse=function(a){var r=[];var b=[];var s=[];if(a){var c;if(a.indexOf("rotate(")>=0){var d=a.substring(a.indexOf("rotate("));d=d.substring("rotate(".length,d.indexOf(")"));d=t(d);var e=[];if(d.indexOf(",")>0){e=d.split(",")}else{e=d.split(" ")}for(var i=0;i<e.length&&r.length<3;i++){c=t(e[i]);if(c!==""){c=parseFloat(c);if(isNaN(c)){c=0}r.push(c)}}if(r.length<3){r[1]=0;r[2]=0}}if(a.indexOf("translate(")>=0){var f=a.substring(a.indexOf("translate("));f=f.substring("translate(".length,f.indexOf(")"));f=t(f);var g=[];if(f.indexOf(",")>0){g=f.split(",")}else{g=f.split(" ")}for(var j=0;j<g.length&&b.length<2;j++){c=t(g[j]);if(c!==""){c=parseFloat(c);if(isNaN(c)){c=0}b.push(c)}}if(b.length<2){b[1]=0}}if(a.indexOf("scale(")>=0){var h=a.substring(a.indexOf("scale("));h=h.substring("scale(".length,h.indexOf(")"));h=t(h);var l=[];if(h.indexOf(",")>0){l=h.split(",")}else{l=h.split(" ")}for(var k=0;k<l.length&&s.length<2;k++){c=t(l[k]);if(c!==""){c=parseFloat(c);if(isNaN(c)){c=0}s.push(c)}}if(s.length<2){s[1]=0}}}return{rotate:r.length>0?r:null,translate:b.length>0?b:null,scale:s.length>0?s:null}};return T});define('sap/viz/controls/chart/morph/morphers/TransformMorpher',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/utils/TransformParser'],function(M,S,T){var a={};a.applyTransform=function(f,b,t,c,p){var x=f+(t-f)*p/100;var y=b+(c-b)*p/100;return"translate("+x+","+y+")"};a.svg=function(f,t,d,p,u){if(d&&t){var c="";if(f){var b=T.parse(f.getAttribute("transform"));var e=T.parse(t.getAttribute("transform"));if(u){if(b.translate||e.translate){if(!b.translate){b.translate=[0,0]}if(!e.translate){e.translate=[0,0]}c+=(c?" ":"")+"translate("+(b.translate[0]+(e.translate[0]-b.translate[0])*p/100)+","+(b.translate[1]+(e.translate[1]-b.translate[1])*p/100)+")"}}else{var g=S.get(f,M.SHAPE_GLOBAL_TRANSLATE_X)||0;var h=S.get(f,M.SHAPE_GLOBAL_TRANSLATE_Y)||0;var i=S.get(t,M.SHAPE_GLOBAL_TRANSLATE_X)||0;var j=S.get(t,M.SHAPE_GLOBAL_TRANSLATE_Y)||0;var k=g+(i-g)*p/100;var l=h+(j-h)*p/100;c+=(c?" ":"")+"translate("+k+","+l+")"}if(b.rotate||e.rotate){if(!b.rotate){b.rotate=[0,0,0]}if(!e.rotate){e.rotate=[0,0,0]}c+=(c?" ":"")+"rotate("+(b.rotate[0]+(e.rotate[0]-b.rotate[0])*p/100)+","+(b.rotate[1]+(e.rotate[1]-b.rotate[1])*p/100)+","+(b.rotate[2]+(e.rotate[2]-b.rotate[2])*p/100)+")"}if(b.scale||e.scale){if(!b.scale){b.scale=[0,0]}if(!e.scale){e.scale=[0,0]}c+=(c?" ":"")+"scale("+(b.scale[0]+(e.scale[0]-b.scale[0])*p/100)+","+(b.scale[1]+(e.scale[1]-b.scale[1])*p/100)+")"}d.setAttribute("transform",c)}}};return a});define('sap/viz/controls/chart/morph/morphers/TextMorpher',['sap/viz/controls/chart/morph/morphers/TransformMorpher'],function(T){var a={};var g=function(s,d){var e=parseInt(s.getAttribute(d),10);return isNaN(e)?0:e};var b=function(s,d){var e=parseFloat(s.getAttribute(d));return isNaN(e)?0:e};var r=/(\d+)(in|cm|mm|pt|pc|em|ex|px)/i;var c=function(f,t,p){var d=r.exec(f);if(!d){d=[f,f,""]}var e=parseInt(d[1],10);var h=d[2];var i=r.exec(t);if(!i){i=[t,t,""]}var j=parseInt(i[1],10);var k=i[2];var l=e;switch(h){case"pt":l=l*1.33;break;case"px":l=l;break;default:l=l}switch(k){case"pt":l=l/1.33;break;case"px":l=l;break;default:l=l}return String(Math.round(l+(j-l)*p/100))+k};a.svg=function(f,t,d,p){if(d&&t.localName==="g"&&t.firstChild&&t.firstChild.localName==="text"){if(f&&f.localName==="g"&&f.firstChild&&f.firstChild.localName==="text"){var e=b(f.firstChild,"x");var h=b(t.firstChild,"x");var i=b(f.firstChild,"y");var j=b(t.firstChild,"y");d.firstChild.setAttribute("x",e+(h-e)*p/100);d.firstChild.setAttribute("y",i+(j-i)*p/100);var k=f.getAttribute("font-size");var l=t.getAttribute("font-size");if(k&&l&&k!=l){var m=c(k,l,p);d.setAttribute("font-size",m)}T.svg(f.firstChild,t.firstChild,d.firstChild,p,true)}else if(!f){d.setAttribute("opacity",p/100)}}};return a});define('sap/viz/controls/chart/morph/VizMorpher',['jquery','sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/vo/VizShape','sap/viz/controls/chart/morph/vo/VizShapesHolder','sap/viz/controls/chart/morph/viz/MpShapesCapturer','sap/viz/controls/chart/morph/viz/MpShapesMapper','sap/viz/controls/chart/morph/morphers/ColorMorpher','sap/viz/controls/chart/morph/morphers/RectMorpher','sap/viz/controls/chart/morph/morphers/LineMorpher','sap/viz/controls/chart/morph/morphers/PathMorpher','sap/viz/controls/chart/morph/morphers/TextMorpher','sap/viz/controls/chart/morph/morphers/TransformMorpher'],function($,M,u,S,V,a,b,c,C,R,L,P,T,d){var e=function(v,i){this._vizDiv=v;this._morphDiv=i;this._currentVizType="";this._currentVizShapesHolder=new a();this._tween=null};e.prototype.resetMorphSvg=function(){var v=g(this._vizDiv);var i=v.width();var j=v.height();var k=g(this._morphDiv);k.empty();var l=g(document.createElement("DIV"));l.css("overflow","hidden").appendTo(k).width(i).height(j);var n=v.find("svg");if(n.length>0){l.attr("class","vc-morph-svg-host "+n.parent().attr("class"))}return d3.select(l.get(0)).append("svg").attr("width",i).attr("height",j).node()};e.prototype.getCurrentVizType=function(){return this._currentVizType};e.prototype.isPlaying=function(){return(this._tween!==null)};e.prototype.showMorphing=function(i,v){var j=g(this._morphDiv);var k=g(this._vizDiv);if(i){j.css("display","")}else{j.css("display","none")}if(v){k.css("visibility","visible")}else{k.css("visibility","hidden")}};e.prototype.morphVizType=function(n,i,j){i=u.isNumber(i)?i:1000;n=u.isString(n)?n:this.getCurrentVizType();var v=g(this._vizDiv);var k=g(this._morphDiv);if(this._tween){this._tween.stop(true,false);this._tween=null;v.css("visibility","visible");k.css("display","none")}var l=b.getShapes(v.get(0));var o=f(l);var s=(o&&i>0);if(o){c.map(l,this._currentVizShapesHolder,n,this._currentVizType);var q=l.allByOrder();var r=this.resetMorphSvg();if(s){v.css("visibility","hidden");k.css("display","");p(r,q,0);var t=this;this._startMorphShapes(q,i,function(){v.css("visibility","visible");k.css("display","none");if(t._tween){t._tween.stop(true,false)}t._tween=null;if(u.isFunction(j)){j.call(null)}})}else{p(r,q,100);this._tween=null;v.css("visibility","visible");k.css("display","none");if(u.isFunction(j)){j.call(null)}}}else{l.empty();this.resetMorphSvg();this._tween=null;v.css("visibility","visible");k.css("display","none");if(u.isFunction(j)){j.call(null)}}this._currentVizType=n;this._currentVizShapesHolder=l};var f=function(n){var t=n.toShapesBySvgType();if(t["all"].length>n.backgrounds.length){if(t["path"]&&t["path"].length>200){return false}if(t["rect"]&&t["rect"].length>300){return false}if(t["all"].length>400){return false}return true}return false};e.prototype._startMorphShapes=function(v,i,j){this._tween=$({percentage:1});this._tween.animate({percentage:100},{duration:i,easing:"swing",step:function(){var k=this.percentage;m(v,k)},complete:function(){j()}})};var g=function(i){if(u.isString(i)){if(i.indexOf("#")!==0){return $("#"+i)}}return $(i)};var p=function(s,v,j){j=j?j:0;for(var i=0;i<v.length;i++){var k=v[i];var l=k.from;var t=k.to;if(t){var n=k.display=t.cloneNode(true);S.clone(n,t);if(j!==100){h(l,t,n,j)}s.appendChild(n)}}};var m=function(v,j){for(var i=0;i<v.length;i++){var k=v[i];var l=k.from;var t=k.to;var n=k.display;h(l,t,n,j)}};var h=function(i,t,j,k){R.svg(i,t,j,k);L.svg(i,t,j,k);P.svg(i,t,j,k);C.svg(i,t,j,k);T.svg(i,t,j,k);d.svg(i,t,j,k)};e.prototype.testDrawShapes=function(n,i){var v=g(this._vizDiv);var j=g(this._morphDiv);var k=b.getShapes(v.get(0));c.map(k,this._currentVizShapesHolder,n,this._currentVizType);var l=k.allByOrder();var o=this.resetMorphSvg();p(o,l,i);this._currentVizType=n;this._currentVizShapesHolder=k};return e});define('sap/viz/controls/chart/views/PropertyZone',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher'],function($,C,O,E,a){var P=function(t,z){P.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.DropZone";this._targetDiv=t;this._zoneProvider=z;this._selectedZone$=null;var s="position:absolute;visibility:hidden;left:0px;top:0px;width:0px;height:0px;";this._dom=$(document.createElement("DIV")).appendTo(this._targetDiv.parentNode).attr('style',s)};O.extend(P,a);P.SELECT_ZONE='SELECT_ZONE_EVENT';P.prototype._createZones=function(){this._targetRect=this._targetDiv.getBoundingClientRect();var s="position:absolute;left:0px;top:0px;width:"+this._targetRect.width+"px;height:"+this._targetRect.height+"px;";this._dom.empty().attr('style',s);var z=this._zoneProvider();for(var i=0;i<z.length;i++){var b=z[i].bound;for(var n=0;n<b.length;n++){this._createZone(this._dom[0],b[n],z[i].name)}}};P.prototype._createZone=function(p,b,z){var d=$(document.createElement("DIV"));var l=b[0][0],t=b[0][1],w=b[2][0]-b[0][0],h=b[2][1]-b[0][1];var s="left:"+l+"px;top:"+t+"px;width:"+w+"px;height:"+h+"px;";d.attr('style',s).addClass(C.CHART_PREFIX+'property-zone').appendTo(p);d.get(0).__name=z;d.click($.proxy(this._selectZone,this))};P.prototype._selectZone=function(e){var c=$(e.target);if(this._selectedZone$!==c){if(this._selectedZone$){this._selectedZone$.removeClass(C.CHART_PREFIX+'property-zone-selected')}this._selectedZone$=c;this._selectedZone$.addClass(C.CHART_PREFIX+'property-zone-selected');var b={'propertyZoneName':this._selectedZone$.get(0).__name};this._dispatchEvent(new E(P.SELECT_ZONE,this,b))}};P.prototype.updateZone=function(e){if(e){this._createZones();this._dom.css('visibility','')}else{this._dom.css('visibility','hidden')}};P.prototype.size=function(s){if(s){this._dom.css({width:s.width+"px",height:s.height+"px"})}};return P});define('sap/viz/controls/chart/views/View',['jquery','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/UIControl','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/DropZone','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/ghost/IncompleteGhost','sap/viz/controls/common/feeds/FeedItem'],function($,G,C,M,F,L,O,u,a,T,V,b,U,c,D,d,I,f){var g=function(e,o,l,h){g.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.View";this._div=e;this._chartHolder$=null;this._chartLayer$=null;this._descriptionLayer$=null;this._loadingIcon$=null;this._chartModelProvider=h;this._options=o;this._libFolderPath=l;var i=sap.viz.api.env.Resource.path("sap.viz.geo.geographicInfo.localStorage.resourcePath");this._geoResourcePath=i?i:this._libFolderPath+"/sap.viz.geo/geocharts/resources/data/geo/";this._enableTrellis=true;this._enableMorphing=true;this._enablePropertyZone=false;this._hasChartInstance=false;this._size={width:g.DEFAULT_VIZ_WIDTH,height:g.DEFAULT_VIZ_HEIGHT};this._padding=24;this._chart=null;this._onEventMap={};this._isFeedsValid=false;this._templateId="default"};O.extend(g,U);g.DEFAULT_VIZ_WIDTH=380;g.DEFAULT_VIZ_HEIGHT=280;g.prototype._createChildren=function(){this._createChartHolder();this._createChartLayer();this._createDescriptionLayer();this._createLoadingIcon()};g.prototype._createChartHolder=function(){this._chartHolder$=$(document.createElement('div')).addClass([b.PREFIX+'chart-holder',b.COMMON_PREFIX+'scrollable'].join(' '));this._chartHolder$.appendTo($(this._div));this._chartHolder$.css({position:'relative'})};g.prototype._createChartLayer=function(){this._chartLayer$=$(document.createElement('div')).addClass(b.PREFIX+'chart-layer');this._chartLayer$.appendTo(this._chartHolder$);this._chartLayer$.css({position:'absolute'})};g.prototype._createDescriptionLayer=function(){this._descriptionLayer$=$(document.createElement('div')).addClass(b.PREFIX+"chart-description");this._descriptionLayer$.css({position:'absolute',});this._descriptionLayer$.appendTo(this._chartHolder$)};g.prototype._createLoadingIcon=function(){this._loadingIcon$=$(document.createElement('div')).addClass(b.CHART_PREFIX+"loading-icon");this._loadingIcon$.appendTo(this._chartHolder$);this._loadingIcon$.css({width:this._chartHolder$.width()+"px",height:this._chartHolder$.height()+"px"})};g.prototype._createDropZone=function(){var e=this._chartLayer$;this._dropZone=new D(e.get(0),$.proxy(this._getFeedingZone,this),$.proxy(this._dropZoneFeedValidator,this));this._dropZone.addEventListener(D.DROP_ITEM_EVENT,this._dropItemHandler,this)};g.prototype._getFeedingZone=function(){if(!this._chart){return[]}try{return this._chart.feedingZone()}catch(e){return[]}};g.prototype._dropZoneFeedValidator=function(e,h,z){var i=this._chartModelProvider().explicitFeedingItems();return F.canAddFeed(i,e,h,z)};g.prototype._dropItemHandler=function(e){this._dispatchEvent(new c(c.ANALYSIS_DROPPED,this,e.data))};g.DISPATCH_PROPERTY_EVENT='dispatchPropertyEvent';g.prototype.modelChanged=function(m,o){};g.prototype._getMinSize=function(){return this._size};g.prototype._setChartSize=function(w,h){if(this._chart){this._chart.size({width:w,height:h})}};g.prototype._updateChartSize=function(e){var m=this._getMinSize();var w=m.width;var h=m.height;var i={width:this._size.width+"px",height:this._size.height+"px",'overflow-x':m['overflow-x']||'','overflow-y':m['overflow-y']||''};if(e){this._setChartSize(w,h)}this._chartLayer$.css({width:w+"px",height:h+"px",visibility:"visible",display:''});this._chartHolder$.css(i);return m};g.prototype.updateDescription=function(e){this._destroyChartInstance();this._updateDescription(e,true)};g.prototype._updateDescription=function(e,i){if(arguments.length<=0){var v=this._options.type;var h=this._options.feeding;if(!this._enableTrellis&&a.isMultipleChart(v)){e=L.get('VIZ_CHART_TRELLIS_DISABLED_WARN')}else if(!this._isFeedsValid){e=this._getDescription(v,h)}}if(e){this._descriptionLayer$.show();this._descriptionLayer$.text(e);this._showDescription()}else{this._descriptionLayer$.hide();this._descriptionLayer$.text("");this._chartHolder$.css({'opacity':""})}this.hideLoadingIcon()};g.prototype._getDescription=function(t,e){var h=L.get("VIZ_CHART_INCOMPLETE_DESCRIPTION");if(!e){return h}var j=this._chartModelProvider().feedingItems();if(t.search('geo')>-1||t.search('choropleth')>-1){for(var i=0;i<j.length;i++){if(j[i].id()==="geoFeatures"&&j[i].values().length===0){h=L.get("VIZ_CHART_GEO_INCOMPLETE_DESCRIPTION")}}}return h};g.prototype._showDescription=function(){this._chartHolder$.css({'opacity':".3"});this._descriptionLayer$.css({width:this._size.width+"px",height:this._size.height/2+50+"px",color:"black",'font-size':"28px",'text-align':"center",'top':this._size.height/2-50+"px",'word-wrap':"break-word"})};g.prototype._destroyChartInstance=function(){if(this._chart){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:destroy_cvom_chart_instance');this._chart.destroy();this._chart=null;this._hasChartInstance=false;sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:destroy_cvom_chart_instance')}};g.prototype._updateDescriptionByOptions=function(o){if(V.isEmptyData(o.type,o.data)){var e=L.get('VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER');this._updateDescription(e);o.data=I.getDataset(o.type);this._chartLayer$.css('opacity','0')}else{this._updateDescription();this._updateChartSize(false);this._chartLayer$.css('opacity','')}};g.prototype._createChartInstance=function(){};g.prototype.getTemplateId=function(e){if(arguments.length>0){return this._templateId}else{return sap.viz.api.env.Template.get()}};g.prototype._getTemplateId=function(e){var t=sap.viz.api.env.Template.get();if(t!=="incomplete_ghost"&&t!=="empty_ghost"){this._templateId=t}this._isFeedsValid=!V.hasFakeData(e);t=this._isFeedsValid?this._templateId:"incomplete_ghost";return t};g.prototype.showLoadingIcon=function(){this._loadingIcon$.css({display:"block"})};g.prototype.hideLoadingIcon=function(){this._loadingIcon$.css({display:""})};g.prototype.hasChartInstance=function(){return this._hasChartInstance};g.prototype.size=function(s){if(arguments.length>0){this._size={width:s.width,height:s.height};this._updateChartSize(true);var e=this._descriptionLayer$;if(e!==null&&e.size()>0){e.css({width:this._size.width+"px",height:this._size.height/2+50+"px",'top':this._size.height/2-50+"px"})}this._loadingIcon$.css({width:this._size.width+"px",height:this._size.height+"px"});return this}return{width:this._size.width,height:this._size.height}};g.prototype.changeTemplate=function(){var t=sap.viz.api.env.Template.get();if(t!=="incomplete_ghost"&&t!=="empty_ghost"&&t!==this._templateId){this.create(this._options)}};g.prototype.create=function(o){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-create');if(o){this._options=o;this._requestMorphing=true;var t=this._getTemplateId(o.data);this.__templateId=t;var _=this;sap.viz.api.env.Template.set(t,function(){if(_.__templateId===t){_._createChartInstance()}});this._dispatchEvent(new c(c.CHANGED_SELECTED_DATA,this))}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-create')};g.prototype.destroy=function(){this.removeAllEventListeners();this._onEventMap={};if(this._chart){this._chart.destroy();this._chart=null}$(this._div).empty()};g.prototype.data=function(e){var h;try{if(arguments.length>0){this._options.data=e;if(this._chart){if(V.isEmptyData(this._options.type,this._options.data)){this._dispatchEvent(new c(c.CHART_CHANGING,this));this._dispatchEvent(new c(c.CHANGED_SELECTED_DATA,this));h=L.get('VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER');this._updateDescription(h);this._requestMorphing=false;this._options.data=I.getDataset(this._options.type);this._chartLayer$.css('opacity','0')}else{this._updateDescription();this._chartLayer$.css('opacity','')}this._chart.data(this._options.data);return this}else{h=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');this._updateDescription(h);throw h}}else{if(this._chart){return this._chart.data()}else{return this._options.data}}}catch(i){h=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+i;this._updateDescription(h);throw h}};g.prototype.feeding=function(e){if(arguments.length>0){this._options.feeding=e;return this}else{return this._options.feeding}};g.prototype.css=function(e){if(arguments.length>0){this._options.css=e;return this}else{return this._options.css}};g.prototype.properties=function(p){if(arguments.length>0){this._options.properties=p;return this}else{return this._options.properties}};g.prototype.update=function(e,h){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update');if(!e){return}if(!h){this._requestMorphing=true}if(e.css){this._options.css=e.css}if(e.feeding){this._options.feeding=e.feeding}if(e.data){this._options.data=e.data}if(e.properties){this._options.properties=e.properties}var i;try{if(this._chart){this._updateDescription();if(V.isEmptyData(this._options.type,this._options.data)){this._dispatchEvent(new c(c.CHART_CHANGING,this));this._dispatchEvent(new c(c.CHANGED_SELECTED_DATA,this));i=L.get('VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER');this._updateDescription(i);this._requestMorphing=false;e.data=I.getDataset(this._options.type);e.feeding=undefined;this._chartLayer$.css('opacity','0')}else{this._chartLayer$.css('opacity','')}this._updateChartSize(true);this._chart.update(e);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update');return this}else{i=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');this._updateDescription(i);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update');throw i}}catch(j){i=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+j;this._updateDescription(i);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update');throw i}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update')};g.prototype.on=function(e,h){try{if(this._chart){if(arguments.length>0){this._chart.on(e,h)}}this._onEventMap[e]=h;return this}catch(i){throw L.get('VIZ_CHART_ADD_EVENT_FAILED')+i}};g.prototype.off=function(e){try{if(this._chart){if(arguments.length>0){this._chart.off(e)}}delete this._onEventMap[e];return this}catch(h){throw L.get('VIZ_CHART_REMOVE_EVENT_FAILED')+h}};g.prototype.selection=function(p,o){try{if(this._chart){if(this._options.type===C.TYPE_TREE||this._options.type===C.TYPE_TABLE){return null}if(arguments.length>=2){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView_selection-set');this._chart.selection(p,o);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView_selection-set');return this}else if(arguments.length===1){if(u.isArray(arguments[0])){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView_selection-set');this._chart.selection(arguments[0]);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView_selection-set');return this}else{return this._chart.selection(arguments[0])}}else{return this._chart.selection()}}else{if(arguments.length>=2){throw L.get('VIZ_CHART_SELECTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}else if(arguments.length===1){if(u.isArray(arguments[0])){throw L.get('VIZ_CHART_SELECTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}else{return null}}else{return null}}}catch(e){throw L.get('VIZ_CHART_SELECTION_FAILED')+e}};g.prototype.feedingZone=function(){return[]};g.prototype.description=function(e){try{if(arguments.length>0){if(this._chart){this._chart.description(e);return this}else{throw L.get('VIZ_CHART_DESCRIPTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{if(this._chart){return this._chart.description()}else{return null}}}catch(h){throw L.get('VIZ_CHART_DESCRIPTION_FAILED')+h}};g.prototype.action=function(k,e){try{if(this._chart){if(arguments.length>0){return this._chart.action(k,e)}}else{throw L.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}catch(h){throw L.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+h}};g.prototype.exportViz=function(e){if(this._chart){var r=this._chart.toJSON({emptyDataset:!!e});if(r){r.properties=this._options.properties;r.css=this._options.css}return r}else{throw L.get('VIZ_CHART_SERIALIZE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};g.prototype.loadViz=function(v){this.create(v)};g.prototype.enableTrellis=function(v){if(arguments.length>0){this._enableTrellis=(v!==false);return this}else{return this._enableTrellis}};g.prototype.enableMorphing=function(v){if(arguments.length>0){this._enableMorphing=(v!==false);return this}else{return this._enableMorphing}};g.prototype.enablePropertyZone=function(v){if(arguments.length>0){if(this._enablePropertyZone!==v){this._enablePropertyZone=(v===true)}return this}else{return this._enablePropertyZone}};g.prototype.getTitleByFeeding=function(){return''};g.prototype.applyDefaultProperties=function(p,e){return p};g.prototype.copyData=function(t,e){return u.clone(e)};g.prototype.buildFeedings=function(t,e,h){return null};g.prototype.FeedsToJSON=function(e){return f.toJSON(e)};g.prototype.FeedsFromJSON=function(v){var e=f.fromJSON(v);return e};return g});define('sap/viz/controls/chart/views/ChartView',['jquery','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/DropZone','sap/viz/controls/chart/morph/VizMorpher','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/views/PropertyZone','sap/viz/controls/chart/views/View','sap/viz/controls/chart/ghost/IncompleteGhost','sap/viz/controls/common/feeds/AnalyticalType'],function($,G,C,M,F,L,O,u,a,T,V,b,c,D,d,f,P,g,I,A){var h=function(e,o,i,j){h.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.ChartView";this._morphingLayer$=null;this._supportMorphing=true;this._requestMorphing=false;this._vizMorpher=null;this._enablePropertyZone=false;this._createChildren();sap.viz.extapi.env.Template.addListener($.proxy(this.changeTemplate,this))};O.extend(h,g);h.prototype._createChildren=function(){this._createChartHolder();this._createChartLayer();this._morphingLayer$=$(document.createElement('div')).addClass(b.PREFIX+'morphing-layer');this._morphingLayer$.appendTo(this._chartHolder$);this._morphingLayer$.css({position:'absolute'});this._createDescriptionLayer();this._createLoadingIcon();this._createDropZone();var i=this._chartLayer$;this._propertyZone=new P(i.get(0),$.proxy(this._getPropertyZone,this));this._propertyZone.addEventListener(P.SELECT_ZONE,$.proxy(function(e){this._dispatchEvent(new c(c.SELECT_PROPERTY_ZONE,this,e.data))},this))};h.prototype._titleText=function(v){try{if(this._chart){if(!this.properties().title){return this}if(arguments.length>0){if(v!=this.properties().title.text)this._dispatchEvent(new c(c.TITLE_CHANGED,this,{text:v}));return this}else{var t=this.properties().title.text;return t}}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}catch(e){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+e}};h.prototype.getTitleByFeeding=function(){var n="";var m=[];var e=[];var k=this._chartModelProvider().feedingItems();for(var i=0;i<k.length;i++){var o=k[i];var v=o.values();var p=(o.type()==="Measure")?m:e;for(var j=0;j<v.length;j++){var q=v[j];if(q.id()===A.MND){continue}var r=q.selectedHierarchyLevel();var s=r?r.name():q.name();p.push(s)}}var t=h._getNames(m);var w=h._getNames(e);if(t!==""||w!==""){n=u.substitute(L.get('VIZ_CHART_TITLE_TEXT_JOIN_BY'),t,w)}if(n==""){n=" "}return n};h._getNames=function(n){var r="";for(var i=0;i<n.length;i++){var e=n[i];r+=e;if(i+2===n.length){r+=" "+L.get('VIZ_CHART_TITLE_TEXT_JOIN_AND')+" "}else if(i+2<n.length){r+=", "}}return r};h._ZoneMap={xAxis:{text:"VIZ_COMMON_XAXIS"},xAxis2:{text:"VIZ_COMMON_XAXIS"},yAxis:{text:"VIZ_COMMON_YAXIS",rotate:true},yAxis2:{text:"VIZ_COMMON_YAXIS",rotate:true}};h._ZoneMap[F.trillisFeeds.column.id]={text:"VIZ_COMMON_COLUMNS"};h._ZoneMap[F.trillisFeeds.row.id]={text:"VIZ_COMMON_ROWS",rotate:true};h.prototype._isEmptyZone=function(z){if(!z||!z.bound){return true}var e=z.bound[0];if(!e){return true}var w=e[2][0]-e[0][0];var i=e[2][1]-e[0][1];if(w<1||i<1){return true}return false};h.prototype._updateTextInfo=function(z){if(!z){return}for(var n=0;n<z.length;n++){var i=h._ZoneMap[z[n].name];if(i){z[n].text=L.get(i.text);z[n].rotate=i.rotate}}};h.prototype.getTitleZone=function(){if(!this._chart){return[]}var t=this._chart.type;var z;try{z=this._chart.propertyZone()}catch(e){return[]}var j=[];for(var i=0;i<z.length;i++){if(z[i].name=='title'){j=z[i].bound[0];break}}return j};h.prototype._getFeedingZone=function(){if(!this._chart){return[]}var t=this._chart.type;var z;try{z=this._chart.feedingZone()}catch(e){return[]}if(!a.supportMultiChart(t)){this._updateTextInfo(z);return z}var j=a.isMultipleChart(t);var k=null;var r=null;if(j){for(var i=z.length-1;i>=0;i--){var m=z[i].name;if(m===F.MultiplierFeedingName){k={name:F.ColumnsFeedingName,bound:[z[i].bound[0]],feedDef:z[i].feedDef};r={name:F.RowsFeedingName,bound:[z[i].bound[1]],feedDef:z[i].feedDef};z.splice(i,1)}else if(m!=="mainPlot"&&m!=="legend"){if(T.providerName(t)===T.MULTIPLE){z.splice(i,1)}}}}if(!this._enableTrellis){this._updateTextInfo(z);return z}if(this._isEmptyZone(k)){k=null}if(this._isEmptyZone(r)){r=null}var p=this._padding;var n={"id":F.MultiplierFeedingName,"name":"ChartView Multiplier","type":"Dimension","min":1,"max":1,"aaIndex":1,"acceptMND":0};var o;if(!k){o=[[[p,0],[this._size.width-p,0],[this._size.width-p,p],[0,p]]];k={"name":F.ColumnsFeedingName,"feedDef":[n],"bound":o}}if(!r){o=[[[0,p],[p,p],[p,this._size.height-p],[0,this._size.height-p]]];r={"name":F.RowsFeedingName,"feedDef":[n],"bound":o}}z.push(k,r);this._updateTextInfo(z);return z};h.prototype._updateMorphingSnapshot=function(){if(this._canMorphing()&&this._hasChartInstance&&this._vizMorpher&&!this._vizMorpher.isPlaying()){this._vizMorpher.morphVizType(null,-1)}};h.prototype._setDefaultValue=function(t,p,e,v){var j=p.split('.');var r=t;for(var i=0;i<j.length;i++){r[j[i]]=r[j[i]]||{};r=r[j[i]]}if(!r.hasOwnProperty(e)){r[e]=v}};h.prototype._applyDefaultProperties=function(o){o=o||{};o.properties=o.properties||{};this._setDefaultValue(o.properties,'xAxis.gridline','visible',false);this._setDefaultValue(o.properties,'yAxis.gridline','visible',false);this._setDefaultValue(o.properties,'background.border.left','visible',false);this._setDefaultValue(o.properties,'background.border.top','visible',false);this._setDefaultValue(o.properties,'background.border.right','visible',false);this._setDefaultValue(o.properties,'background.border.bottom','visible',false);return o};function l(e,k,m){if(k==null||k.length==0){return 1}var v=[];var r=1;var o=0;var p=false;for(var n=0;n<k.length;n++){if(k[n].type()===A.HIERARCHY){var q=k[n].hierarchyLevels();for(var j=0;j<q.length;j++){if(q[j].selected()){break}o++}}else if(k[n].type()===A.MND){p=true;continue}if(o<e.length){var s=e[o].values;v[n]={};var t=0;for(var i=0;i<s.length;i++){if(!v[n].hasOwnProperty(s[i])){v[n][s[i]]=true;t++}}r*=t;o++}}if(p){r*=m}return r};h.prototype._getRowColumn=function(e,m){var r={row:1,column:1};if(!e||e.length===0){return r}var n=e[0].data;if(!n||n.length===0){return r}var o=0;var p=null;var q=null;var s=this._chartModelProvider().feedingItems();for(var i=0;i<s.length;i++){if(s[i].id()===F.RowsFeedingName){p=s[i].values();for(var j=0;j<p.length;j++){if(p[j].type()===A.HIERARCHY){var t=p[j].hierarchyLevels();for(var k=0;k<t.length;k++){o++;if(t[k].selected()){break}}}else if(p[j].type()!==A.MND){o++}}}else if(s[i].id()===F.ColumnsFeedingName){q=s[i].values()}}r.row=l(n.slice(0,o),p,m);r.column=l(n.slice(o),q,m);return r};h.prototype._getMinSize=function(){var w=this._size.width;var e=this._size.height;var o=this._options;var r={width:w,height:e};if(a.isMultipleChart(o.type)&&T.providerName(o.type)===T.MULTIPLE){if(!o.data||!o.data.data()){return r}var m=o.data.data().measureValuesGroup;var j=0;for(var i=0;i<m.length;i++){j+=m[i].data.length}var k=this._getRowColumn(o.data.data().analysisAxis,j);var n=k.column*200;var p=k.row*200;if(w<n){w=n;r['overflow-x']='auto'}if(e<p){e=p;r['overflow-y']='auto'}}r.width=w;r.height=e;return r};h.prototype._updateChartSize=function(e){var m=h.superclass._updateChartSize.apply(this,arguments);var w=m.width;var i=m.height;this._morphingLayer$.css({width:w+"px",height:i+"px",display:'none'});return m};h.prototype._createChartInstance=function(){this._hasChartInstance=false;var o=this._options;o=this._applyDefaultProperties(o);var e=this._chartLayer$;var m=this._morphingLayer$;var i=this._descriptionLayer$;var j=this._chartHolder$;var v=o.type;if(v===C.TYPE_TREE||v===C.TYPE_NETWORK||v===C.TYPE_FUNNEL||v===C.TYPE_PC){this._supportMorphing=false}else if(!a.isBuildInType(v)){this._supportMorphing=false}else{this._supportMorphing=true}if(this._canMorphing()&&!this._vizMorpher){this._vizMorpher=new d(e.get(0),m.get(0))}this._updateMorphingSnapshot();this._destroyChartInstance();if(o.data===null||o.data===undefined){if(this._canMorphing()&&this._vizMorpher){this._vizMorpher.morphVizType(null,-1)}return}if(!o.properties){o.properties={}}if(this._canMorphing()===true){if(!o.properties.plotArea){o.properties.plotArea={}}if(!o.properties.plotArea.animation){o.properties.plotArea.animation={}}o.properties.plotArea.animation.dataLoading=false;o.properties.plotArea.animation.dataUpdating=false;o.properties.plotArea.animation.resizing=false}try{if(!this._enableTrellis&&a.isMultipleChart(v)){this._propertyZone.updateZone(false);return}this._dispatchEvent(new c(c.CHART_CHANGING,this,v));this._updateDescriptionByOptions(o);this._chart=sap.viz.api.core.createViz({type:v,data:o.data,feeding:o.feeding,properties:o.properties,css:o.css,events:o.events,container:e.get(0)});this._postVizProcess(o)}catch(k){var n=L.get('VIZ_CHART_CREATE_CHART_FAILED')+k;this._propertyZone.updateZone(false);if(!F.getVizFeeds(v)){this._updateDescription(u.substitute(L.get("VIZ_CHART_INVALID_VIZ_TYPE"),v))}else{this._updateDescription(n)}e.html("");this._chart=null;this._hasChartInstance=false;throw n}};h.prototype._postVizProcess=function(o){Object.keys(this._onEventMap).forEach($.proxy(function(k){var e=this._onEventMap[k];this._chart.on(k,e)},this));var t=$.proxy(function(e,i){this._dispatchEvent(new c(c.TRIGGER_CVOM_EVENT,this,{type:e,data:i}))},this);if(this._canMorphing()&&this._vizMorpher){this._vizMorpher.showMorphing(true,false)}this._chart.on("initialized.chartview",$.proxy(function(e){if(this._canMorphing()&&this._requestMorphing&&this._hasChartInstance&&this._vizMorpher){this._requestMorphing=false;sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:morphing');this._vizMorpher.morphVizType(o.type,800,function(){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:morphing')})}var i=this._enablePropertyZone&&this._isFeedsValid;this._propertyZone.updateZone(i);t("initialized",e)},this));var _=this;this._chart.on("selectData.chartview",function(s){if(_._options.type!==C.TYPE_NETWORK){_._dispatchEvent(new c(c.CHANGED_SELECTED_DATA,this));t("selectData",s)}});this._chart.on("deselectData.chartview",function(e){if(_._options.type!==C.TYPE_NETWORK&&_._options.type!==C.TYPE_TREE){_._dispatchEvent(new c(c.CHANGED_SELECTED_DATA,this));t("deselectData",e)}});this._chart.on("showTooltip.chartview",function(e){t("showTooltip",e)});this._chart.on("hideTooltip.chartview",function(e){t("hideTooltip",e)});this._hasChartInstance=true;this._requestMorphing=true;this._dispatchEvent(new c(c.CHART_CHANGED,this,this._chart))};h.prototype.getTemplateId=function(e){var i=e||this.data();if(V.hasFakeData(i)){return"incomplete_ghost"}else{return this._templateId}};h.prototype.size=function(s){if(arguments.length>0){h.superclass.size.apply(this,arguments);if(this._dropZone){this._dropZone.size(this._size)}this._propertyZone.size(this._size);setTimeout($.proxy(this._updateMorphingSnapshot,this),500);return this}else{return h.superclass.size.apply(this,arguments)}};h.prototype.data=function(e,i){if(!i){this._requestMorphing=true}return h.superclass.data.apply(this,arguments)};h.prototype.feeding=function(e,i){try{if(this._chart){if(!i){this._requestMorphing=true}if(arguments.length>0){this._chart.feeding(e);return this}else{return this._chart.feeding()}}else{throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}catch(j){throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+j}};h.prototype.css=function(e,i){try{if(!i){this._requestMorphing=true}if(arguments.length>0){this._options.css=e;if(this._chart){this._chart.css(e);return this}else{throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{if(this._chart){return this._chart.css()}else{return this._options.css}}}catch(j){throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+j}};h.prototype.properties=function(p,e){try{if(!e){this._requestMorphing=true}if(arguments.length>0){this._options.properties=p;if(this._chart){this._chart.properties(p);return this}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{if(this._chart){return this._chart.properties()}else{return this._options.properties}}}catch(i){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+i}};h.prototype.update=function(e,i){if(!i){this._requestMorphing=true}return h.superclass.update.apply(this,arguments)};h.prototype.feedingZone=function(){try{if(this._chart){return this._chart.feedingZone()}else{throw L.get('VIZ_CHART_FEEDINGZONE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}catch(e){throw L.get('VIZ_CHART_FEEDINGZONE_FAILED')+e}};h.prototype._canMorphing=function(){return this._enableMorphing&&this._supportMorphing};h.prototype._getPropertyZone=function(){if(!this._chart){return[]}var z;try{z=this._chart.propertyZone()}catch(e){return[]}return z};h.prototype.enablePropertyZone=function(v){if(arguments.length>0){if(this._enablePropertyZone!==v){this._enablePropertyZone=(v===true);var e=this._enablePropertyZone&&this._isFeedsValid;this._propertyZone.updateZone(e)}return this}else{return this._enablePropertyZone}};h.prototype.applyDefaultProperties=function(p,e){if(!p){p=e;return p}var i=p.plotArea;if(i){if(!i.marker){i.marker=e.plotArea.marker}if(i.line){var j=i.line.marker;if(!j){i.line.marker=e.plotArea.line.marker}}else{i.line=e.plotArea.line}}else{p.plotArea=e.plotArea}return p};h.prototype.copyData=function(t,e){var r=new sap.viz.api.data.CrosstableDataset();r.data(u.clone(e.data()));r.info(u.clone(e.info('additionalData')));return r};h.prototype.buildFeedings=function(t,e,i){var j=null;if(!e){return j}if(!V.hasFakeData(e)&&!V.isEmptyData(t,e)&&!F.isEmptyFeeds(i)){j=F.buildFeedings(t,i,e)}else{j=F.buildFeedingsWithFakeData(t,i,e);j=F.buildMNDFeedings(j,t)}return j};return h});define('sap/viz/controls/chart/views/MapView',['jquery','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/views/View','sap/viz/controls/chart/ghost/IncompleteGhost','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItem'],function($,G,C,D,M,E,F,a,L,O,u,b,T,V,c,d,e,g,I,A,h){var k=function(f,o,l,i){k.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.MapView";this._createChildren();sap.viz.extapi.env.Template.addListener($.proxy(this.changeTemplate,this))};O.extend(k,g);k.prototype.modelChanged=function(m,o){if(o.vizTypeChanged){this.showLoadingIcon()}if(o.feedingItemsChanged&&o.feedsChangedInfo&&o.feedsChangedInfo.items){var f=o.feedsChangedInfo.items[0];var l=m.feedingItems()[f];var n=new F(F.FEEDS_CHANGED,this,{'datasetType':D.FlatTableDataset,'feeds':l,'layerIdx':f});this._dispatchEvent(new E(g.DISPATCH_PROPERTY_EVENT,this,n))}if(o.extensionValuesChanged){var p=m.extensionValues();if(p.mapBuilder){var v=p.mapBuilder;var q=this._chart;if(v&&q){if(v.layer){var r=v.layer.action;var f=v.layer.idx;var s=v.layer.from;var t=v.layer.to;if(r==='add'){q.addLayer(new sap.viz.geo.dataviz.Layer({viz:new sap.viz.geo.dataviz.Choropleth(this._options.properties.geomap.choropleth),legendVisible:true}),true)}else if(r==='delete'&&f>=0){q.removeLayer(q.getLayer(f))}else if(r==='reorder'&&s>=0&&t>=0){q.reorderLayer(q.getLayer(s),t)}else if(r==='show'&&f>=0){var w=q.getLayer(f);w.visibility(true);w.legendVisibility(true)}else if(r==='hide'&&f>=0){var w=q.getLayer(f);w.visibility(false);w.legendVisibility(false)}else if(r==='changeVizType'&&f>=0){var w=q.getLayer(f);var x=v.layer.vizType;var y=v.layer.feeding;var z,B,H,J,K,N;if(y!==null){for(var i=0;i<y.length;i++){B=y[i];if(B){for(var j=0;j<B.values().length;j++){var P=B.values()[j].id();if(B.id()==="location"){H=P}else if(B.id()==="color"){J=P;K=B.type()}else if(B.id()==="size"){N=P}}}}w.data(null)}if(x==='choropleth'){if(y!==null){z={};if(H){z.location=H}if(K==="Measure"&&J){z.color=J}w.viz(new sap.viz.geo.dataviz.Choropleth(this._options.properties.geomap.choropleth),z)}else{w.viz(new sap.viz.geo.dataviz.Choropleth(this._options.properties.geomap.choropleth))}}else if(x==='bubble'){if(y!==null){z={};if(H){z.location=H}if(N){z.size=N}if(K==="Dimension"&&J){z.color=J}w.viz(new sap.viz.geo.dataviz.Bubble({cluster:{enabled:false}}),z)}else{w.viz(new sap.viz.geo.dataviz.Bubble({cluster:{enabled:false}}))}}else if(x==='marker'){if(y!==null){z={};if(H){z.location=H}w.viz(new sap.viz.geo.dataviz.Marker({url:this._libFolderPath+'/sap.viz.geo/geocharts/resources/images/marker.png',highlightUrl:this._libFolderPath+'/sap.viz.geo/geocharts/resources/images/marker_highlight.png',width:12,height:20,xoffset:-6,yoffset:-20,cluster:{enabled:false,url:this._libFolderPath+'/sap.viz.geo/geocharts/resources/images/cluster.png',highlightUrl:this._libFolderPath+'/sap.viz.geo/geocharts/resources/images/cluster_highlight.png'}}),z)}else{w.viz(new sap.viz.geo.dataviz.Marker({url:this._libFolderPath+'/sap.viz.geo/geocharts/resources/images/marker.png',highlightUrl:this._libFolderPath+'/sap.viz.geo/geocharts/resources/images/marker_highlight.png',width:12,height:20,xoffset:-6,yoffset:-20,cluster:{enabled:false,url:this._libFolderPath+'/sap.viz.geo/geocharts/resources/images/cluster.png',highlightUrl:this._libFolderPath+'/sap.viz.geo/geocharts/resources/images/cluster_highlight.png'}}))}}}else if(r==='changeProperties'&&f>=0){var w=q.getLayer(f);var Q=v.layer.propKey;var R=v.layer.propValue;if(Q==='markerCluster'){w.viz(new sap.viz.geo.dataviz.Marker({url:this._libFolderPath+'/sap.viz.geo/geocharts/resources/images/marker.png',highlightUrl:this._libFolderPath+'/sap.viz.geo/geocharts/resources/images/marker_highlight.png',width:12,height:20,xoffset:-6,yoffset:-20,cluster:{enabled:R,url:this._libFolderPath+'/sap.viz.geo/geocharts/resources/images/cluster.png',highlightUrl:this._libFolderPath+'/sap.viz.geo/geocharts/resources/images/cluster_highlight.png'}}))}else if(Q==='bubbleCluster'){w.viz(new sap.viz.geo.dataviz.Bubble({cluster:{enabled:R,distance:80}}))}}}}}}};k.prototype.data=function(f){try{if(arguments.length>0){if(this._chart){if(!f.length){return this}var l=this._chart.getLayers?this._chart.getLayers():this._chart._layers;var j=l.length>f.length?f.length:l.length;for(var i=0;i<j;++i){if(f[i]){l[i].data(f[i])}}return this}else{throw L.get('VIZ_CHART_UPDATE_DATA_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{var m=[];if(this._chart){var l=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var i=0;i<l.length;++i){m.push(l[i].data())}}return m}}catch(n){throw L.get('VIZ_CHART_UPDATE_DATA_FAILED')+n}};k.prototype.action=function(f,i){if(this._chart){if(this._chart.__instance){return this._chart.__instance.action(f,i)}else{return this._chart}}else{throw L.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};k.prototype.exportViz=function(f){if(this._chart){var r=this._chart.toJSON({emptyDataset:!!f});return r}else{throw L.get('VIZ_CHART_SERIALIZE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};k.prototype.loadViz=function(v){var _=this;this._dispatchEvent(new d(d.CHART_CHANGING,this,v.type));this._updateDescription();this.showLoadingIcon();var f=this._chartLayer$;var i=sap.viz.api.core.createViz({type:v.type,container:f.get(0),});this._chart=i.action("getMap");this._chart.__instance=i;if(v.baseMap.id.indexOf("esri")!==-1){require(['esri/map'],function(){sap.viz.geo.LocationRepository.useLocal({'resourcePath':_._geoResourcePath});_._chart.fromJSON(v);_._postVizProcess(_._options)})}else if(v.baseMap.id.indexOf("cvom")!==-1){sap.viz.geo.LocationRepository.useLocal({'resourcePath':_._geoResourcePath});_._chart.fromJSON(v);_._postVizProcess(_._options)}else if(v.baseMap.id.indexOf("navtaq")){_._chart.fromJSON(v);_._postVizProcess(_._options)}};k.prototype._setChartSize=function(w,f){if(this._chart&&this._chart.__instance){this._chart.__instance.size({width:w,height:f})}};k.prototype._updateDescription=function(f){if(f){this._descriptionLayer$.show();this._descriptionLayer$.text(f);this._showDescription()}else{this._descriptionLayer$.hide();this._chartHolder$.css({'opacity':""})}this.hideLoadingIcon()};k.prototype._createChartInstance=function(){this._hasChartInstance=false;var o=this._options;var f=this._chartLayer$;var i=this._descriptionLayer$;var j=this._chartHolder$;var v=o.type;this._destroyChartInstance();try{this._dispatchEvent(new d(d.CHART_CHANGING,this,v));this._updateDescriptionByOptions(o);this.createBaseMap(this._options.properties.geomap.provider,{},function(n){var p=sap.viz.api.core.createViz({type:v,container:f.get(0),options:{geomap:{baseMap:n}}});this._chart=p.action("getMap");this._chart.__instance=p;this._chartModelProvider().extensionValues({mapBuilder:{layer:{action:'add'}}});this._postVizProcess(o)})}catch(l){var m=L.get('VIZ_CHART_CREATE_CHART_FAILED')+l;if(!a.getVizFeeds(v)){this._updateDescription(u.substitute(L.get("VIZ_CHART_INVALID_VIZ_TYPE"),v))}else{this._updateDescription(m)}f.html("");this._chart=null;this._hasChartInstance=false;throw m}};k.prototype._postVizProcess=function(o){Object.keys(this._onEventMap).forEach($.proxy(function(f){var i=this._onEventMap[f];this._chart.on(f,i)},this));var t=$.proxy(function(f,i){this._dispatchEvent(new d(d.TRIGGER_CVOM_EVENT,this,{type:f,data:i}))},this);this._chart.on("initialized.chartview",$.proxy(function(f){this.hideLoadingIcon();t("initialized",f)},this));var _=this;this._chart.on("selectData.chartview",function(s){_._dispatchEvent(new d(d.CHANGED_SELECTED_DATA,this));t("selectData",s)});this._chart.on("deselectData.chartview",function(f){_._dispatchEvent(new d(d.CHANGED_SELECTED_DATA,this));t("deselectData",f)});this._chart.on("showTooltip.chartview",function(f){t("showTooltip",f)});this._chart.on("hideTooltip.chartview",function(f){t("hideTooltip",f)});this._hasChartInstance=true;this._dispatchEvent(new d(d.CHART_CHANGED,this,this._chart))};k.prototype.getTemplateId=function(f){return this._templateId};k.prototype.update=function(f){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update');var j;try{if(f.data){this._options.data=f.data}if(f.properties){this._options.properties=f.properties}if(!this._chart){j=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');this._updateDescription(j);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update');throw j}this._updateDescription();this._chartLayer$.css('opacity','');if(!f.data||f.data.length===0){return this}var m=this._chart;if(m){for(var i=0;i<f.data.length;i++){if(f.data[i]){var l=m.getLayer(i);var n=f.feeding?f.feeding[i]:null;l.data(f.data[i],n)}}}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update');return this}catch(o){j=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+o;this._updateDescription(j);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update');throw j}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update')};k.prototype.feeding=function(f,j){try{if(this._chart){if(arguments.length>0&&f.length>0){var l=this._chart.getLayers?this._chart.getLayers():this._chart._layers;var m=l.length>f.length?f.length:l.length;for(var i=0;i<m;++i){if(f[i]){l[i].feeding(f[i])}}return this}else{var n=[];var l=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var i=0;i<l.length;++i){var o=l[i].feeding();n.push(o)}return n}}else{throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}catch(p){throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+p}};k.prototype.properties=function(p){try{if(arguments.length>0){this._options.properties=p;if(this._chart){var m=this._chart;var f=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var i=0;i<f.length;i++){var l=f[i];if(l&&p.legend){l.legendVisibility(p.legend.visible)}}return this}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{return this._options.properties}}catch(j){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+j}};k.prototype.copyData=function(t,f){if(f&&f.length>0){var r=[];for(var i=0;i<f.length;i++){if(f[i]&&f[i].id&&(f[i].id==="sap.viz.data.FlatTableDataset")){var j=sap.viz.api.data.FlatTableDataset.fromJSON(f[i]);r.push(j)}else r.push(f[i])}return r}else{return f}};k.prototype.buildFeedings=function(t,j,l){var r=[];for(var i=0;i<l.length;i++){r[i]={};if(!l[i]||l[i].length===0){continue}l[i].forEach(function(f){if(f._values&&f._values.length){r[i][f._id]=f._values[0]._id}})}return r};k.prototype.createBaseMap=function(m,o,f){var i=null;if(m===M.ESRI){require(['esri/map'],function(n){var p=function(o){sap.viz.geo.LocationRepository.useLocal({'resourcePath':this._geoResourcePath});var t='topo';if(o&&o.type){t=o.type}return new sap.viz.geo.basemap.esri.Provider({extent:new esri.geometry.Extent(-115,-34,115,76),basemap:t})}.bind(this);f.call(this,p(o))}.bind(this))}else if(m===M.NAVTEQ){var j={center:[40.72,-84],zoomLevel:5};f.call(this,new sap.viz.geo.basemap.navteq.Provider(j))}else if(m===M.CVOM){sap.viz.geo.LocationRepository.useLocal({'resourcePath':this._geoResourcePath});var j={center:[-84,40.72],scale:6000};var l=(j);f.call(this,new sap.viz.geo.basemap.cvom.Provider(o))}return i};k.prototype.FeedsToJSON=function(f){var j=[];for(var i=0;i<f.length;i++){j[i]=h.toJSON(f[i])}return j};k.prototype.FeedsFromJSON=function(v){var f=[];for(var i=0;i<v.length;i++){f[i]=h.fromJSON(v[i])}return f};return k});define('sap/viz/controls/chart/views/TableView',['jquery','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/views/View','sap/viz/controls/chart/ghost/IncompleteGhost','sap/viz/controls/common/feeds/AnalyticalType'],function($,G,C,D,M,E,F,a,L,O,u,b,T,V,c,d,e,f,I,A){var g=function(h,o,l,i){g.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.TableView";this._createChildren();sap.viz.extapi.env.Template.addListener($.proxy(this.changeTemplate,this))};O.extend(g,f);g.prototype._createChildren=function(){g.superclass._createChildren.apply(this,arguments);this._createDropZone()};g.prototype._createChartInstance=function(){this._hasChartInstance=false;var o=this._options;var h=this._chartLayer$;var i=this._descriptionLayer$;var j=this._chartHolder$;var v=o.type;this._supportMorphing=false;this._destroyChartInstance();try{this._dispatchEvent(new d(d.CHART_CHANGING,this,v));this._updateDescriptionByOptions(o);this._chart=sap.viz.api.core.createViz({type:v,data:o.data,feeding:o.feeding,properties:o.properties,css:o.css,events:o.events,container:h.get(0)});this._postVizProcess(o)}catch(k){var l=L.get('VIZ_CHART_CREATE_CHART_FAILED')+k;if(!a.getVizFeeds(v)){this._updateDescription(u.substitute(L.get("VIZ_CHART_INVALID_VIZ_TYPE"),v))}else{this._updateDescription(l)}h.html("");this._chart=null;this._hasChartInstance=false;throw l}};g.prototype._postVizProcess=function(o){Object.keys(this._onEventMap).forEach($.proxy(function(k){var h=this._onEventMap[k];this._chart.on(k,h)},this));this._hasChartInstance=true;this._dispatchEvent(new d(d.CHART_CHANGED,this,this._chart))};return g});define('sap/viz/controls/chart/ViewManager',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/chart/views/ChartView','sap/viz/controls/chart/views/MapView','sap/viz/controls/chart/views/TableView'],function(C,a,M,T){var t={};var V={};V._register=function(b,v){if(b&&v){t[b]=v}};V._getViewClass=function(b){if(t.hasOwnProperty(b)){return t[b]}else{return a}};V.getViewClass=function(b){return V._getViewClass(b)};V._register(C.TYPE_GEO_MAP,M);V._register(C.TYPE_TABLE,T);return V});define('sap/viz/controls/chart/VizProxyHandler',['sap/viz/controls/runtime/VizProxy','sap/viz/controls/chart/views/ChartEvent'],function(V,C){var a=function(c){this.__className="sap.viz.controls.chart.VizProxyHandler";this._chart=c;this._init()};a.prototype._init=function(){this._operationMap={};this._operationMap[V.GetTitleZoneOperation]=this._getTitleZone;this._operationMap[V.GetTitleTextOperation]=this._getTitleText;this._operationMap[V.SetTitleTextOperation]=this._setTitleText;this._operationMap[V.GetTitleTextByFeedingOperation]=this._getTitleTextByFeeding;this._operationMap[V.RestoreTitleTextOperation]=this._restoreTitleText;this._operationMap[V.IsFakeChartOperation]=this._isFakeChart;this._operationMap[V.IsTitleCustomizedOperation]=this._isTitleCustomized;this._operationMap[V.GetPropertiesOperation]=this._getProperties;this._operationMap[V.SetPropertiesOperation]=this._setProperties;this._operationMap[V.GetSelectionOperation]=this._getSelection};a.prototype.response=function(d){var o=d.operation;var b=d.args;d.result=this._operationMap[o].apply(this,b)};a.prototype._getTitleZone=function(){return this._chart.getTitleZone()};a.prototype._getTitleText=function(){return this._chart.vizTitle()};a.prototype._setTitleText=function(t){this._chart.vizTitle(t)};a.prototype._getTitleTextByFeeding=function(){return this._chart.getTitleTextByFeeding()};a.prototype._restoreTitleText=function(){this._chart.restoreTitleText()};a.prototype._isFakeChart=function(){return this._chart.isFake()};a.prototype._isTitleCustomized=function(){return this._chart.isTitleCustomized()};a.prototype._getProperties=function(){return this._chart.vizProperties()};a.prototype._setProperties=function(n){this._chart.vizProperties(n)};a.prototype._getSelection=function(){return this._chart.vizSelection()};return a});define('sap/viz/controls/chart/Chart',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/ghost/IncompleteGhost','sap/viz/controls/chart/views/ChartView','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/View','sap/viz/controls/chart/ViewManager','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/common/services/BVRService','sap/viz/controls/runtime/VizProxy','sap/viz/controls/chart/VizProxyHandler'],function($,V,G,C,D,E,a,F,A,b,c,d,O,u,f,L,g,I,j,k,l,m,R,B,n,o){var q=function q(e,h){q.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.Chart";this._div=e;this._uiConfig=h?h:G.defaultUIConfig(G.DEFAULT_UICONFIG_TYPE_CHART);this._uiConfig.libFolderPath=G.defaultAssetsRoot()+'/common/libs';this._layout=null;this._chartViewInstance=null;this._type=null;this._data=null;this._properties=null;this._labelFormats=null;this._css=null;this._description=null;this._vizCreated=false;this._enableVizDefChangedEvent=true;this._loadingModel=false;this._loadingInstance=false;this._titleCustomized=false;this._titleGeneratorFunc=null;this._enableTrellis=(this._uiConfig.enableTrellis!==false);this._enableMorphing=(this._uiConfig.enableMorphing!==false);R.getRuntime().registerModel(this._uid,this._vizModel());this._vizProxyHandler=new o(this);this._vizModel().addEventListener(n.VizProxyEvent,this._onVizProxyEvent,this);this._createChildren()};O.extend(q,V);q.VERSION="1.0";q.prototype.vizType=function(t){if(arguments.length>0){if(!u.isString(t)){return}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizType()_set');this._beginUpdateProperty();this._vizType=t;this._vizModel().type(this._vizType);this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizType()_set');return this}else{return this._vizModel().type()}};q.prototype.vizTitle=function(t){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizTitle()_set');if(f.hasFakeData(this._data)){t=' '}var e=this.vizProperties().title;if(t!==e.text){e.text=t;this.vizProperties({'title':e})}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizTitle()_set');return this}else{return this.vizProperties().title.text}};q.prototype.isFake=function(){return f.hasFakeData(this._data)};q.prototype.setTitleGeneratorFunc=function(v){if(v!=null&&!u.isFunction(v)){return}this._titleGeneratorFunc=v;if(!this._titleCustomized){this.restoreTitleText()}};q.prototype.isTitleCustomized=function(){return this._titleCustomized};q.prototype.getTitleZone=function(){if(this._chartView().getTitleZone){return this._chartView().getTitleZone()}else{return[]}};q.prototype.getTitleTextByFeeding=function(){if(this._titleGeneratorFunc){var e=[this.vizUid()];return this._titleGeneratorFunc.apply(null,e)}return this._chartView().getTitleByFeeding()};q.prototype.restoreTitleText=function(){this.vizTitle(this.getTitleTextByFeeding())};q.prototype._titleChangedHandler=function(e){var t=e.data.text;this.vizTitle(t)};q.prototype.destroy=function(){this._destroyViz();q.superclass.destroy.apply(this,arguments)};q.prototype.feedAnalysisObjects=function(e,h){this._beginUpdateProperty();var p=this._vizModel();var r;if(h===true){r=B.suggestFeeds(p.type(),p.explicitFeedingItems(),e)}else{r=B.suggestFeeds(p.type(),e)}var s=p.explicitFeedingItems();if(r){if(c.equal(s,r.feeds)){for(var t in e){var v=c.getVizFeeds(p.type());for(var w in v){if(c.canAddFeed(s,v[w],e[t])){this._replaceFeed(s,e[t])}}}}else{s=r.feeds}p.feedingItems(s)}this._endUpdateProperty();return s};q.prototype.getDefaultIncompleteOptions=function(t){if(!u.isString(t)){return}return{'type':t,'properties':this._uiConfig.defaultProperties,'data':I.getDataset(t)}};q.prototype._updateColumnDimCount=function(){if(d.isMultipleChart(this._vizModel().type())){var e=c.getNumberOfDimensionsInColumn(this._vizModel().feedingItems());this._properties=this._properties||{};this._properties.multiLayout=this._properties.multiLayout||{};this._properties.multiLayout.numberOfDimensionsInColumn=e}};q.prototype._dispatchVizDefChangedEvent=function(e){var h={vizTypeChanged:(e.vizTypeChanged===true),vizPropertiesChanged:(e.vizPropertiesChanged===true),vizCssChanged:(e.vizCssChanged===true),feedingItemsChanged:(e.feedingItemsChanged===true),filterChanged:(e.filterChanged===true),vizTitleChanged:(e.vizTitleChanged===true)};if(this._vizDefChangedData){for(var p in this._vizDefChangedData){if(this._vizDefChangedData.hasOwnProperty(p)){h[p]=h[p]||this._vizDefChangedData[p]}}this._vizDefChangedData=null}if(this._enableVizDefChangedEvent){this._dispatchEvent(new a(E.VIZ_DEFINITION_CHANGED,this,h))}else{this._vizDefChangedData=h}};q.prototype._updateView=function(t){var v=m.getViewClass(t);if(this._chartViewInstance instanceof v){return}if(this._chartViewInstance){this._chartViewInstance.destroy();this._chartViewInstance=null;this._data=null}this._createChartView(v);var s={width:$(this._div).width(),height:$(this._div).height()};this._chartView().size(s);if(d.isTable(t)){this._data=I.getDataset(t)}};q.prototype._onVizModelChanged=function(e){this._dispatchVizDefChangedEvent(e.data);var v=this._vizModel().type();if(e.data.vizTypeChanged){this._updateView(v)}if(this._loadingModel){return}if(e.data.vizTypeChanged){this._updateLabelFormats(v);this._dispatchPropertyEvent(new k(k.VIZTYPE_CHANGED,this,{type:v}))}if(!this._chartView()){return}if(e.data.feedingItemsChanged&&!d.isGeo(v)){if(!this._loadingInstance){this._updateTitle()}this._updateColumnDimCount();if(!this._inUpdatingProperty()){this.showLoadingIcon();var h=d.getDatasetType(v);this._dispatchPropertyEvent(new F(F.FEEDS_CHANGED,this,{datasetType:h,feeds:this.feeds()}));return}}this._chartView().modelChanged(this._vizModel(),e.data);if(e.data.extensionValuesChanged){var p=this._vizModel().extensionValues();if(p.feedingPanel&&this._enableTrellis!==p.feedingPanel.enableTrellis){this._enableTrellis=p.feedingPanel.enableTrellis;this._chartView().enableTrellis(this._enableTrellis)}}if(this._needCreateViz(v,false)&&(e.data.vizTypeChanged||e.data.feedingItemsChanged)){this._createVizInstance()}};q.prototype._onVizProxyEvent=function(e){this._vizProxyHandler.response(e.data)};q.prototype._updateLabelFormats=function(e){var h=['xAxis','xAxis2','yAxis','yAxis2','valueAxis'];var p={'xAxis':'yAxis','xAxis2':'yAxis2','yAxis':'xAxis','yAxis2':'xAxis2'};var i;var r;if(!this._labelFormats&&this._properties){for(i=0;i<h.length;i++){r=h[i];var s;if(r==='valueAxis'){s=this._properties.plotArea?this._properties.plotArea.valueAxis:null}else{s=this._properties[r]}var t=(s&&s.label&&s.label.hasOwnProperty('formatString'))?true:false;if(t){this._labelFormats=this._labelFormats||{};this._labelFormats[r]=s.label.formatString}}};var v=sap.viz.api.manifest.Viz.get(e)[0].allProperties();if(!v){return}var w;for(i=0;i<h.length;i++){r=h[i];var x;if(r==='valueAxis'){if(v.plotArea&&v.plotArea.valueAxis){x=v.plotArea.valueAxis.supportedValues}}else{x=v[r]}var y=(x&&x.label&&x.label.supportedValues&&x.label.supportedValues.hasOwnProperty('formatString'))?true:false;if(y){var z;if(this._properties){var H;if(r==='valueAxis'){if(this._properties.plotArea&&this._properties.plotArea.valueAxis){H=this._properties.plotArea.valueAxis;if(H&&H.label&&H.label.hasOwnProperty('formatString')){z=H.label.formatString}}}else{H=u.clone(this._properties[r]);if(H&&H.label&&H.label.hasOwnProperty('formatString')){z=H.label.formatString}}}if(z===undefined&&this._labelFormats){z=this._labelFormats[r];if(z===undefined&&r!=='valueAxis'){var J=p[r];if(J){z=this._labelFormats[J]}}}if(z===undefined){z=this._uiConfig.defaultLabelFormatString}if(z!==undefined){this._properties=this._properties||{};if(r==='valueAxis'){this._properties.plotArea=this._properties.plotArea||{};this._properties.plotArea.valueAxis=this._properties.plotArea.valueAxis||{};this._properties.plotArea.valueAxis.label={formatString:z}}else{this._properties[r]=this._properties[r]||{};this._properties[r].label={formatString:z}}}}else{w=w||[];w.push(r)}}if(w&&this._properties){for(i=0;i<w.length;i++){r=w[i];if(r==='valueAxis'){if(this._properties.plotArea&&this._properties.plotArea.valueAxis&&this._properties.plotArea.valueAxis.label){delete this._properties.plotArea.valueAxis.label.formatString}}else{if(this._properties[r]&&this._properties[r].label){delete this._properties[r].label.formatString}}}}};q.prototype._createChartView=function(v){this._chartViewInstance=new v($(this._div),{'type':this._vizModel().type(),'properties':this._properties},this._uiConfig.libFolderPath,$.proxy(this._vizModel,this));this._chartViewInstance.enableTrellis(this._enableTrellis);this._chartViewInstance.enableMorphing(this._enableMorphing);this._chartViewInstance.addEventListener(k.TITLE_CHANGED,this._titleChangedHandler,this);this._chartViewInstance.addEventListener(k.ANALYSIS_DROPPED,this._analysisDroppedHandler,this);this._chartViewInstance.addEventListener(k.CHART_CHANGED,this._chartChangedHandler,this);this._chartViewInstance.addEventListener(k.CHART_CHANGING,this._chartChangingHandler,this);this._chartViewInstance.addEventListener(k.CHANGED_SELECTED_DATA,this._selectedDataChangedHandler,this);this._chartViewInstance.addEventListener(k.SELECT_PROPERTY_ZONE,this._selectPropertyZoneHandler,this);this._chartViewInstance.addEventListener(l.DISPATCH_PROPERTY_EVENT,this._dispatchPropertyEventHandler,this)};q.prototype._selectedDataChangedHandler=function(e){this._dispatchEvent(new k(k.CHANGED_SELECTED_DATA,this,e.data))};q.prototype._selectPropertyZoneHandler=function(e){this._dispatchEvent(new k(k.SELECT_PROPERTY_ZONE,this,e.data))};q.prototype._dispatchPropertyEventHandler=function(e){var h=e.data;this._dispatchPropertyEvent(h)};q.prototype._chartChangedHandler=function(e){this._dispatchEvent(e)};q.prototype._chartChangingHandler=function(e){this._dispatchEvent(e)};q.prototype._createChildren=function(){this._validateSize();if(!this._properties){this._properties=this._uiConfig.defaultProperties;var t=L.get('IDS_DEFAULTCHARTTITLE');this._properties.title=this._properties.title?this._properties.title:{};this._properties.title.text=t}this._createChartView(j)};q.prototype._analysisDroppedHandler=function(e){var i;var h=this._vizModel();var p=h.explicitFeedingItems();var r;var z=e.data.zone;var s=e.data.analysisObject;if(z.feedDef.length===1){var t=z.feedDef[0];var v=t.id;if(z.name===c.RowsFeedingName||z.name===c.ColumnsFeedingName){v=z.name}r=c.getFeed(p,v);if(!r){r=new b(v,t.type,[]);p.push(r)}var w=t.type==='Measure'?t.max:t.maxStackedDims;if(w==null){w=Number.MAX_VALUE}if(r.values().length===w){r.values().splice(0,1)}r.values().push(s)}else{var x=B.suggestFeeds(h.type(),p,[s]);if(x){if(c.equal(p,x.feeds)){this._replaceFeed(p,s)}else{p=x.feeds}}}h.feedingItems(p,this._enableTrellis)};q.prototype._replaceFeed=function(e,h){var t=this._vizModel().type();bvrResult=B.suggestFeeds(t,[h]);var p;for(i=0;i<bvrResult.feeds.length;i++){feedItem=bvrResult.feeds[i];if(feedItem.values().length===1){p=feedItem.id();break}}for(i=0;i<e.length;i++){feedItem=e[i];if(feedItem.id()===p){var r=false;var s=feedItem.values();for(var v in s){if(s[v].id()===h.id()){r=true;break}}if(!r){feedItem.values().splice(0,1);feedItem.values().push(h)}}}};q.prototype._validateSize=function(){var w=$(this._div).width();var h=$(this._div).height();$(this._layout).css({width:w+"px",height:h+"px",visibility:"visible",display:''});if(this._chartView()){this._chartView().size({width:w,height:h})}};q.prototype._updateData=function(t,e){this._data=this._chartViewInstance.copyData(t,e)};q.prototype._chartView=function(){return this._chartViewInstance};q.prototype._needCreateViz=function(t,e){if(e===true){return true}var h=false;if(d.isTable(t)){h=true}else{if(t!==this._type){h=true}}if(!this._chartView().hasChartInstance()){h=true}return h};q.prototype._needChangeTemplate=function(t,e){var h=this._chartViewInstance.getTemplateId();var p=this._chartViewInstance.getTemplateId(e);return(h!==p)};q.prototype.showLoadingIcon=function(){this._chartView().showLoadingIcon()};q.prototype.connect=function(v){};q.prototype.disconnect=function(){};q.prototype.chartModel=function(){return this._vizModel()};q.prototype.vizUid=function(){return this._uid};q.prototype.vizData=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizData_set');var t=this._vizModel().type();this._updateData(t,e);if(this._vizCreated){var h=this._needChangeTemplate(t,e);if(h||d.isTable(t)){this._createVizInstance()}else{this._chartView().data(this._data)}}else{throw L.get('VIZ_CHART_UPDATE_DATA_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizData_set');return this}else{return this._chartView().data()}};q.prototype.vizCss=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizCss_set');this._css=e;if(this._vizCreated){this._chartView().css(this._css);this._css=this._chartView().css()}else{throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}this._dispatchVizDefChangedEvent({'vizCssChanged':true});sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizCss_set');return this}else{return this._chartView().css()}};q.prototype.vizProperties=function(p){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizProperties_set');this._enableVizDefChangedEvent=false;var t=this._vizModel().type();var e=this._initOptions({properties:p});this._labelFormats=null;if(e!==t){this._vizModel().type(e);if(this._vizCreated){this._createVizInstance()}else{this._enableVizDefChangedEvent=true;sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizProperties_set');throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}else{if(this._vizCreated){this._chartView().properties(this._properties)}else{this._enableVizDefChangedEvent=true;sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizProperties_set');throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}}var h={vizPropertiesChanged:true};if(p.hasOwnProperty("title")){h.vizTitleChanged=true;this._titleCustomized=(this._properties.title.text!=this.getTitleTextByFeeding())}this._enableVizDefChangedEvent=true;this._dispatchVizDefChangedEvent(h);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizProperties_set');return this}else{return this._chartView().properties()}};q.prototype.vizDescription=function(){return this._chartView().description()};q.prototype.vizUpdate=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizUpdate');if(!e){return}this._beginUpdateProperty();var h=false;var t=e.type||this._vizModel().type();if(e.hasOwnProperty('data')){h=this._needChangeTemplate(t,e.data)}t=this._initOptions(e);var p=(t!==this._vizModel().type());if(e.properties){var r=e.properties;if(!r.legend||!u.isBoolean(r['legend'].visible)){this._properties['legend']=this._properties['legend']||{};this._properties['legend'].visible=this._uiConfig.defaultProperties.legend.visible}if(!r.dataLabel||!u.isBoolean(r['dataLabel'].visible)){this._properties['dataLabel']=this._properties['dataLabel']||{};this._properties['dataLabel'].visible=this._uiConfig.defaultProperties.dataLabel.visible}var s=r.title||{};var v=s.text;this._titleCustomized=(v!==this.getTitleTextByFeeding())}if(!d.isGeo(t)&&e.data===null){h=true;this._updateData(t,I.getDataset(t))}var w=null;var x=e.feeds;if(x){w=x.value?x.value:x}var y;if(p){y={'type':t};if(w){y['feedingItems']=w}this._vizModel().vizModelChanged(y)}else{if(w){y={'feedingItems':w};this._vizModel().vizModelChanged(y)}if(this._vizCreated){try{if(this._needCreateViz(t,h)){this._createVizInstance()}else{this._updateVizInstance()}}catch(z){this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizUpdate');throw z}}else{}}this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizUpdate');return this};q.prototype.vizOn=function(e,h){if(arguments.length>0){if(!u.isString(e)||!u.isFunction(h)){return}this._chartView().on(e,h);return this}};q.prototype.vizOff=function(e){if(arguments.length>0){if(!u.isString(e)){return}this._chartView().off(e);return this}};q.prototype.vizAction=function(e,h){if(arguments.length>0){if(this._vizCreated){return this._chartView().action(e,h)}else{throw L.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}return this}};q.prototype.vizSelection=function(p,e){if(this._vizCreated){var s=this._chartView().selection.apply(this._chartView(),arguments);return s}else{throw L.get('VIZ_CHART_SELECTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};q.prototype.vizFeedingZone=function(){if(this._vizCreated){try{return this._chartView().feedingZone()}catch(e){return[]}}else{throw L.get('VIZ_CHART_FEEDINGZONE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED')}};q.prototype.changeTemplate=function(){return this._chartView().changeTemplate.apply(this._chartView())};q.prototype._initOptions=function(e){if(!e){return}var t=e.type||this._vizModel().type();if(e.hasOwnProperty('css')){this._css=e.css}if(e.properties){var p=u.clone(e.properties);t=d.updateType(t,p);this._properties=this._properties||{};this._properties=u.updateJSON(this._properties,p)}if(e.data){this._updateData(t,e.data)}return t};q.prototype.createViz=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_createViz');this._beginUpdateProperty();this._type=null;this._vizModel().type(null);this._data=null;this._css=null;this._properties=null;var t=this._initOptions(e);var h=null;var p=e.feeds;if(p){h=p.value?p.value:p}this._vizCreated=true;try{this._vizModel().vizModelChanged({'type':t,'feedingItems':h})}finally{this._endUpdateProperty()}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_createViz')}};q.prototype._destroyViz=function(){this._data=null;this._vizModel().type(null);this._properties=null;this._css=null;this._chartView().destroy();this._vizCreated=false};q.prototype.exportViz=function(e){return this._chartView().hasChartInstance()?this._chartView().exportViz(!!e):null};q.prototype.loadViz=function(v){if(arguments.length===1){var e=v.type;if(v.data&&v.data.type){if(v.data.type==='Crosstable'){var h=new sap.viz.api.data.CrosstableDataset();h.data(v.data.val);if(v.data.val.infos){h.info([{'type':'additionalData','info':v.data.val.infos}])}v.data=h}else{v.data=v.data.val}}if(e!==this._vizModel().type()){this._loadingModel=true;this._vizModel().vizModelChanged({'type':e});this._loadingModel=false}if(v.properties){var t=v.properties.title||{};var p=t.text;this._titleCustomized=(p!==this.getTitleTextByFeeding())}this._initOptions(v);this._type=e;this._chartViewInstance.loadViz(v)}};q.prototype._updateVizInstance=function(){var t=this._vizModel().type();var e=this.feeds({'withMND':true});var h=this._chartViewInstance.buildFeedings(t,this._data,e);this._chartView().update({'properties':this._properties,'css':this._css,'feeding':h,'data':this._data})};q.prototype._createVizInstance=function(){if(!this._vizCreated){return}try{var t=this._vizModel().type();var p=this._chartViewInstance.applyDefaultProperties(this._properties,this._uiConfig.defaultProperties);var e={'type':t,'data':this._data,'css':this._css,'properties':p};var h=this.feeds({'withMND':true});if(!d.isTable(t)){if(c.isEmptyFeeds(h)){if(f.getDatasetType(e.data)!==D.CrosstableDataset||f.hasFakeData(e.data)){this._data=e.data=I.getDataset(t)}}else{e.feeding=this._chartViewInstance.buildFeedings(t,this._data,h)}}else{if(!this._data||f.hasFakeData(this._data)){this._data=e.data=I.getDataset(t)}}this._type=e.type;if(!d.isGeo(this._type)){this._chartView().hideLoadingIcon()}this._chartView().create(e)}catch(r){if(R.getRuntime()._modelRefs[this._uid]===1){throw r}}};q.prototype.save=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_save');var h={};h["vizInstance"]=this.exportViz(!!e);var p=this._vizModel().feedingItems();var r=this._chartViewInstance.FeedsToJSON(p);h["feedingItems"]=r;h["type"]=this._vizModel().type();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_save');return h};q.prototype.load=function(v){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_load');this._beginUpdateProperty();this._loadingModel=true;var t=v["type"];if(t){this._vizModel().type(t)}var e=v['feedingItems'];if(e){var h=this._chartViewInstance.FeedsFromJSON(e);this._vizModel().feedingItems(h)}this._loadingModel=false;var p=v["vizInstance"];if(p){this._loadingInstance=true;this.loadViz(p);this._loadingInstance=false}this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_load')};q.prototype.feeds=function(v){if(arguments.length>0&&u.isArray(v)){if(v!=null&&!f.isArrayOfFeedItem(v)){return}this._beginUpdateProperty();var e=v.slice(0);this._vizModel().feedingItems(e,this._enableTrellis);try{this._updateVizInstance()}catch(h){this._endUpdateProperty();throw h}this._endUpdateProperty();return this}else{return this._vizModel().explicitFeedingItems(v)}};q.prototype.enableMorphing=function(v){if(arguments.length>0){if(this._chartView()){return this._chartView().enableMorphing(!!v)}}else{if(this._chartView()){return this._chartView().enableMorphing()}}return this};q.prototype.enablePropertyZone=function(v){if(arguments.length>0){if(this._chartView()){return this._chartView().enablePropertyZone(!!v)}}else{if(this._chartView()){return this._chartView().enablePropertyZone()}}return this};q.prototype._updateTitle=function(){if(this._titleCustomized){return}var e=this.getTitleTextByFeeding();this._properties.title=this._properties.title||{};if(this._properties.title.text!=e){this._properties.title.text=e}};q.prototype.feeding=function(){if(this._chartViewInstance){return this._chartViewInstance.feeding()}else{return[]}};q.prototype.showMessage=function(e){if(arguments.length==1){if(this._chartView()){return this._chartView().updateDescription(e)}}};return q});define('sap/viz/controls/common/utils/OSUtil',[],function(){function _(){return undefined!==document.documentElement.style.webkitBoxAlign}function a(){return!!window.XDomainRequest}function b(){return!!window.chrome}function c(){return(undefined!==document.documentElement.style.MozBoxAlign)&&("Gecko"===navigator.product)}function d(){return(/javafx\//i).test(window.navigator.userAgent)}function e(){return _()&&!b()}function f(){return(undefined!==window.navigator.standalone)&&_()&&!b()}return{isIE:a,isChrome:b,isFirefox:c,isJavaFx:d,isSafari:e,isSafariMobile:f,isWebkit:_}});define('sap/viz/controls/contextmenu/constants/MenuItemConst',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/managers/LangManager'],function(C,L){var M={};M.getText=function(t){return L.get(t)};M.DEFAULT={"icon":"/contextmenu/uncheck.png"};M.LEGEND={"name":"legend","text":"VIZ_CONTEXTMENU_SHOW_LEGEND","supportType":{"viz/column":true,"viz/stacked_column":true,"viz/dual_column":true,"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/pie_with_depth":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/geomap":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true,"viz/tagcloud":true,"viz/ext/pa/funnel":true,"viz/ext/pa/pc":true}};M.DATALABELS={"name":"datalabels","text":"VIZ_CONTEXTMENU_SHOW_DATALABELS","supportType":{"viz/column":true,"viz/stacked_column":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/heatmap":true,"viz/treemap":true,"viz/radar":true,"viz/waterfall":true}};M.DIRECTION={"name":"direction","text":{"horizontal":"VIZ_CONTEXTMENU_VERTICAL","vertical":"VIZ_CONTEXTMENU_HORIZONTAL"},"icon":{"viz/column":{"vertical":"/contextmenu/column_horizontal.png","horizontal":"/contextmenu/column_vertical.png"},"viz/stacked_column":{"vertical":{"normal":"/contextmenu/stacked_column_horizontal.png","full":"/contextmenu/stacked_column_horizontal_full.png"},"horizontal":{"normal":"/contextmenu/stacked_column_vertical.png","full":"/contextmenu/stacked_column_vertical_full.png"}},"viz/dual_column":{"vertical":"/contextmenu/dual_column_horizontal.png","horizontal":"/contextmenu/dual_column_vertical.png"},"viz/3d_column":{"vertical":"/contextmenu/3d_column_horizontal.png","horizontal":"/contextmenu/3d_column_vertical.png"},"viz/line":{"vertical":"/contextmenu/line_horizontal.png","horizontal":"/contextmenu/line_vertical.png"},"viz/area":{"vertical":{"normal":"/contextmenu/area_horizontal.png","full":"/contextmenu/area_horizontal_full.png"},"horizontal":{"normal":"/contextmenu/area_vertical.png","full":"/contextmenu/area_vertical_full.png"}},"viz/combination":{"vertical":"/contextmenu/combination_horizontal.png","horizontal":"/contextmenu/combination_vertical.png"},"viz/dual_line":{"vertical":"/contextmenu/dual_line_horizontal.png","horizontal":"/contextmenu/dual_line_vertical.png"},"viz/dual_combination":{"vertical":"/contextmenu/dual_combination_horizontal.png","horizontal":"/contextmenu/dual_combination_vertical.png"},"viz/boxplot":{"vertical":"/contextmenu/boxplot_horizontal.png","horizontal":"/contextmenu/boxplot_vertical.png"},"viz/waterfall":{"vertical":"/contextmenu/waterfall_horizontal.png","horizontal":"/contextmenu/waterfall_vertical.png"}},"supportType":{"viz/column":true,"viz/stacked_column":true,"viz/dual_column":true,"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/boxplot":true,"viz/waterfall":true}};M.STACKING={"name":"stacking","text":{"full":"VIZ_CONTEXTMENU_NORMAL_STACKING","normal":"VIZ_CONTEXTMENU_FULL_STACKING"},"icon":{"viz/stacked_column":{"normal":{"vertical":"/contextmenu/stacked_column_vertical_full.png","horizontal":"/contextmenu/stacked_column_horizontal_full.png"},"full":{"vertical":"/contextmenu/stacked_column_vertical.png","horizontal":"/contextmenu/stacked_column_horizontal.png"}},"viz/area":{"normal":{"vertical":"/contextmenu/area_vertical_full.png","horizontal":"/contextmenu/area_horizontal_full.png"},"full":{"vertical":"/contextmenu/area_vertical.png","horizontal":"/contextmenu/area_horizontal.png"}}},"supportType":{"viz/stacked_column":true,"viz/area":true}};M.COMMENT={"name":"comment","text":"VIZ_CONTEXTMENU_INSERT_COMMENT","icon":{"show":"/contextmenu/annotation.png"},"supportType":{"viz/column":true,"viz/stacked_column":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true}};M.CHARTEDITOR={"name":"charteditor","text":"VIZ_CONTEXTMENU_MENU_CHART_EDITOR","supportType":{"viz/column":true,"viz/stacked_column":true,"viz/dual_column":true,"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/pie_with_depth":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true,"viz/tagcloud":true,"viz/tree":true,"viz/network":true,"viz/ext/pa/funnel":true,"viz/ext/pa/pc":true}};M.MBCLEGEND={"name":"mbclegend","text":"VIZ_CONTEXTMENU_CHANGE_MBCLEGEND_COLOR","supportType":{"viz/choropleth":true,"viz/treemap":true,"viz/heatmap":true,"viz/tagcloud":true}};M.MND={"name":"mnd","text":"VIZ_CONTEXTMENU_SHOW_MND","supportType":{"viz/column":true,"viz/stacked_column":true,"viz/dual_column":true,"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/pie_with_depth":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true,"viz/tagcloud":false,"viz/tree":true,"viz/network":true,"viz/ext/pa/funnel":true,"viz/ext/pa/pc":true}};return M});define('sap/viz/controls/contextmenu/ContextMenuEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var C=function(t,a,d){C.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.ContextMenuEvent"};O.extend(C,E);C.CHANGE_CONTEXT_MENU="changeContextMenu";C.POPUP_CONTEXT_MENU="popupContextMenu";C.REQUEST_LEGEND_COLOR="chooseLegendColors";C.POPUP_CHART_EDITOR='popupChartEditor';return C});define('sap/viz/controls/contextmenu/models/MenuItem',[],function(){var M=function(n,t,i,a,c){this._name=n;this._text=t;this._isVisibleFunc=a;this._iconFunc=i;this._clickHandler=c;this._scope=this;this._isCheckable=false};M.prototype.name=function(v){return this._name};M.prototype.scope=function(v){if(arguments.length>0){this._scope=v;return this}else{return this._scope}};M.prototype.text=function(v){if(this._textFunc){return this._textFunc()}else{return this._text}};M.prototype.textFunc=function(v){this._textFunc=v};M.prototype.clickHandler=function(v){if(arguments.length>0){this._clickHandler=v;return this}else{return this._clickHandler}};M.prototype.icon=function(v){if(!this._iconFunc){return null}return this._iconFunc.apply(this._scope,arguments)};M.prototype.isVisible=function(v){if(!this._isVisibleFunc){return true}return this._isVisibleFunc.apply(this._scope,arguments)};M.prototype.isCheckable=function(v){return this._isCheckable};return M});define('sap/viz/controls/contextmenu/models/DataLabelMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,M,a){var D=function(c,b){D.superclass.constructor.apply(this,[M.DATALABELS.name,M.getText(M.DATALABELS.text),this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.DataLabelMenuItem";this._chartModelProvider=c;this._chartProxyProvider=b;this._isCheckable=true};O.extend(D,a);D.prototype.isChecked=function(v){if(M.DATALABELS.supportType[v]){var p=this._chartProxyProvider().getProperties();;p=p||{};p.dataLabel=p.dataLabel||{visible:false};var c=p.dataLabel.visible;return c}return null};D.prototype._clickHandler=function(){var c=this._chartProxyProvider().getProperties();;var v=!c.dataLabel.visible;var n={};n.dataLabel={};n.dataLabel.visible=v;this._chartProxyProvider().setProperties(n)};return D});define('sap/viz/controls/contextmenu/models/DirectionMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,a,M,b){var D=function(c){D.superclass.constructor.apply(this,[M.DIRECTION.name,'',this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.DirectionMenuItem";this._chartModelProvider=c};O.extend(D,b);D.prototype._textFunc=function(){var d=a.getDirection(this._getType());return M.getText(M.DIRECTION.text[d])};D.prototype._clickHandler=function(){var d=this.getDirection();if(d==C.DIRECTION_VERTICAL){d=C.DIRECTION_HORIZONTAL}else{d=C.DIRECTION_VERTICAL}var c=this._getType();var n=a.changeDirection(c,d);this._chartModelProvider().type(n)};D.prototype._getType=function(){return this._chartModelProvider().type()};D.prototype.getDirection=function(){return a.getDirection(this._getType())};return D});define('sap/viz/controls/contextmenu/models/LegendMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,M,a){var L=function(c,b){L.superclass.constructor.apply(this,[M.LEGEND.name,M.getText(M.LEGEND.text),this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.LegendMenuItem";this._chartModelProvider=c;this._chartProxyProvider=b;this._isCheckable=true};O.extend(L,a);L.prototype.isChecked=function(v){if(M.LEGEND.supportType[v]){var p=this._chartProxyProvider().getProperties();p=p||{};p.legend=p.legend||{visible:true};var c=p.legend.visible;if(v.search('geo')>-1){var s=p.sizeLegend;c=c&&(s?s.visible:true)}return c}return null};L.prototype._clickHandler=function(){var c=this._chartProxyProvider().getProperties();var v=false;if(c.legend){v=!c.legend.visible}else if(c.sizeLegend){v=!c.sizeLegend.visible}else if(c.geomap){var l=c.geomap.layers;v=!l[0].options.legendVisible}var n={};n.legend={};n.legend.visible=v;if(this._chartModelProvider().type().search('geo')>-1||this._chartModelProvider().type().search('bubble')>-1){n.sizeLegend={};n.sizeLegend.visible=v}this._chartProxyProvider().setProperties(n)};return L});define('sap/viz/controls/contextmenu/models/StackingMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,a,M,b){var S=function(c){S.superclass.constructor.apply(this,[M.STACKING.name,'',this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.StackingMenuItem";this._chartModelProvider=c};O.extend(S,b);S.prototype._textFunc=function(){var s=a.getStacking(this._getType());return M.getText(M.STACKING.text[s])};S.prototype._clickHandler=function(){var s=this.getStacking();if(s==C.STACKING_NORMAL){s=C.STACKING_FULL}else{s=C.STACKING_NORMAL}var c=this._getType();var n=a.changeStacking(c,s);this._chartModelProvider().type(n)};S.prototype._getType=function(){return this._chartModelProvider().type()};S.prototype.getStacking=function(){return a.getStacking(this._getType())};return S});define('sap/viz/controls/contextmenu/models/MBCLegendMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,M,a){var b=function(c){b.superclass.constructor.apply(this,[M.MBCLEGEND.name,M.getText(M.MBCLEGEND.text),this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.MBCLegendMenuItem";this._chartProxyProvider=c};O.extend(b,a);return b});define('sap/viz/controls/contextmenu/models/MNDMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,a,F,M,b){var c=function(d){c.superclass.constructor.apply(this,[M.MND.name,M.getText(M.MND.text),this._iconFunc,this._isVisibleFunc,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.MNDMenuItem";this._chartModelProvider=d;this._isCheckable=true};O.extend(c,b);c.prototype.isChecked=function(){return this._chartModelProvider().isMNDVisible()};c.prototype._isVisibleFunc=function(v){var s=false;var f;var k=-1;var d=sap.viz.api.manifest.Viz.get(v)[0];if(d){f=d.allFeeds();for(k=0;k<f.length;k++){if(F.canAcceptMND(f[k].acceptMND)){s=true;break}}}if(!s&&!a.isMultipleChart(v)&&a.supportMultiChart(v)){var m=a.toMultiChartType(v);d=sap.viz.api.manifest.Viz.get(m)[0];f=d.allFeeds();for(k=0;k<f.length;k++){if(F.canAcceptMND(f[k].acceptMND)){s=true;break}}}if(!s)return false;var e=this._chartModelProvider().feedingItems();for(var i=0;i<e.length;i++){var g=e[i];if(g.type()==="Measure"&&g.values().length>0){return true}}return false};c.prototype._clickHandler=function(){var v=this._chartModelProvider().isMNDVisible();this._chartModelProvider().isMNDVisible(!v)};return c});define('sap/viz/controls/contextmenu/models/ChartEditorMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,M,a){var b=function(c){b.superclass.constructor.apply(this,[M.CHARTEDITOR.name,M.getText(M.CHARTEDITOR.text),this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.ChartEditorMenuItem";this._chartProxyProvider=c};O.extend(b,a);b.prototype._iconFunc=function(v){return M.DEFAULT.icon};return b});define('sap/viz/controls/contextmenu/ContextMenu',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/OSUtil','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/ContextMenuEvent','sap/viz/controls/contextmenu/models/MenuItem','sap/viz/controls/contextmenu/models/DataLabelMenuItem','sap/viz/controls/contextmenu/models/DirectionMenuItem','sap/viz/controls/contextmenu/models/LegendMenuItem','sap/viz/controls/contextmenu/models/StackingMenuItem','sap/viz/controls/contextmenu/models/MBCLegendMenuItem','sap/viz/controls/contextmenu/models/MNDMenuItem','sap/viz/controls/contextmenu/models/ChartEditorMenuItem'],function($,O,a,F,V,G,C,E,b,L,c,M,d,f,D,g,h,S,k,l,m){var n=function(e,u){n.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.ContextMenu";this._div$=$(e);this._uiConfig=u?u:G.defaultUIConfig(G.DEFAULT_UICONFIG_TYPE_CONTEXTMENU);this._uiConfig.contextMenuAssetFolderPath=G.defaultAssetsRoot()+'/common/assets';this._cusMenuItems=null;this._vizModelProvider=$.proxy(this._vizModel,this);this._vizProxyProvider=$.proxy(this._vizProxy,this);this._menu$=null;this._createContextMenu();this._initMenuItemsModel()};O.extend(n,V);n.prototype._createContextMenu=function(){var _=this;this._menu$=$(document.createElement('div')).addClass(b.PREFIX+'contextmenu').appendTo(this._div$);this.hide();this._ul$=$(document.createElement('ul')).appendTo(this._menu$);this._ul$.addClass([b.CONTEXTMENU_PREFIX+'list',b.CONTEXTMENU_PREFIX+'list-hovered'].join(' '))};n.prototype._onVizModelChanged=function(e){};n.prototype._initMenuItemsModel=function(){this._cusMenuItems={};var e=new h(this._vizModelProvider,this._vizProxyProvider);this._cusMenuItems[e.name()]=e;var i=new D(this._vizModelProvider,this._vizProxyProvider);this._cusMenuItems[i.name()]=i;var j=new g(this._vizModelProvider);this._cusMenuItems[j.name()]=j;var s=new S(this._vizModelProvider);this._cusMenuItems[s.name()]=s;var p=new k(this._vizProxyProvider);p.clickHandler($.proxy(function(){this._dispatchEvent(new d(d.REQUEST_LEGEND_COLOR,this))},this));this._cusMenuItems[p.name()]=p;var q=new l($.proxy(this._vizModelProvider,this));this._cusMenuItems[q.name()]=q};var o=[];n.prototype._getCusMenuItem=function(e){return this._cusMenuItems[e]};n.prototype._redrawMenuItems=function(){var v=c.getVizType(this._vizModel().type());var e=[];this._ul$.empty();var p=this._uiConfig.menu;var q=n.typeHelp(v,p);if(!q||!F.getVizFeeds(v)){return false}var r,s;for(var i=0;i<q.length;i++){r=q[i];s=this._getCusMenuItem(r);if(s&&s.isVisible(v)){e.push(i)}}this._ul$.removeClass(b.PREFIX+'contextmenu-list-hovered');if(e.length===0){this._createBlankMenuUI()}else{this._ul$.addClass(b.PREFIX+'contextmenu-list-hovered');for(var j=0;j<e.length;j++){r=q[e[j]];s=this._getCusMenuItem(r);this._createMenuItemUI(s,v);if(j!==e.length-1&&(e[j]+1!==e[j+1])){this._createMenuSeparator()}}}return true};n.prototype._createBlankMenuUI=function(t){var e=$(document.createElement('li')).addClass(b.CONTEXTMENU_PREFIX+"blank-MnuItem").appendTo(this._ul$);var i=$(document.createElement('div')).appendTo(e);var j=$(document.createElement('div')).addClass([b.CONTEXTMENU_PREFIX+"MnuItmTxt",b.CONTEXTMENU_PREFIX+'blank-MnuItmTxt'].join(' ')).appendTo(i);j.text(L.get('VIZ_CONTEXTMENU_NO_MENU_ITEMS'))};n.prototype._createMenuSeparator=function(){var s=$(document.createElement('div')).appendTo(this._ul$);s.addClass(b.CONTEXTMENU_PREFIX+"MnuItem-separator")};n.prototype._createMenuItemUI=function(e,v){var i=this._uiConfig.contextMenuAssetFolderPath?this._uiConfig.contextMenuAssetFolderPath:"../src/common/assets";var j=e.isCheckable();var t=e.text();var p={};p.clickHandler=e.clickHandler();p.scope=e.scope();var q=e.name();var r=$(document.createElement('li')).addClass(b.CONTEXTMENU_PREFIX+"MnuItm").appendTo(this._ul$);var s=$(document.createElement('div')).addClass(b.CONTEXTMENU_PREFIX+"MnuItm").appendTo(r);if(j){var u=e.isChecked(v);if(u){r.addClass(b.CONTEXTMENU_PREFIX+"MnuItmIco-Show");s.addClass(b.CONTEXTMENU_PREFIX+"MnuItm-Show")}else{r.addClass(b.CONTEXTMENU_PREFIX+"MnuItmIco-Hide");s.addClass(b.CONTEXTMENU_PREFIX+"MnuItm-Hide")}}else{var w=e.icon(v);if(w){w=i+w;var x=$(document.createElement('div')).addClass(b.CONTEXTMENU_PREFIX+"MnuItmIco").appendTo(s);var y=$(document.createElement('img')).attr('src',w).appendTo(x)}else{s.addClass(b.CONTEXTMENU_PREFIX+"MnuItm-Hide")}}var z=$(document.createElement('div')).addClass(b.CONTEXTMENU_PREFIX+"MnuItmTxt").appendTo(s);z.text(t);s.attr('id',q);var _=this;s.click(function(A){if(p.clickHandler){p.clickHandler.apply(p.scope)}var B={};var H=true;var I=p.scope;switch(I.name()){case M.LEGEND.name:B['legend']=I.isChecked(v);break;case M.DATALABELS.name:B['datalabels']=I.isChecked(v);break;case M.DIRECTION.name:B['direction']=I.getDirection();break;case M.STACKING.name:B['stacking']=I.getStacking();break;default:H=false;break}if(H){_._dispatchEvent(new d(d.CHANGE_CONTEXT_MENU,_,B))}_.hide()})};n.prototype.show=function(p){var s=this._redrawMenuItems();if(p){var e=this._div$.innerWidth();var i=this._menu$.outerWidth();var j=p.pageX;if(e<i+j){j=e-i}var t=p.pageY;var q=this._div$.parent().innerHeight();var r=this._menu$.outerHeight();if(q<r+t){t=q-r}t+=this._div$.parent().offset().top;j+=this._div$.parent().offset().left;this._menu$.css({position:"fixed",left:j+"px",top:t+"px"})}if(s){this._menu$.show();document.removeEventListener("mousedown",$.proxy(this._handleMousedownEvent,this));document.addEventListener("mousedown",$.proxy(this._handleMousedownEvent,this),true)}};n.prototype._handleMousedownEvent=function(e){var i=e.target.id;if(i&&o[i]){return}if(a.isIE()&&i==""){i=e.target.parentNode.id}var j=this._getCusMenuItem(i);if(j){return}this.hide()};n.prototype.hide=function(){this._menu$.hide()};n.prototype.save=function(){var r={'isMNDVisible':this._vizModel().isMNDVisible()};return r};n.prototype.load=function(v){var i=(v['isMNDVisible']===true);if(i&&this._vizModel()){this._vizModel().isMNDVisible(i)}};n.prototype.addMenuItem=function(e){var i=e.name();var j=this._getCusMenuItem(i);if(j){delete this._getCusMenuItem[i]}this._cusMenuItems[i]=e};n.typeHelp=function(v,e){var p=[];for(var i=0;i<e.length;i++){for(var j=0;j<e[i].length;j++){var q=e[i][j].toUpperCase();if(M[q].supportType[v]){p.push(e[i][j])}}if((i!==e.length-1)){p.push("blank")}}return p};return n});define('sap/viz/controls/custombutton/CustomButtonEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var C=function(t,a,d){C.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.custombutton.CustomButtonEvent"};O.extend(C,E);C.CLICK_CUSTOM_BUTTON="clickCustomButton";return C});define('sap/viz/controls/custombutton/CustomButton',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/custombutton/CustomButtonEvent'],function($,O,U,V,G,C,a){var b=function(d,u){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.custombutton.CustomButton";this._div=d;this._uiConfig=u?u:G.defaultUIConfig(G.DEFAULT_UICONFIG_TYPE_CUSTOMBUTTON);this._button$=null;this._icon$=null;this._createChildren()};O.extend(b,V);b.prototype._createChildren=function(){if(!(this._uiConfig.visible===false)){this._button$=$(document.createElement("div")).appendTo(this._div);this._button$.addClass(C.CUSTOMBUTTON_PREFIX+"button");this._icon$=$(document.createElement("div")).appendTo(this._button$);if(this._uiConfig.title){this.setTitle(this._uiConfig.title)}var _=this;this._button$.click(function(e){var c=_._button$.offset();_._dispatchEvent(new a(a.CLICK_CUSTOM_BUTTON,_,c))})}};b.prototype.setIcon=function(i){if(arguments.length>0){this._icon$.removeClass();this._icon$.addClass(i);return this}};b.prototype.setTitle=function(t){if(arguments.length>0){this._icon$.attr("title",t);return this}};return b});define('sap/viz/controls/frame/VizFrameEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var V=function(t,a,d){V.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.VizFrameEvent"};O.extend(V,E);V.FILTERS_CHANGED="filtersChanged";V.CONTEXT_MENU_CHANGED='contextMenuChanged';V.ENTER_FULL_SCREEN="enterFullScreen";V.EXIT_FULL_SCREEN="exitFullScreen";V.ADD_COMMENT='addComment';V.ADD_FILTER='addFilter';V.REQUEST_LEGEND_COLOR='chooseLegendColors';V.POPUP_CHART_EDITOR='popupChartEditor';return V});define('sap/viz/controls/frame/chartEditor/ChartEditorEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments)};O.extend(F,E);F.FILTER_CLICKED="filterClicked";F.EXCLUDE_CLICKED="excludeClicked";return F});define('sap/viz/controls/frame/chartEditor/ChartEditor',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/frame/chartEditor/ChartEditorEvent'],function($,C,L,O,U,a){var b=function(d,c){b.superclass.constructor.apply(this,arguments);this._dom$=$(d);this._createChildren(c)};O.extend(b,U);b.prototype._createChildren=function(c){var _=this;this._dom$.addClass(C.FRAME_PREFIX+'editor');var d=$('<div/>').appendTo(this._dom$);d.addClass(C.FRAME_PREFIX+'editor-main');d.addClass(C.COMMON_PREFIX+'popUp');var e=$('<div/>').appendTo(d).addClass(C.FRAME_PREFIX+'editor-header');var f=$('<h3/>').appendTo(e).text(L.get("VIZ_FRAME_CHART_EDITOR"));var g=$('<div/>').appendTo(d).addClass(C.FRAME_PREFIX+'editor-content');var h=$('<img/>').appendTo(g).addClass(C.FRAME_PREFIX+'editor-content-img');h.attr('src',c+'/chartEditorPH.png');var i=$('<div/>').appendTo(d).addClass(C.FRAME_PREFIX+'editor-footer');var j=$('<button/>').appendTo(i).text(L.get("VIZ_COMMON_OK"));j.addClass(C.FRAME_PREFIX+'editor-footer-button');j.addClass(C.COMMON_PREFIX+'button');var k=$('<button/>').appendTo(i).text(L.get("VIZ_COMMON_CANCEL"));k.addClass(C.FRAME_PREFIX+'editor-footer-button');k.addClass(C.COMMON_PREFIX+'button');var l=$('<div/>').appendTo(d);l.addClass(C.COMMON_PREFIX+'havanaSharedSprite16');l.addClass(C.FRAME_PREFIX+'editor-close');var m=function(){_._dispatchEvent(new a(a.EDIT_CANCELED,this));_._dispatchEvent(new a(a.EDITOR_CLOSED,this));_._dom$.detach()};var n=function(){_._dispatchEvent(new a(a.EDIT_CONFIRMED,this,{}));_._dispatchEvent(new a(a.EDITOR_CLOSED,this));_._dom$.detach()};j.click(n);k.click(m);l.click(m)};return b});define('sap/viz/controls/frame/chartEditor/ChartEditorPlugin',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/frame/chartEditor/ChartEditor','sap/viz/controls/frame/chartEditor/ChartEditorEvent'],function($,C,a,b){var c=function(d,v,u){this.__className="sap.viz.controls.frame.chartEditor.ChartEditorPlugin";this._vizFrame=v;this._uiConfig=u;this._div=d;this._chartEditor=null};c.prototype.validateSize=function(w,h){this._locateChartEditor()};c.prototype.destroy=function(){if(this._chartEditor){this._chartEditor.removeAllEventListeners();this._chartEditor.destroy();this._chartEditor=null}$(this._div).remove()};c.prototype._popUpEditor=function(){var d=$(this._div);var e=this._uiConfig.chartEditorAssetFolderPath?this._uiConfig.chartEditorAssetFolderPath:'../src/controls/frame/assets';d.children().addClass(C.COMMON_PREFIX+'blur');var f=$(document.createElement('div')).appendTo(d);this._chartEditor=new a(f[0],e);this._locateChartEditor();this._chartEditor.addEventListener(b.EDITOR_CLOSED,function(g){d.children().removeClass(C.COMMON_PREFIX+'blur')})};c.prototype._locateChartEditor=function(){if(this._chartEditor){var d=$(this._div);var e=$(this._chartEditor._dom);e.css({'left':(d.width()-e.width())/2,'top':Math.min(120,(d.height()-e.height())/2)})}};return c});define('sap/viz/controls/frame/menu/CommentMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,a,M,b){var c=function(d,e){c.superclass.constructor.apply(this,[M.COMMENT.name,M.getText(M.COMMENT.text),this._iconFunc,this._isVisibleFunc,this._clickHandler]);this.__className="sap.viz.controls.frame.menu.CommentMenuItem";this._chartModelProvider=d;this._chartProxyProvider=e};O.extend(c,b);c.prototype._isVisibleFunc=function(){var d=this._getType();var s=this._chartProxyProvider.getSelection();var h=(s&&s.length>0);return(h&&M.COMMENT.supportType[d])};c.prototype._getType=function(){return this._chartModelProvider().type()};c.prototype.getDirection=function(){return a.getDirection(this._getType())};return c});define('sap/viz/controls/filterbar/Tooltip',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/managers/LangManager'],function($,C,A,L){var d=1000;var o={x:8,y:16};var T=function(a){this._div=a;this._showing=false;this._tooltip$=null};T.prototype._getTitle=function(f){if(f.getType()!==A.VALUE_TYPE){return f.filterTitle()}var c=f.values().length;var t=f.filterName()+' ('+c+' ';if(f.isExcluded()){t+=L.get('VIZ_FILTERBAR_ITEMS_EXCLUDED')}else{t+=L.get('VIZ_FILTERBAR_ITEMS_INCLUDED')}t+=')';return t};T.prototype._showTooltip=function(f){if(!this._showing){return}if(!this._tooltip$){this._tooltip$=$(document.createElement('div')).appendTo(this._div)}else{this._tooltip$.empty()}var t=this._tooltip$;t.addClass(C.FILTERBAR_PREFIX+'filter-item-tooltip');if(f.isGlobalFilter()){var g=L.get('VIZ_FILTERBAR_GLOBAL_FILTER');var a=$(document.createElement('sapn')).appendTo(t).text(g);a.addClass(C.FILTERBAR_PREFIX+'filter-item-tooltip-globalfilter')}var b=$(document.createElement('sapn')).appendTo(t).text(this._getTitle(f));b.addClass(C.FILTERBAR_PREFIX+'filter-item-tooltip-title');var c=$(document.createElement('span')).appendTo(t);c.addClass(C.FILTERBAR_PREFIX+'filter-item-tooltip-value');if(f.isExcluded()){c.addClass(C.FILTERBAR_PREFIX+'filter-exclude')}c.text(f.filterContent());var l=this._position.left+o.x;var r=this._div.offset().left+this._div.outerWidth();l=Math.min(l,r-t.outerWidth());t.offset({"left":l,"top":this._position.top+o.y})};T.prototype.show=function(f,p){this._position=p;if(this._showing){return}this._showing=true;var _=this;setTimeout(function(){_._showTooltip(f)},d)};T.prototype.position=function(p){this._position=p};T.prototype.hide=function(){this._showing=false;if(this._tooltip$){this._tooltip$.remove();this._tooltip$=null}};return T});define('sap/viz/controls/filterbar/FilterBarEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar.FilterBarEvent"};O.extend(F,E);F.DELETE_FILTER="deleteFilter";F.HEIGHT_CHANGED="heightExtend";return F});define('sap/viz/controls/filterbar/FilterBar',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/views/feed/FeedList','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/helpers/Rectangle','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/DateRangeFilter','sap/viz/controls/common/filter/NumericRangeFilter','sap/viz/controls/common/filter/ValueFilter','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/filterbar/Tooltip','sap/viz/controls/filterbar/FilterBarEvent'],function($,V,G,C,E,a,D,L,O,U,b,F,c,A,d,R,f,g,N,h,j,T,k){var l=function(e,u){l.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar.FilterBar";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_filterbar_control');this._div=e;this._uiConfig=u?u:G.defaultUIConfig(G.DEFAULT_UICONFIG_TYPE_FILTERBAR);this._containerCurrentPosition=0;this._allAnalyses=null;this._settings=null;this._visualLines=2;this._description$=null;this._layout$=null;this._headerVisible=false;this._isFullScreen=false;this._tooltip=new T(this._div);this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_filterbar_control')};var m=0.8;var n=42;var o=190;O.extend(l,V);l.VERSION="1.0";l.TYPE_STRING='string';l.TYPE_INTEGER='integer';l.TYPE_NUMBER='number';l.TYPE_DATE='date';var I=16;l.prototype.filterItems=function(e){if(arguments.length>0){this._vizModel().filterItems(e);return this}else{return this._vizModel().filterItems()}};l.prototype.save=function(){var e={};e['filterItems']=j.toJSON(this._vizModel().filterItems());return e};l.prototype.load=function(v){var e=j.fromJSON(v.filterItems);if(e&&e.length>0){this._vizModel().filterItems(e)}};l.prototype._onVizModelChanged=function(e){if(e.data.filterChanged){this._filtersChanged()}};l.prototype._createChildren=function(){var _=this;var i=this._uiConfig.module;if(i&&!(i.visible===false)){this._headerVisible=true;this._plus$=$(document.createElement("div")).appendTo(this._div);this._plus$.addClass(C.COMMON_PREFIX+'havanaVXTabSprite16');this._plus$.addClass(C.FILTERBAR_PREFIX+'header-plus');this._plus$.click(function(e){_._plusClickHandler(e)});var p=i.label?i.label:L.get('VIZ_FILTERBAR_DESCRIPTION');this._description$=$(document.createElement("span")).text(p).appendTo(this._div);this._description$.addClass(C.FILTERBAR_PREFIX+"description")}this._layout$=$(document.createElement('div')).appendTo(this._div);this._layout$.addClass(C.FILTERBAR_PREFIX+'layout');this._layout$.addClass(C.COMMON_PREFIX+'scrollable');this._layout$.addClass(C.COMMON_PREFIX+'scrollable-y');this._layout$.css({'max-height':this._visualLines*n});this._filterItemsContainer$=$(document.createElement('div')).appendTo(this._layout$);this._filterItemsContainer$.addClass(C.FILTERBAR_PREFIX+'filterItems-container');if(this._headerVisible===true){this._layout$.hide()}else{this._layout$.css({'left':'0px'})}$(this._div).droppable({tolerance:'pointer',accept:'.'+D.DRAGGABLE_CLASS_ANALYSIS,over:$.proxy(this._dragOver,this),out:$.proxy(this._dragOut,this),drop:$.proxy(this._drop,this)})};l.prototype.analysisObjectsForPicker=function(e){if(arguments.length>0){this._allAnalyses=e}else{return this._allAnalyses}};l.prototype._plusClickHandler=function(e){var i=document.createElement('div');var p=new F(i,this._allAnalyses,d.DIMENSION,this._vizModel().filterItems());p.addEventListener(c.ITEM_SELECTED,function(r){var s=r.data.selectedItem;if(s){this._addFilterItem(s)}},this);var q=this._plus$.offset();p.open({x:q.left+40,y:q.top,shelfWidth:0},'right')};l.prototype._getDroppableAnalysisObject=function(t){if(!t||!t.analysisObject){return null}var e=t.analysisObject;var i=e.type();var p=j.getFilterInfo(e);if(A.compatible(A.DIMENSION,i)&&!j.isFilterItemExisted(this._vizModel(),p.id,p.hierarchyLevelId)&&i!==A.MND){return e}else{return null}};l.prototype._dragOver=function(e,u){var t=D.instance().getAnalysisToken(u.helper);if(!t){return}var i=this._getDroppableAnalysisObject(t);if(i){t.currentAction(b.ACCEPT_AS_COPY)}else{t.currentAction(b.DENY)}};l.prototype._dragOut=function(e,u){var t=D.instance().getAnalysisToken(u.helper);if(t){t.currentAction(b.DENY)}};l.prototype._drop=function(e,u){var t=D.instance().getAnalysisToken(u.helper);if(!t){return}var i=this._getDroppableAnalysisObject(t);if(i){t.currentAction(b.ACCEPT_AS_COPY);this._addFilterItem(i)}else{t.currentAction(b.DENY)}t.dropTarget(this._dom)};l.prototype._addFilterItem=function(e){var i=j.getFilterInfo(e);var p=i.name;var q=i.id;var r=e.dataType();var s;switch(r){case l.TYPE_INTEGER:case l.TYPE_NUMBER:s=new N(q,p);break;case l.TYPE_DATE:s=new g(q,p);break;case l.TYPE_STRING:default:s=new h(q,p);if(i.hierarchyLevelId){s.hierarchyLevelId=i.hierarchyLevelId}break}var t=this._vizModel().filterItems();t.push(s);this._vizModel().filterItems(t);this._dispatchRequestFilterEvent(s)};l.prototype._filtersChanged=function(){if(this._filterItemsContainer$){this._filterItemsContainer$.empty()}var e=this._vizModel().filterItems();if(!e||e.length==0){this._updateDescription();return this}if(this._headerVisible===true){this._description$.hide();this._layout$.show()}this._updateFilterItemContainer()};l.prototype._dispatchRequestFilterEvent=function(e){var _=this;var v=function(q){var r=_._vizModel().filterItems();if(e.isEmpty()){var s=r.indexOf(e);if(s>=0){r.splice(s,1);_._vizModel().filterItems(r);_._tooltip.hide()}return}if(q){_._vizModel().filterItems(r)}};var i=this._filterItemsContainer$.select('#'+e.id());var p={bounds:R.toJSON(R.parseDOM(i)),filterName:e.filterName(),analysisObjectId:e.analysisObjectId(),filterItem:e,validate:v};this._dispatchEvent(new a(E.REQUEST_FILTER_VALUES,this,p))};l.prototype._createFilterTitle=function(e,i){if(e.getType()!==f.VALUE_TYPE){var p=$(document.createElement('span')).appendTo(i).text(e.filterTitle());p.addClass(C.FILTERBAR_PREFIX+'filter-item-text');p.addClass(C.FILTERBAR_PREFIX+'range-filter-item-text');return}var t=$(document.createElement('div')).appendTo(i);var q=$(document.createElement('div')).appendTo(t).text(e.filterName()).css("display",'inline');q.addClass(C.FILTERBAR_PREFIX+'filter-item-text').attr('id','filterName');var r=$(document.createElement('div')).appendTo(t).css("display",'inline').attr('id','countInfo');r.addClass(C.FILTERBAR_PREFIX+'filter-item-info');$(document.createElement('span')).appendTo(r).text('(');var s=$(document.createElement('span')).appendTo(r).text(e.values().length);if(e.isExcluded()){s.addClass(C.FILTERBAR_PREFIX+'filter-exclude')}$(document.createElement('span')).appendTo(r).text(')')};l.prototype._createFilterItem=function(i){var p=i.filterName();var _=this;var q=document.createElement('div');var r=$(q).appendTo(this._filterItemsContainer$);r.attr({'id':i.id()});this._createFilterTitle(i,r);if(i.isGlobalFilter()){r.addClass(C.FILTERBAR_PREFIX+'global-filter-item')}else{r.addClass(C.FILTERBAR_PREFIX+'filter-item');r.click(function(){_._dispatchRequestFilterEvent(i)});var s=$(document.createElement('div')).appendTo(r);s.addClass(C.FILTERBAR_PREFIX+'delete-icon');s.addClass(C.COMMON_PREFIX+'UVBSharedSprite');s.click(function(e){_._removeFilterItem(i);_._dispatchEvent(new k(k.DELETE_FILTER,_));_._tooltip.hide();e.stopPropagation()})}return r};l.prototype._stringToNumber=function(v){if(!v){return 0}return parseInt(v.replace('px',''))};l.prototype.validateSize=function(){var e=$('.'+C.FILTERBAR_PREFIX+'filter-item');if(e.length==0){return this}e.css({'width':o});this._updateFilterItemsWidth()};l.prototype._needAdjust=function(){var e=this._filterItemsContainer$.innerHeight();var i=e>n;if(i){return true}else{return false}};l.prototype._updateFilterItemContainer=function(){var e=this._vizModel().filterItems();var i;for(i=0;i<e.length;i++){this._createFilterUI(e[i])}this._updateFilterItemsWidth();return this};l.prototype._createFilterUI=function(e){var i=e.filterName();var p;var _=this;p=this._createFilterItem(e);p.mouseover(function(q){_._tooltip.show(e,{left:q.clientX,top:q.clientY});$('.'+C.FILTERBAR_PREFIX+'filter-values',q.currentTarget).addClass(C.FILTERBAR_PREFIX+'filter-values-active')});p.mousemove(function(q){_._tooltip.position({left:q.clientX,top:q.clientY})});p.mouseout(function(q){_._tooltip.hide();$('.'+C.FILTERBAR_PREFIX+'filter-values',q.currentTarget).removeClass(C.FILTERBAR_PREFIX+'filter-values-active')});this._addFilterValues(e,p)};l.prototype._updateFiltersTitle=function(){var u=function(i,e){var p=$('#filterName',e);if(p.length===0){return}p.css({'width':'auto'});var t=p.parent();var q=$('#countInfo',e);var r=p.position();var s=p.width()+r.left+2;var v=t.width()-I;var w=q.width();var x=Math.min(s,v-w);p.css({'width':x-r.left});q.css({'left':x})};$('.'+C.FILTERBAR_PREFIX+'filter-item').each(u);$('.'+C.FILTERBAR_PREFIX+'global-filter-item').each(u)};l.prototype._updateFilterItemsWidth=function(){var e;if(this._filterItemsContainer$.children().length===0){this._updateDescription();return this}if(!this._needAdjust()){e={'height':n};this._dispatchEvent(new k(k.HEIGHT_CHANGED,this,e));this._updateFiltersTitle();return this}var i=0;while(this._needAdjust()&&i<2){i++;var p=$('.'+C.FILTERBAR_PREFIX+'filter-item');var w=$($('.'+C.FILTERBAR_PREFIX+'filter-item')[0]).outerWidth()*m;p.css({'width':w})}if(this._needAdjust()){e={'height':this._avaliableHeightForHeader()};this._dispatchEvent(new k(k.HEIGHT_CHANGED,this,e));if(e.height<this._filterItemsContainer$.outerHeight()){$(this._layout$).scrollTop(this._filterItemsContainer$.outerHeight())}}if(!this._needAdjust()){e={'height':n};this._dispatchEvent(new k(k.HEIGHT_CHANGED,this,e))};this._updateFiltersTitle();return this};l.prototype._avaliableHeightForHeader=function(){var e=this._filterItemsContainer$.outerHeight();var p=n-2;var q=n;var r=this._visualLines-1;for(var i=2;i<=this._visualLines;i++){if(p*i<=e&&e<=q*i){r=i-1;break}}var s=2;return r*p+q+s};l.prototype._addFilterValues=function(e,i){var v=e.filterContent();var p=i.find("span[id='values']");if(p.length===0){p=$(document.createElement('span')).appendTo(i);p.addClass(C.FILTERBAR_PREFIX+'filter-values');p.attr({id:'values'})}p.text(v);var q=C.FILTERBAR_PREFIX+'filter-exclude';if(e.isExcluded()){p.addClass(q)}else{p.removeClass(q)}};l.prototype._removeFilterItem=function(e){var i=this._vizModel().filterItems().slice(0);var p=i.indexOf(e);i.splice(p,1);this._vizModel().filterItems(i);return i};l.prototype._updateDescription=function(){var e=this._vizModel().filterItems();if(e.length===0&&this._headerVisible===true){this._description$.show();this._layout$.hide()}};return l});define('sap/viz/controls/frame/views/FilterMenuEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.views.FilterMenuEvent"};O.extend(F,E);F.FILTER_CLICKED="filterClicked";F.EXCLUDE_CLICKED="excludeClicked";return F});define('sap/viz/controls/frame/views/FilterMenu',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/frame/views/FilterMenuEvent'],function($,O,U,C,L,F){var a=function(d,u){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.views.FilterMenu";this._div=d;this._uiConfig=u;this._container=null;this._createChildren()};O.extend(a,U);a.prototype._createChildren=function(){this._container=$(document.createElement('div')).appendTo(this._div);$(this._container).addClass(C.FRAME_PREFIX+"filtermenu");var b=$(document.createElement('div')).appendTo(this._container);var f=$(document.createElement('div')).appendTo(b);f.addClass(C.COMMON_PREFIX+'havanaSharedSprite16');f.addClass(C.FRAME_PREFIX+'filtermenu-filter-icon');var c=$(document.createElement('div')).appendTo(b);c.text(L.get('VIZ_FRAME_FILTERMENU_FILTER'));b.click($.proxy(function(){this._dispatchEvent(new F(F.FILTER_CLICKED),this)},this));var d=$(document.createElement('div')).appendTo(this._container);var e=$(document.createElement('div')).appendTo(d);e.addClass(C.COMMON_PREFIX+'havanaSharedSprite16');e.addClass(C.FRAME_PREFIX+'filtermenu-exclude-icon');var g=$(document.createElement('div')).appendTo(d);g.text(L.get('VIZ_FRAME_FILTERMENU_EXCLUDE'));$(d).click($.proxy(function(){this._dispatchEvent(new F(F.EXCLUDE_CLICKED),this)},this))};a.prototype.show=function(s,b){if(s||b){$(this._container).css({bottom:2+'px','visibility':'visible','display':'block'});$(this._container).show()}else{$(this._container).hide()}};a.prototype.hide=function(){$(this._container).hide()};a.prototype.size=function(s){$(this._container).css({left:(s.width-$(this._container).outerWidth())/2+'px'})};return a});define('sap/viz/controls/chart/views/TitleContextMenu',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/OSUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','jquery'],function(O,a,U,C,$){var b=function(d,i){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.TitleContextMenu";this._div=d;this._menu=null;this._visible=true;this._shown=false;this._cusMenuItems=i;this._createContextMenu();this._mousedownHandler=$.proxy(this._handleMousedownEvent,this)};O.extend(b,U);b.prototype._createContextMenu=function(){var _=this;this._menu=document.createElement('div');$(this._menu).addClass(C.PREFIX+'contextmenu');$(this._div).append(this._menu);this.hide();this._ul=document.createElement('ul');$(this._ul).addClass([C.CONTEXTMENU_PREFIX+'list',C.CONTEXTMENU_PREFIX+'list-hovered'].join(' '));$(this._ul).appendTo(this._menu)};var E=[];b.prototype._getCusMenuItem=function(n){if(this._cusMenuItems&&this._cusMenuItems.length>0){for(var i=0;i<this._cusMenuItems.length;i++){var m=this._cusMenuItems[i];if(m.name===n){return m}}}return null};b.prototype.updateMenu=function(){var v=[];$(this._ul).empty();for(var i=0;i<this._cusMenuItems.length;i++){var c=this._cusMenuItems[i];this._createMenuItemUI(c)}};b.prototype._createMenuItemUI=function(c){var t=c.text;var e={};e.clickHandler=c.clickHandler;e.scope=c.scope;var d=c.enableValidator.apply(c.scope);var i=c.name;var l=document.createElement('li');var m=document.createElement('div');$(l).addClass(C.CONTEXTMENU_PREFIX+"MnuItm");$(m).addClass(C.CONTEXTMENU_PREFIX+"MnuItm");$(l).appendTo(this._ul);$(m).appendTo(l);var T=$("<div>",{"class":C.CONTEXTMENU_PREFIX+"MnuItmTxt"});$(T).appendTo(m);$(T).text(t);if(d){$(T).css("color","black")}else{$(T).css("color","grey")}m.id=i;var _=this;if(d){$(m).click(function(f){if(e.clickHandler){e.clickHandler.apply(e.scope)}_.hide()})}else{$(m).click(function(f){_.hide()})}};b.prototype.isShown=function(){return this._shown};b.prototype.show=function(o){this.updateMenu();if(o&&o.position){var p=$(this._div).innerWidth();var m=$(this._menu).outerWidth();var l=o.position.pageX;if(p<m+l){l=p-m}var t=o.position.pageY;var c=$(this._div).parent().innerHeight();var d=$(this._menu).outerHeight();if(c<d+t){t=c-d}t+=$(this._div).parent().offset().top;l+=$(this._div).parent().offset().left;$(this._menu).css({position:"fixed",left:l+"px",top:t+"px"})}$(this._menu).css('visibility','visible');this._shown=true;document.removeEventListener("mousedown",this._mousedownHandler,true);document.addEventListener("mousedown",this._mousedownHandler,true)};b.prototype._handleMousedownEvent=function(e){var i=e.target.id;if(a.isIE()&&i==""){i=e.target.parentNode.id}var c=this._getCusMenuItem(i);if(c){return}this.hide()};b.prototype.hide=function(){$(this._menu).find('*').removeData().off();$(this._menu).css('visibility','hidden');this._shown=false};return b});define('sap/viz/controls/chart/views/TitleEditor',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/OSUtil','sap/viz/controls/common/events/Event','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/helpers/Rectangle','sap/viz/controls/chart/views/TitleContextMenu','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/ChartTypeUtil',],function($,C,O,a,E,V,R,T,L,b){var c=function(d,u){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.TitleEditor";this._targetDiv=d;this._uiconfig=u;this._editing=false;this.createChildren()};O.extend(c,V);c.prototype.createChildren=function(){var p=this._targetDiv;this._div=$(document.createElement("DIV"));this._textInput=$('<input type="text" spellcheck="false"/>');this._textInput.addClass(C.CHART_PREFIX+'title-text');this._textInput.attr('value',this._vizProxy().getTitleText());this._settingBtn=$(document.createElement("div"));this._settingBtn.addClass(C.CHART_PREFIX+'title-button');var s=$(document.createElement("div")).appendTo(this._settingBtn);s.addClass(C.COMMON_PREFIX+"UVBSharedSprite");s.addClass(C.CHART_PREFIX+"setting-icon");this._settingBtn.css({'visibility':'hidden'});var m=[{text:L.get('VIZ_CHART_TITLE_CONTEXT_MENU_EDIT'),name:'edit',clickHandler:this.enterEditMode,enableValidator:function(){return true},scope:this},{text:L.get('VIZ_CHART_TITLE_CONTEXT_MENU_RESTORE'),name:'restore',clickHandler:this.restore,enableValidator:function(){return this.edited()},scope:this}];this._contextMenu=new T(p,m);this._div.append(this._textInput).append(this._settingBtn).appendTo(p);var _=this;document.addEventListener("mousedown",function(e){_._documentMouseDownHandler(e)},true);this._settingBtn.click(function(e){_._popupContextMenu()});this._div.bind("mouseover",function(){_.mouseOver()}).bind("mouseout",function(){_.mouseOut()}).bind("dblclick",function(){_.dblClick()}).bind('keypress',function(e){if(e.keyCode==13){_._documentKeyPressHandler(e);e.preventDefault()}})};c.prototype.editable=function(){return!this._vizProxy().isFakeChart()};c.prototype.edited=function(){return this._vizProxy().isTitleCustomized()};c.prototype.restore=function(){this._editing=false;this._vizProxy().restoreTitleText()};c.prototype.enterEditMode=function(){if(this.editable()){this._settingBtn.css({'visibility':'hidden'});this._editing=true;this._layoutTitleDiv();this._textInput.css({'display':'block'});this._textInput.attr('value',this._vizProxy().getTitleText());this._textInput.focus().select()}};c.prototype._layoutTitleDiv=function(){var d=this._vizProxy().getTitleZone();if(d&&d.length>0){var s=this._targetDiv.scrollLeft();var l=d[0][0],t=d[0][1],w=d[2][0]-d[0][0],h=d[2][1]-d[0][1];var e="position:absolute;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;";if(this._editing){var p=8;e+="left:"+s+"px;top:"+(t-p)+"px;width:100%;"+"height:"+(h+p*2)+"px;";this._div.addClass(C.CHART_PREFIX+'title-edit')}else{e+="left:"+l+"px;top:"+t+"px;width:"+(w+16)+"px;height:"+h+"px;";if(a.isIE()){e+="background-color:rgba(0,0,0,0)"}this._div.removeClass(C.CHART_PREFIX+'title-edit')};this._div.attr('style',e)}};c.prototype.init=function(){if(b.supportTitle(this._vizModel().type())){this.size();this._show()}else{this._hide()}};c.prototype._show=function(){this._div.css({'visibility':'visible'})};c.prototype._hide=function(){this._div.css({'visibility':'hidden'})};c.prototype.dblClick=function(){if(this.editable()&&!this._editing){this.enterEditMode()}};c.prototype._popupContextMenu=function(){var d=this._vizProxy().getTitleZone();var l=d[0][0],t=d[0][1],w=d[2][0]-d[0][0],h=d[2][1]-d[0][1];var p={pageX:l+w-95,pageY:t+h};this._contextMenu.show({position:p})};c.prototype.mouseOver=function(){if(this.editable()&&!this._editing){this._layoutTitleDiv();this._settingBtn.css({'visibility':'visible'})}};c.prototype.mouseOut=function(){if(this.editable()&&!this._editing){this._layoutTitleDiv();if(a.isIE()){this._div.css({'border-width':'0px','background-color':'rgba(0,0,0,0)'})}else{this._div.css({'border-width':'0px','background-color':'transparent'})}this._textInput.css({'display':'none'});this._textInput.blur();if(!this._contextMenu.isShown()){this._settingBtn.css({'visibility':'hidden'})}}};c.prototype._documentMouseDownHandler=function(e){if(this._editing&&e.target!==this._textInput[0]){this._commitTitleEdit();e.stopPropagation()}if(this._contextMenu.isShown()&&e.target!=this._settingBtn[0]&&e.target.parentElement!=this._settingBtn[0]){this._settingBtn.css({'visibility':'hidden'})}};c.prototype._documentKeyPressHandler=function(e){if(this._editing&&e.target===this._textInput[0]){this._commitTitleEdit();e.stopPropagation()}};c.prototype._onVizModelChanged=function(){this.init()};c.prototype._commitTitleEdit=function(){this._editing=false;var t=this._textInput[0].value;if(t!=this._vizProxy().getTitleText()){this._vizProxy().setTitleText(t)}this.mouseOut()};c.prototype.size=function(){this._layoutTitleDiv();if(this._contextMenu.isShown()){this._popupContextMenu()}};c.prototype.load=function(){this.init()};return c});define('sap/viz/controls/common/utils/Serialization',['sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/chart/ghost/IncompleteGhost','sap/viz/controls/common/managers/LangManager','sap/viz/controls/Version'],function(F,A,a,b,u,G,I,L,V){var S={};S.TypeConst={FlatTableDataset:'Flattable',CrosstableDataset:'Crosstable',RawDataset:'JSON'};S.migrate=function(v){var r=u.clone(v);var c=r['version'];if(c==='1.0'){var f={chart:{}};var m=r['chart']['vizModel'];if(m){f['chart']['type']=m['vizType'];f['chart']['feedingItems']=m['feedingItems'];f['filterBar']={};f['filterBar']['filterItems']=m['filterItems'];f['contextMenu']={};f['contextMenu']['isMNDVisible']=m['isMNDVisible']}var i=r['chart']['vizInstance'];if(i){f['chart']['vizInstance']=i}var d=r['comments'];if(d){f['annotation']=d}f['version']=V.VERSION;r={};r['vizFrame']=f}return r};S.getFeeds=function(v){var f=null;var c=S._getValue(v,['vizFrame','chart','feedingItems']);var d=S._getValue(v,['vizBuilder','feedingPanel','feedingItems']);if(c){f=c}else if(d){f=d}if(f==null){return[]}var e=F.fromJSON(f);return e};S.updateFeeds=function(v,f){var c=F.toJSON(f);S._setValue(v,['vizFrame','chart','feedingItems'],c);S._setValue(v,['vizBuilder','feedingPanel','feedingItems'],c);return v};S.getFilters=function(v){var f=S._getValue(v,['vizFrame','filterBar','filterItems']);if(f==null){return[]}var c=b.fromJSON(f);return c};S.updateFilters=function(v,f){var c=b.toJSON(f);S._setValue(v,['vizFrame','filterBar','filterItems'],c);return v};S.removeDataset=function(v){var c=S._getValue(v,['vizFrame','chart','vizInstance']);if(c){delete c['data']}return v};S.emptyDataset=function(v){var d=S._getValue(v,['vizFrame','chart','vizInstance','data']);if(d){S._emptyDataset(d)}return v};S._emptyDataset=function(d){if(!d){return}if(d instanceof Array){for(var i=0;i<d.length;i++){S._emptyDataset(d[i])}}else{var t=d['type'];var c=d['val'];var e={};var f={};if(t===S.TypeConst.CrosstableDataset){e=new sap.viz.api.data.CrosstableDataset();e.data(c);f=e.toJSON({emptyDataset:true}).data}else if(t===S.TypeConst.CrosstableDataset.FlatTableDataset){e=new sap.viz.api.data.FlatTableDataset(feedData);f=e.toJSON({emptyDataset:true}).data}else if(t===S.TypeConst.CrosstableDataset.RawDataset){f={}}else{throw L.get('VIZ_COMMON_SERIALIZATION_FAILED')+L.get('VIZ_COMMON_INVALID_SERIALIZATION_PACKAGE')}d['val']=f}};S.updateDataset=function(v,d){var c=S._getValue(v,['vizFrame','chart','vizInstance']);if(c){c['data']={};S._updateDataset(c['data'],d)}return v};S._updateDataset=function(d,c){if(!d||!c){return}if(c instanceof Array){for(var i=0;i<c.length;i++){var e=c[i];S._updateDataset(d[i],e)}}else if(c instanceof sap.viz.api.data.CrosstableDataset){d['type']=S.TypeConst.CrosstableDataset;d['val']=c.data()}else if(c instanceof sap.viz.api.data.FlatTableDataset){d['type']=S.TypeConst.CrosstableDataset.FlatTableDataset;d['val']=c.toJSON()}else{d['type']=S.TypeConst.CrosstableDataset.RawDataset;d['val']=c}};S.convertToVizSerialization=function(v){var c=S._getValue(v,['vizFrame','vizInstance']);if(c){return u.clone(c)}return null};S.updateProperties=function(v,p){S._setValue(v,['vizFrame','chart','vizInstance','properties'],p);return v};S.getProperties=function(v){var p=S._getValue(v,['vizFrame','chart','vizInstance','properties']);return p||{}};S.updateAnalysisObjectLabels=function(v,c){if(!c){return v}var f=S.getFeeds(v)||[];var d=S.getFilters(v)||[];for(var i=0;i<f.length;i++){var e=f[i];var g=e.values();if(g){for(var j=0;j<g.length;j++){var o=g[j];for(var k=0;k<c.length;k++){var n=c[k];if(o&&n&&o.id()===n.id()){o.name(n.name());var h=o.hierarchyLevels();var m=n.hierarchyLevels();if(h&&m&&(h.length===m.length)){for(var l=0;l<m.length;l++){var p=h[l];var q=m[l];if(p&&q&&p.id()===q.id()){p._name=q.name();if(p._analysis&&q._analysis&&p._analysis.id()===q._analysis.id()){p._analysis.name(q._analysis.name())}}}}break}}}e.values(g)}}for(var i=0;i<d.length;i++){var e=d[i];if(e){if(e.getType()===a.NUMERIC_RANGE_TYPE||e.getType()===a.DATE_RANGE_TYPE||(e.getType()===a.VALUE_TYPE&&!e.hierarchyLevelId)){for(var j=0;j<c.length;j++){var n=c[j];if(n&&n.id()===e.getFilteredObjectId()){e.filteredObjectName=n.name();break}}}else if(e.getType()===a.VALUE_TYPE&&e.hierarchyLevelId){for(var j=0;j<c.length;j++){var n=c[j];if(n.hierarchyLevels()){var m=n.hierarchyLevels();for(var k=0;k<m.length;k++){var q=m[k];if(q&&q.id()===e.hierarchyLevelId){e.filteredObjectName=q.name();break}}}}}}}S.updateFeeds(v,f);S.updateFilters(v,d);return v};S.defaultIncompletePackage=function(t){var c=G.defaultUIConfig(G.DEFAULT_UICONFIG_TYPE_CHART);var p=c.defaultProperties;var d=I.getDataset(t).data();return{vizFrame:{chart:{vizInstance:{data:{type:S.TypeConst.CrosstableDataset,val:d},properties:p,type:t}}}}};S.updateCustomData=function(v,p){S._setValue(v,['customData'],p);return v};S.getCustomData=function(v){return S._getValue(v,['customData'])||{}};S._getValue=function(r,p){if(!r||!p||!p.length){return null}var n=r;for(var i=0;i<p.length;i++){if(!n[p[i]]){return null}n=n[p[i]]}return n};S._setValue=function(r,p,v){if(!r||!p||!p.length){return null}var n=r;for(var i=0;i<p.length-1;i++){if(!n[p[i]]){return}n=n[p[i]]}var l=p[p.length-1];n[l]=v};return S});define('sap/viz/controls/frame/VizFrame',['jquery','sap/viz/controls/common/VizControlHost','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/common/managers/LangManager','sap/viz/controls/frame/VizFrameConfig','sap/viz/controls/frame/VizFrameEvent','sap/viz/controls/annotation/Annotation','sap/viz/controls/annotation/AnnotationEvent','sap/viz/controls/frame/chartEditor/ChartEditorPlugin','sap/viz/controls/chart/Chart','sap/viz/controls/contextmenu/ContextMenu','sap/viz/controls/contextmenu/ContextMenuEvent','sap/viz/controls/frame/menu/CommentMenuItem','sap/viz/controls/custombutton/CustomButton','sap/viz/controls/custombutton/CustomButtonEvent','sap/viz/controls/filterbar/FilterBar','sap/viz/controls/filterbar/FilterBarEvent','sap/viz/controls/frame/views/FilterMenu','sap/viz/controls/frame/views/FilterMenuEvent','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/TitleEditor','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/runtime/VizModel','sap/viz/controls/Version','sap/viz/controls/annotation/AnnotationConfig','sap/viz/controls/chart/ChartConfig','sap/viz/controls/filterbar/FilterBarConfig','sap/viz/controls/contextmenu/ContextMenuConfig','sap/viz/controls/custombutton/CustomButtonConfig','sap/viz/controls/common/utils/Serialization'],function($,V,G,C,a,E,b,F,c,d,f,O,U,A,g,L,i,j,k,l,m,n,o,p,q,r,s,t,u,v,x,y,T,R,z,B,D,H,I,J,K,S){var M=function M(e,h){M.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.VizFrame";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_vizframe_control');this._div=e;this._uiConfig=h?h:G.defaultUIConfig(G.DEFAULT_UICONFIG_TYPE_FRAME);this._layout=null;this._filterBar=null;this._chart=null;this._chartEditorPlugin=new m(this._div,this,this._uiConfig);this._contextMenu=null;this._popupLayout=null;this._annotation=null;this._settingBtn=null;this._fullScreenBtn=null;this._titleEditor=null;this._createChildren();this._addChild(this._chart,['enableMorphing','feedAnalysisObjects'],[y.CHANGE_FEEDING,y.CHART_CHANGED,y.CHART_CHANGING,y.VIZTYPE_CHANGED,F.FEEDS_CHANGED]);if(this._filterBar){this._addChild(this._filterBar,['analysisObjectsForPicker'],[E.REQUEST_FILTER_VALUES])}this._addChild(this._annotation,[],[]);this._addChild(this._contextMenu,[],[p.REQUEST_LEGEND_COLOR]);this._addChild(this._fullScreenBtn,[],[j.ENTER_FULL_SCREEN,j.EXIT_FULL_SCREEN]);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_vizframe_control')};O.extend(M,V);M.VERSION="1.0";M.HEADER_HEIGHT=40;M.prototype.vizType=function(e){return this._chart.vizType.apply(this._chart,arguments)};M.prototype.filterItems=function(e){if(arguments.length>0){this._beginUpdateProperty();if(this._filterBar){this._filterBar.filterItems(e)}this._endUpdateProperty();return this}else{if(this._filterBar){return this._filterBar.filterItems()}return[]}};M.prototype._onVizModelChanged=function(e){if(e.data.filterChanged){var h=this._vizModel().filterItems();if(!this._inUpdatingProperty()){this._chart.showLoadingIcon()}this._dispatchPropertyEvent(new j(j.FILTERS_CHANGED,this,h))}};M.prototype._commentChangedHandler=function(e){var h={commentChanged:true};this._dispatchEvent(new b(E.VIZ_DEFINITION_CHANGED,this,h))};M.prototype._vizDefinitionChanged=function(e){this._dispatchEvent(new b(E.VIZ_DEFINITION_CHANGED,this,e.data))};M.prototype._createChart=function(){this._layout=document.createElement('div');$(this._div).append(this._layout);var h=H.instance();if(this._uiConfig.controls&&this._uiConfig.controls.chart){h=this._uiConfig.controls.chart}this._chart=new n(this._layout,h);this._chart.addEventListener(E.VIZ_DEFINITION_CHANGED,this._vizDefinitionChanged,this);this._chart.addEventListener(y.SELECT_PROPERTY_ZONE,$.proxy(function(e){this._dispatchEvent(new y(y.SELECT_PROPERTY_ZONE,this,e.data))},this));this._chart.addEventListener(y.CHART_CHANGED,this._chartChangedHandler,this);this._validateSize();this.__vizModel=this._chart.chartModel();this.__vizModel.addEventListener(z.PropertiesChangedEvent,this._onVizModelChanged,this)};M.prototype._chartChangedHandler=function(){if(this._titleEditor){this._titleEditor.init()}};M.prototype.popupLayer=function(){return this._popupLayout};M.prototype._createPopupLayer=function(){this._popupLayout=document.createElement('div');this._popupLayout.id="popupLayout";$(this._div).append(this._popupLayout)};M.prototype._createHeader=function(){if(!this._header$){this._header$=$(document.createElement('div')).appendTo(this._div);this._header$.addClass(C.FRAME_PREFIX+"header")}};M.prototype._createFullScreenButton=function(){var e=K.instance();if(this._uiConfig.controls&&this._uiConfig.controls.fullScreenButton){e=this._uiConfig.controls.fullScreenButton}this._fullScreenBtn=new r(this._header$,e);this._fullScreenBtn.setIcon([C.COMMON_PREFIX+"UVBSharedSprite",C.FRAME_PREFIX+'header-fullscreen-enter-icon'].join(' '));this._fullScreenBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_MAXIMIZE'));this._fullScreenBtn.addEventListener(s.CLICK_CUSTOM_BUTTON,$.proxy(function(h){this._isFullScreen=!this._isFullScreen;if(this._isFullScreen){this._fullScreenBtn.setIcon([C.COMMON_PREFIX+"UVBSharedSprite",C.FRAME_PREFIX+'header-fullscreen-exit-icon'].join(' '));this._fullScreenBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_RESTORE_DOWN'));this._dispatchEvent(new j(j.ENTER_FULL_SCREEN,this,this._isFullScreen))}else{this._fullScreenBtn.setIcon([C.COMMON_PREFIX+"UVBSharedSprite",C.FRAME_PREFIX+'header-fullscreen-enter-icon'].join(' '));this._fullScreenBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_MAXIMIZE'));this._dispatchEvent(new j(j.EXIT_FULL_SCREEN,this,this._isFullScreen))}},this),this)};M.prototype._createSettingButton=function(){var e=K.instance();if(this._uiConfig.controls&&this._uiConfig.controls.settingButton){e=this._uiConfig.controls.settingButton}this._settingBtn=new r(this._header$,e);this._settingBtn.setIcon([C.COMMON_PREFIX+"UVBSharedSprite",C.FRAME_PREFIX+'header-setting-icon'].join(' '));this._settingBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_SETTINGS'));this._settingBtn.addEventListener(s.CLICK_CUSTOM_BUTTON,$.proxy(function(h){var w=-107;var N=34;var P=h.data;var Q={pageX:P.left-$(this._div).offset().left+w,pageY:N};this._contextMenu.show(Q)},this),this)};M.prototype._createFilterBar=function(){this._filterBarContainer$=$(document.createElement('div')).appendTo(this._header$);this._filterBarContainer$.addClass(C.FRAME_PREFIX+'header-filterbar-container');var e=I.instance();if(this._uiConfig.controls&&this._uiConfig.controls.filterBar){e=this._uiConfig.controls.filterBar}this._filterBar=new t(this._filterBarContainer$,e);this._filterBar.addEventListener(u.HEIGHT_CHANGED,function(h){if(!this._header$){return this}this._header$.css({'height':h.data.height});this._validateSize(true)},this)};M.prototype._createContextMenu=function(){var h=J.instance();if(this._uiConfig.controls&&this._uiConfig.controls.contextMenu){h=this._uiConfig.controls.contextMenu}this._contextMenu=new o($(this._popupLayout),h);$(this._layout).bind('contextmenu',$.proxy(function(e){var w=U.getEventPosition(e);var N={pageX:w.pageX-$(this._div).offset().left,pageY:w.pageY-$(this._div).offset().top};this._contextMenu.show(N);return false},this))};M.prototype._createFilterMenu=function(){this._filterMenu=new v($(this._popupLayout),this._uiConfig);this._filterMenu.addEventListener(x.FILTER_CLICKED,function(e){this._filterMenu.hide();this._addFilter(false)},this);this._filterMenu.addEventListener(x.EXCLUDE_CLICKED,function(e){this._filterMenu.hide();this._addFilter(true)},this);this._chart.addEventListener(y.CHANGED_SELECTED_DATA,function(e){var h=this.vizSelection();var w=h?h.length:0;var N=w>0;var P=w>0;this._filterMenu.show(N,P)},this);this.vizOn("initialized.filterMenu",$.proxy(function(e){if(this._filterMenu){var h=this.vizSelection();var w=h?h.length:0;if(w>0){this._filterMenu.show(true,true)}else{this._filterMenu.hide()}}},this))};M.prototype._addFilter=function(e){if(this._filterBar){var h=this.vizSelection({'withDataCtx':true});this._vizModel().updateFilterItems(h,e,this.vizData(),this._chart.feeding())}else{var w={"isExclude":e,"feeding":this._chart.feeding()};this._dispatchEvent(new j(j.ADD_FILTER,this,w))}};M.prototype._createTitleEditor=function(){this._titleEditorContainer$=$(this._layout).find("."+C.CHART_PREFIX+"holder");$(this._titleEditorContainer$).css({position:'absolute',width:'100%'});this._titleEditor=new T(this._titleEditorContainer$)};M.prototype._createAnnotation=function(){var h=D.instance();if(this._uiConfig.controls&&this._uiConfig.controls.annotation){h=this._uiConfig.controls.annotation}this._annotation=new k(this._div,h);this._annotation.popupLayer(this._popupLayout);if(this._contextMenu){var w=new q($.proxy(this._vizModel,this),this._chart.__vizProxy);w.clickHandler($.proxy(function(){this._dispatchEvent(new j(j.ADD_COMMENT,this))},this));this._contextMenu.addMenuItem(w)}this.addEventListener(y.CHART_CHANGED,$.proxy(function(e){if(this._annotation){this._annotation.setChartInfo({'vizType':this._chart.vizType(),'vizData':this._chart.vizData()});var N=this._chart.size();this._annotation.validateSize(N.width,N.height)}},this));this.addEventListener(y.CHART_CHANGING,$.proxy(function(e){if(this._annotation){this._annotation.clean()}},this));this.addEventListener(F.FEEDS_CHANGED,$.proxy(function(e){if(this._annotation){this._annotation.feedsChanged()}},this));this.addEventListener(j.ADD_COMMENT,$.proxy(function(e){if(this._annotation){this._annotation.addComment(this.vizSelection({'withDataCtx':true}))}},this));this.vizOn("initialized.annotation",$.proxy(function(e){if(this._annotation){this._annotation.redraw()}},this))};M.prototype._createChildren=function(){var e=this._uiConfig.enableFilterBar===false?false:true;var h=this._uiConfig.enableFullScreenButton===false?false:true;var w=this._uiConfig.enableSettingButton===false?false:true;if(e||h||w){this._createHeader()}if(e){this._createFilterBar()}if(h){this._createFullScreenButton()}if(w){this._createSettingButton()}this._createChart();this._createPopupLayer();var N=this._uiConfig.enableContextMenu===false?false:true;if(N){this._createContextMenu()}var P=this._uiConfig.enableAnnotation===false?false:true;if(P){this._createAnnotation()}var Q=this._uiConfig.enableFilterMenu===false?false:true;if(Q){this._createFilterMenu()}this._createTitleEditor();if(this._filterBar){this._filterBar.connect(this.vizUid())}if(this._contextMenu){this._contextMenu.connect(this.vizUid())}if(this._titleEditor){this._titleEditor.connect(this.vizUid())}if(this._annotation){this._annotation.connect(this.vizUid())}};M.prototype._validateSize=function(e){var w=$(this._div).width();var h=$(this._div).height();if(this._filterBar&&!isNaN(this._header$.height())){if(!(e===true)){this._filterBar.validateSize()}h-=this._header$.height()}$(this._layout).css({width:w+"px",height:h+"px",visibility:"visible",display:''});if(this._chart){this._chart.size({width:w,height:h})}if(this._annotation){this._annotation.validateSize(w,h)}if(this._chartEditorPlugin){this._chartEditorPlugin.validateSize(w,h)}if(this._filterMenu){this._filterMenu.size({width:w})}if(this._titleEditor){this._titleEditor.size()}};M.prototype._chartControl=function(){return this._chart};M.prototype.connect=function(e){};M.prototype.disconnect=function(){};M.prototype.destroy=function(){if(this._contextMenu){this._contextMenu.removeAllEventListeners();this._contextMenu.destroy();this._contextMenu=null}if(this._filterMenu){this._filterMenu.removeAllEventListeners();this._filterMenu.destroy();this._filterMenu=null}if(this._chartEditorPlugin){this._chartEditorPlugin.destroy();this._chartEditorPlugin=null}if(this._annotation){this._annotation.destroy();this._annotation=null}M.superclass.destroy.apply(this,arguments);this._chart=null;this._filterBar=null};M.prototype.vizUid=function(){return this._chart.vizUid()};M.prototype.vizData=function(e){return this._chart.vizData.apply(this._chart,arguments)};M.prototype.vizCss=function(e){return this._chart.vizCss.apply(this._chart,arguments)};M.prototype.vizProperties=function(e){return this._chart.vizProperties.apply(this._chart,arguments)};M.prototype.vizDescription=function(){return this._chart.vizDescription.apply(this._chart,arguments)};M.prototype.vizUpdate=function(e){if(!e){return}this._beginUpdateProperty();try{if(e.filters&&this._filterBar){var h=e.filters.value?e.filters.value:e.filters;this._filterBar.filterItems(h)}var w=this._chart.vizUpdate.apply(this._chart,arguments)}catch(N){this._endUpdateProperty();throw N}this._endUpdateProperty();return w};M.prototype.vizOn=function(e,h){this._chart.vizOn.apply(this._chart,arguments);return this};M.prototype.vizOff=function(e){this._chart.vizOff.apply(this._chart,arguments);return this};M.prototype.vizAction=function(e,h){this._chart.vizAction.apply(this._chart,arguments);return this};M.prototype.vizSelection=function(e,h){return this._chart.vizSelection.apply(this._chart,arguments)};M.prototype.vizFeedingZone=function(){return this._chart.vizFeedingZone.apply(this._chart,arguments)};M.prototype.vizTitle=function(e){return this._chart.vizTitle.apply(this._chart,arguments)};M.prototype.createViz=function(e){if(arguments.length>0){this._chart.createViz(e);return this}};M.prototype.changeTemplate=function(){return this._chart.changeTemplate.apply(this._chart)};M.prototype.exportViz=function(){return this._chart.exportViz()};M.prototype.loadViz=function(e){this._chart.loadViz(e)};M.prototype.save=function(e){var h={};h['version']=B.VERSION;h["chart"]=this._chart.save(e);if(this._filterBar){h["filterBar"]=this._filterBar.save()}if(this._contextMenu){h["contextMenu"]=this._contextMenu.save()}if(this._annotation){h["annotation"]=this._annotation.save()}if(this._titleEditor){h['titleEditor']=this._titleEditor.save()}return h};M.prototype.load=function(e){this._beginUpdateProperty();e=S.migrate(e);if(e.vizFrame){e=e.vizFrame}var h=e['version'];h=e["filterBar"];if(h&&this._filterBar){this._filterBar.load(h)}h=e["contextMenu"];if(h&&this._contextMenu){this._contextMenu.load(h)}h=e["chart"];if(h){this._chart.load(h)}h=e["annotation"];if(h&&this._annotation){this._annotation.load(h)}h=e["titleEditor"];if(h&&this._titleEditor){this._titleEditor.load(h)}this._endUpdateProperty()};M.prototype.feeds=function(e){return this._chart.feeds.apply(this._chart,arguments)};M.prototype.getDefaultIncompleteOptions=function(e){return this._chart.getDefaultIncompleteOptions.apply(this._chart,arguments)};M.getFeedsFromSerialization=function(e){return S.getFeeds(e)};M.removeSerializationDataset=function(e){return S.removeDataset(e)};M.updateSerializationDataset=function(e,h){return S.updateDataset(e,h)};M.convertToVizSerialization=function(e){return S.convertToVizSerialization(e)};M.updateSerializationLabels=function(e,h){return S.updateAnalysisObjectLabels(e,analysisObject)};M.prototype.showMessage=function(e){if(arguments.length==1){this._chart.showMessage(e)}};M.prototype.setTitleGeneratorFunc=function(e){this._chart.setTitleGeneratorFunc(e)};M.prototype.chart=function(){return this._chart};M.prototype.filterBar=function(){return this._filterBar};M.prototype.contextMenu=function(){return this._contextMenu};M.prototype.titleEditor=function(){return this._titleEditor};return M});define('sap/viz/controls/filterbar2/FilterBarEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar2.FilterBarEvent"};O.extend(F,E);F.REQUEST_FILTER="requestFilter";F.REMOVE_FILTER="removeFilter";F.EDIT_FILTER="editFilter";F.HEIGHT_CHANGED="requestHeightChange";return F});define('sap/viz/controls/filterbar2/FilterItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event'],function(O,U,E){var F=function(i,d,a,c,b,v,e,f){this.__className="sap.viz.controls.filterbar2.FilterItem";this._id=i;this._displayName=d;this._displayValue=a;this._customData=c;this._cssClass=b;this._valueCssClass=v;this._disableRemoval=U.isBoolean(e)?e:false;this._valueCount=U.isNumber(f)?f:0};F.prototype.id=function(v){if(arguments.length>0){this._id=v}else{return this._id}};F.prototype.displayName=function(v){if(arguments.length>0){this._displayName=v}else{return this._displayName}};F.prototype.displayValue=function(v){if(arguments.length>0){this._displayValue=v}else{return this._displayValue}};F.prototype.disableRemoval=function(v){if(arguments.length>0){this._disableRemoval=v}else{return this._disableRemoval}};F.prototype.valueCount=function(v){if(arguments.length>0){this._valueCount=v}else{return this._valueCount}};F.prototype.customData=function(v){if(arguments.length>0){this._customData=v}else{return this._customData}};F.prototype.cssClass=function(v){if(arguments.length>0){this._cssClass=v}else{return this._cssClass}};F.prototype.valueCssClass=function(v){if(arguments.length>0){this._valueCssClass=v}else{return this._valueCssClass}};return F});define('sap/viz/controls/filterbar2/FilterRenderer',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/filterbar2/FilterBarEvent'],function($,O,E,C,F){var a=function(f,d){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar2.FilterRenderer";this._filterItem=f;this._div$=$(d);this._draw()};O.extend(a,E);a.prototype.filterItem=function(v){if(arguments.length>0){this._filterItem=v;this._reset();this._draw()}else{return this._filterItem}};a.prototype.destroy=function(){this._div$.empty()};a.prototype._draw=function(){var f=this._filterItem;var _=this;this._createFilterTitle(f,this._div$);this._addFilterValues(f,this._div$);this._div$.attr({'id':f.id()});this._div$.mouseover(function(e){$('.'+C.FILTERBAR2_PREFIX+'filter-values',e.currentTarget).addClass(C.FILTERBAR2_PREFIX+'filter-values-active')});this._div$.mouseout(function(e){$('.'+C.FILTERBAR2_PREFIX+'filter-values',e.currentTarget).removeClass(C.FILTERBAR2_PREFIX+'filter-values-active')});if(f.cssClass()){this._div$.addClass(f.cssClass())}this._div$.addClass(C.FILTERBAR2_PREFIX+'filter-item');if(!f.disableRemoval()){this._div$.click(function(){_._dispatchEvent(new F(F.EDIT_FILTER,_,{"filterItem":_._filterItem}))});var d=$(document.createElement('div')).appendTo(this._div$);d.addClass(C.FILTERBAR2_PREFIX+'delete-icon');d.addClass(C.COMMON_PREFIX+'UVBSharedSprite');d.click(function(e){_._dispatchEvent(new F(F.REMOVE_FILTER,_,{"filterItem":_._filterItem}));e.stopPropagation()})}};a.prototype._createFilterTitle=function(f,b){if(f.valueCount()<=0){var c=$(document.createElement('span')).appendTo(b).text(f.displayName()).attr("title",f.displayName());c.addClass(C.FILTERBAR2_PREFIX+'filter-item-text');c.addClass(C.FILTERBAR2_PREFIX+'range-filter-item-text');return}var t=$(document.createElement('div')).appendTo(b);var n=$(document.createElement('div')).appendTo(t).text(f.displayName()).attr("title",f.displayName()).css("display",'inline');n.addClass(C.FILTERBAR2_PREFIX+'filter-item-text').attr('id','filterName');var d=$(document.createElement('div')).appendTo(t).css("display",'inline').attr('id','countInfo');d.addClass(C.FILTERBAR2_PREFIX+'filter-item-info');$(document.createElement('span')).appendTo(d).text('(');var e=$(document.createElement('span')).appendTo(d).text(f.valueCount());if(f.valueCssClass()){e.addClass(f.valueCssClass())}$(document.createElement('span')).appendTo(d).text(')')};a.prototype._addFilterValues=function(f,b){var c=b.find("span[id='values']");if(c.length===0){c=$(document.createElement('span')).appendTo(b);c.addClass(C.FILTERBAR2_PREFIX+'filter-values');c.attr({id:'values'})}var d=f.displayValue();c.text(d).attr("title",d);if(f.valueCssClass()){c.addClass(f.valueCssClass())}};return a});define('sap/viz/controls/filterbar2/FilterBar',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/views/feed/FeedList','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/helpers/Rectangle','sap/viz/controls/filterbar2/FilterBarConfig','sap/viz/controls/filterbar2/FilterBarEvent','sap/viz/controls/filterbar2/FilterItem','sap/viz/controls/filterbar2/FilterRenderer'],function($,V,G,C,E,a,D,L,O,U,b,c,d,F,f,A,g,R,h,j,k,l){var m=function(e,u){m.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar2.FilterBar";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_filterbar_control');this._div=e;this._uiConfig=u?u:G.defaultUIConfig(G.DEFAULT_UICONFIG_TYPE_FILTERBAR2);this._filterItems=[];this._renderers=[];this._allAnalyses=null;this._settings=null;this._visualLines=1;if(U.isNumber(this._uiConfig.maxLines)&&this._uiConfig.maxLines>1){this._visualLines=this._uiConfig.maxLines}this._description$=null;this._layout$=null;this._headerVisible=false;this._isFullScreen=false;this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_filterbar_control')};var n=0.8;var o=42;var p=180;O.extend(m,V);m.VERSION="1.0";m.TYPE_STRING='string';m.TYPE_INTEGER='integer';m.TYPE_NUMBER='number';m.TYPE_DATE='date';var I=16;m.prototype.filterItems=function(e){if(arguments.length>0){this._filterItems=e;this._filtersChanged();return this}else{return this._filterItems}};m.prototype._createChildren=function(){var _=this;var i=this._uiConfig;this._headerVisible=true;this._plus$=$(document.createElement("div")).appendTo(this._div);this._plus$.addClass(C.COMMON_PREFIX+'havanaVXTabSprite16');this._plus$.addClass(C.FILTERBAR2_PREFIX+'header-plus');this._plus$.click(function(e){_._plusClickHandler(e)});var q=i.label?i.label:L.get('VIZ_FILTERBAR_ADD_FILTERS');this._description$=$(document.createElement("span")).text(q).appendTo(this._div);this._description$.addClass(C.FILTERBAR2_PREFIX+"description");this._layout$=$(document.createElement('div')).appendTo(this._div);this._layout$.addClass(C.FILTERBAR2_PREFIX+'layout');this._layout$.addClass(C.COMMON_PREFIX+'scrollable');this._layout$.addClass(C.COMMON_PREFIX+'scrollable-y');this._layout$.css({'max-height':this._visualLines*o});this._filterItemsContainer$=$(document.createElement('div')).appendTo(this._layout$);this._filterItemsContainer$.addClass(C.FILTERBAR2_PREFIX+'filterItems-container');if(this._headerVisible===true){this._layout$.hide()}else{this._layout$.css({'left':'0px'})}$(this._div).droppable({tolerance:'pointer',accept:'.'+D.DRAGGABLE_CLASS_ANALYSIS,over:$.proxy(this._dragOver,this),out:$.proxy(this._dragOut,this),drop:$.proxy(this._drop,this)})};m.prototype.analysisObjectsForPicker=function(e){if(arguments.length>0){if(e!=null&&!b.isArrayOfAnalysisObject(e)){return}this._allAnalyses=e}else{return this._allAnalyses}};m.prototype._plusClickHandler=function(e){var i=document.createElement('div');var q=new F(i,this._allAnalyses,g.DIMENSION,this._filterItems);q.addEventListener(f.ITEM_SELECTED,function(s){var t=s.data.selectedItem;if(t){this._addFilterItem(t)}},this);var r=this._plus$.offset();q.open({x:r.left+40,y:r.top,shelfWidth:0},'right')};m.prototype._isExist=function(e){var q=e.id();if(e.type()===A.HIERARCHY){q=e.selectedHierarchyLevel().analysis().id()}for(var i=0;i<this._filterItems.length;++i){if(this._filterItems[i].id()===q){return true}}return false};m.prototype._getDroppableAnalysisObject=function(t){if(!t||!t.analysisObject){return null}var e=t.analysisObject;var i=e.type();if(A.compatible(A.DIMENSION,i)&&i!==A.MND&&!this._isExist(e)){return e}else{return null}};m.prototype._dragOver=function(e,u){var t=D.instance().getAnalysisToken(u.helper);if(!t){return}var i=this._getDroppableAnalysisObject(t);if(i){t.currentAction(d.ACCEPT_AS_COPY)}else{t.currentAction(d.DENY)}};m.prototype._dragOut=function(e,u){var t=D.instance().getAnalysisToken(u.helper);if(t){t.currentAction(d.DENY)}};m.prototype._drop=function(e,u){var t=D.instance().getAnalysisToken(u.helper);if(!t){return}var i=this._getDroppableAnalysisObject(t);if(i){t.currentAction(d.ACCEPT_AS_COPY);this._addFilterItem(i)}else{t.currentAction(d.DENY)}t.dropTarget(this._dom)};m.prototype._addFilterItem=function(e){this._dispatchEvent(new j(j.REQUEST_FILTER,this,{"analysisObject":e}))};m.prototype._filtersChanged=function(){if(this._filterItemsContainer$){this._filterItemsContainer$.empty()}var e=this._filterItems;if(!e||e.length==0){this._updateDescription();return this}if(this._headerVisible===true){this._description$.hide();this._layout$.show()}this._updateFilterItemContainer()};m.prototype._stringToNumber=function(v){if(!v){return 0}return parseInt(v.replace('px',''))};m.prototype._validateSize=function(){var e=$('.'+C.FILTERBAR2_PREFIX+'filter-item');if(e.length==0){return this}e.css({'width':p});this._updateFilterItemsWidth()};m.prototype._needAdjust=function(){var e=this._filterItemsContainer$.innerHeight();var i=e>o;if(i){return true}else{return false}};m.prototype._updateFilterItemContainer=function(){var e=this._filterItems;var i;for(i=0;i<this._renderers.length;i++){this._renderers[i].destroy()}for(i=0;i<e.length;i++){var q=$(document.createElement('div')).appendTo(this._filterItemsContainer$);this._renderers[i]=new l(e[i],q);this._renderers[i].addEventListener(j.REMOVE_FILTER,this._dispatchFilterEvent,this);this._renderers[i].addEventListener(j.EDIT_FILTER,this._dispatchFilterEvent,this)}this._updateFilterItemsWidth();return this};m.prototype._dispatchFilterEvent=function(e){this._dispatchEvent(e)};m.prototype._updateFiltersTitle=function(){var u=function(i,e){var q=$('#filterName',e);if(q.length===0){return}q.css({'width':'auto'});var t=q.parent();var r=$('#countInfo',e);var s=q.position();var v=q.width()+s.left+2;var w=t.width()-I;var x=r.width();var y=Math.min(v,w-x);q.css({'width':y-s.left});r.css({'left':y})};$('.'+C.FILTERBAR2_PREFIX+'filter-item').each(u)};m.prototype._updateFilterItemsWidth=function(){var e;if(this._filterItemsContainer$.children().length===0){this._updateDescription();return this}if(!this._needAdjust()){e={'height':o};this._dispatchEvent(new j(j.HEIGHT_CHANGED,this,e));this._updateFiltersTitle();return this}var i=0;var q=p;var r=this._filterItemsContainer$.children();while(this._needAdjust()&&i<2){i++;q=q*n;r.css({'width':q})}if(this._needAdjust()){e={'height':this._avaliableHeightForHeader()};this._dispatchEvent(new j(j.HEIGHT_CHANGED,this,e));if(e.height<this._filterItemsContainer$.outerHeight()){$(this._layout$).scrollTop(this._filterItemsContainer$.outerHeight())}}if(!this._needAdjust()){e={'height':o};this._dispatchEvent(new j(j.HEIGHT_CHANGED,this,e))};this._updateFiltersTitle();return this};m.prototype._avaliableHeightForHeader=function(){var e=this._filterItemsContainer$.outerHeight();var q=o-2;var r=o;var s=this._visualLines-1;for(var i=2;i<=this._visualLines;i++){if(q*i<=e&&e<=r*i){s=i-1;break}}var t=2;return s*q+r+t};m.prototype._updateDescription=function(){var e=this._vizModel().filterItems();if(e.length===0&&this._headerVisible===true){this._description$.show();this._layout$.hide()}};return m});(function(){var a="#333333";var b={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var i={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false,enableHover:false};var c={dataLoading:false,dataUpdating:false,resizing:false};var m={color:a,gridline:{color:a},enableLabelSelection:false};var g={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:c},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var d={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:c},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var e={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:c},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},zAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i,rotate:{enableRotate:false}};var f={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:c},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},zAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i,rotate:{enableRotate:false}};var h={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:c},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var j={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:c},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var k={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{marker:{visible:false},animation:c,tooltipVisble:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var l={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{marker:{visible:false},animation:c},rowAxis:m,columnAxis:m,background:b,interaction:i};var n={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{line:{marker:{visible:false}},tooltipVisble:false,animation:c},rowAxis:m,columnAxis:m,background:b,interaction:i};var o={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{line:{marker:{visible:false}},animation:c},rowAxis:m,columnAxis:m,background:b,interaction:i};var p={xAxis:{color:a,label:{visible:true,},gridline:{visible:false,},enableLabelSelection:false},plotArea:{animation:c},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},sizeLegend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var q={xAxis:{color:a,label:{visible:true,},gridline:{visible:false,},enableLabelSelection:false},plotArea:{animation:c},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var r={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},gridline:{visible:false,},enableLabelSelection:false},plotArea:{animation:c},multiLayout:{plotTitle:{visible:false},},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:i};var s={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:c},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:i};var t={plotArea:{animation:c},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:i};var u={plotArea:{animation:c},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:i};var v={plotArea:{animation:c},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var w={plotArea:{animation:c},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var x={plotArea:{animation:c},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i,rotate:{enableRotate:false}};var y={plotArea:{animation:c},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i,rotate:{enableRotate:false}};var z={title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{polarAxis:{title:{visible:false}},valueAxis:{visible:true,},animation:c},rowAxis:m,columnAxis:m,background:b,interaction:i};var A={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:c},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var B={yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:c},xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var C={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:c},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var D={yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:c},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var E={yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:c},xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var F={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:c},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:i};var G={plotArea:{animation:c,draggable:false,label:{visible:false}},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:i};var H={plotArea:{animation:c,clickAble:false,label:{visible:false}},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:i};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",name:"Incomplete Ghost",version:"4.0.0",properties:{'viz/bar':d,'viz/image_bar':d,'viz/multi_bar':d,'viz/dual_bar':d,'viz/multi_dual_bar':d,'viz/column':g,'viz/multi_column':g,'viz/dual_column':g,'viz/multi_dual_column':g,'viz/stacked_bar':h,'viz/multi_stacked_bar':h,'viz/dual_stacked_bar':h,'viz/multi_dual_stacked_bar':h,'viz/100_stacked_bar':h,'viz/multi_100_stacked_bar':h,'viz/100_dual_stacked_bar':h,'viz/multi_100_dual_stacked_bar':h,'viz/stacked_column':j,'viz/multi_stacked_column':j,'viz/dual_stacked_column':j,'viz/multi_dual_stacked_column':j,'viz/100_stacked_column':j,'viz/multi_100_stacked_column':j,'viz/100_dual_stacked_column':j,'viz/multi_100_dual_stacked_column':j,'riv/cbar':g,'viz/stacked_column':j,'viz/multi_stacked_column':j,'viz/3d_bar':e,'viz/3d_column':f,'viz/combination':o,'viz/horizontal_combination':n,'viz/dual_combination':o,'viz/dual_horizontal_combination':n,'viz/boxplot':A,'viz/horizontal_boxplot':B,'viz/waterfall':C,'viz/horizontal_waterfall':D,'viz/stacked_waterfall':C,'viz/horizontal_stacked_waterfall':D,'viz/line':l,'viz/multi_line':l,'viz/dual_line':l,'viz/multi_dual_line':l,'viz/horizontal_line':k,'viz/multi_horizontal_line':k,'viz/dual_horizontal_line':k,'viz/multi_dual_horizontal_line':k,'viz/area':l,'viz/multi_area':l,'viz/100_area':l,'viz/multi_100_area':l,'viz/horizontal_area':k,'viz/multi_horizontal_area':k,'viz/100_horizontal_area':k,'viz/multi_100_horizontal_area':k,'viz/pie':v,'viz/multi_pie':v,'viz/donut':w,'viz/multi_donut':w,'viz/pie_with_depth':x,'viz/donut_with_depth':y,'viz/bubble':p,'viz/multi_bubble':p,'viz/scatter':q,'viz/multi_scatter':q,'viz/scatter_matrix':r,'viz/radar':z,'viz/multi_radar':z,'viz/tagcloud':u,'viz/heatmap':s,'viz/treemap':t,'viz/mekko':E,'viz/100_mekko':E,'viz/horizontal_mekko':F,'viz/100_horizontal_mekko':F,'viz/network':G,'viz/tree':H}})})();(function(){var a="#333333";var b={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var i={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false};var c={dataLoading:false,dataUpdating:false};var m={color:a,gridline:{color:a},label:{visible:false}};var g={plotArea:{animation:c},title:{visible:false},legend:{visible:false},sizeLegend:{visible:false},background:b,interaction:i,rowAxis:m,columnAxis:m,geoController:{disableInteraction:true}};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",properties:{'viz/geobubble':g,'viz/geopie':g,'viz/choropleth':g,'viz/multi_geobubble':g,'viz/multi_choropleth':g}})})();var axisColor="#333333";var backgroundProperty={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var interactionProperty={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false,enableHover:false};var incomplete_ghostFunnelEffect={title:{visible:false},legend:{visible:false},background:backgroundProperty,interaction:interactionProperty};var incomplete_ghostPCEffect={title:{visible:false},legend:{visible:false},background:backgroundProperty};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",properties:{'viz/ext/pa/funnel':incomplete_ghostFunnelEffect,'viz/ext/pa/pc':incomplete_ghostPCEffect},css:"\
		.v-m-main .v-background-body{fill:;}\
		 svg {font-family:Tahoma,Arial,Helvetica,sans-serif;font-size:12px;}\
		.axis line{fill: none;stroke: #333333;shape-rendering: crispEdges;}\
	    .axis path{fill: none;stroke: #333333;shape-rendering: crispEdges;}\
	   .axistext{fill: #333333; cursor : move;}\
	",});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_COMMON_COLUMN_TEXT:"Column Chart",VIZ_COMMON_STACKED_COLUMN_TEXT:"Stacked Column Chart",VIZ_COMMON_DUAL_COLUMN_TEXT:"Column Chart With 2 Y-Axes",VIZ_COMMON_3D_COLUMN_TEXT:"3D Column Chart",VIZ_COMMON_LINE_TEXT:"Line Chart",VIZ_COMMON_AREA_TEXT:"Area Chart",VIZ_COMMON_COMBINATION_TEXT:"Combined Column Line Chart",VIZ_COMMON_DUAL_LINE_TEXT:"Line Chart With 2 Y-Axes",VIZ_COMMON_DUAL_COMBINATION_TEXT:"Combined Column Line Chart With 2 Y-Axes",VIZ_COMMON_PIE_TEXT:"Pie Chart",VIZ_COMMON_DONUT_TEXT:"Donut Chart",VIZ_COMMON_PIE_WITH_DEPTH_TEXT:"Pie With Variable Slice Depth",VIZ_COMMON_GEOBUBBLE_TEXT:"Geographic Bubble Chart",VIZ_COMMON_CHOROPLETH_TEXT:"Geo Choropleth Chart",VIZ_COMMON_GEOPIE_TEXT:"Geo Pie Chart",VIZ_COMMON_GEOMAP_TEXT:"Geo Map",VIZ_COMMON_SCATTER_TEXT:"Scatter Plot",VIZ_COMMON_BUBBLE_TEXT:"Bubble Chart",VIZ_COMMON_SCATTER_MATRIX_TEXT:"Scatter Matrix Chart",VIZ_COMMON_TREEMAP_TEXT:"Tree Map",VIZ_COMMON_HEATMAP_TEXT:"Heat Map",VIZ_COMMON_TABLE_TEXT:"Table",VIZ_COMMON_RADAR_TEXT:"Radar Chart",VIZ_COMMON_BOXPLOT_TEXT:"Box Plot",VIZ_COMMON_WATERFALL_TEXT:"Waterfall Chart",VIZ_COMMON_TAGCLOUD_TEXT:"Tag Cloud",VIZ_COMMON_MEASURES:"MEASURES",VIZ_COMMON_DIMENSIONS:"DIMENSIONS",VIZ_COMMON_TRELLIS:"TRELLIS",VIZ_COMMON_XAXIS:"X Axis",VIZ_COMMON_YAXIS:"Y Axis",VIZ_COMMON_PRIMARY_YAXIS:"Y Axis1",VIZ_COMMON_SECONDARY_YAXIS:"Y Axis2",VIZ_COMMON_PIE_SECTORS:"Pie Sectors",VIZ_COMMON_PIE_DEPTH:"Pie Depth",VIZ_COMMON_FEATUREVALUES:"Value",VIZ_COMMON_BUBBLE_WIDTH:"Bubble Width",VIZ_COMMON_BUBBLE_HEIGHT:"Bubble Height",VIZ_COMMON_RECTANGLECOLOR:"Area Color",VIZ_COMMON_RECTANGLEWEIGHT:"Area Weight",VIZ_COMMON_REGIONCOLOR:"Legend Color",VIZ_COMMON_GEO_FEATURES:"Geography",VIZ_COMMON_FEATUREANALYSIS:"Overlay Data",VIZ_COMMON_REGIONSHAPE:"Legend Shape",VIZ_COMMON_AREANAME:"Area Name",VIZ_COMMON_SECONDARY_AREANAME:"Area Name2",VIZ_COMMON_RADAR_AXES:"Radar Branches",VIZ_COMMON_TAGWEIGHT:"Word Weight",VIZ_COMMON_TAGFAMILY:"Word Color",VIZ_COMMON_TAGNAME:"Word",VIZ_COMMON_COLUMNS:"Columns",VIZ_COMMON_ROWS:"Rows",VIZ_COMMON_TABLE_DIMENSION:"Rows Axis",VIZ_COMMON_TABLE_MEASURE:"Primary Values",VIZ_COMMON_LEGEND:"Legend",VIZ_COMMON_DIMENSION_LIMITATION_WARN:"You have reached the maximum number of dimension feeds for this visualization.",VIZ_COMMON_CHANGE_CALCULATION:"Change Calculation",VIZ_COMMON_SUM:"Sum",VIZ_COMMON_AVERAGE:"Average",VIZ_COMMON_MIN:"Min",VIZ_COMMON_MAX:"Max",VIZ_COMMON_COUNT_DISTINCT:"Count-Distinct",VIZ_COMMON_COUNT_ALL:"Count-All",VIZ_COMMON_NONE:"None",VIZ_COMMON_SUM_SHORT:"(Sum)",VIZ_COMMON_AVERAGE_SHORT:"(Avg)",VIZ_COMMON_MIN_SHORT:"(Min)",VIZ_COMMON_MAX_SHORT:"(Max)",VIZ_COMMON_COUNT_DISTINCT_SHORT:"(Cnt-Dis)",VIZ_COMMON_COUNT_ALL_SHORT:"(Cnt-All)",VIZ_COMMON_NONE_SHORT:"(None)",VIZ_COMMON_EDIT:"Edit",VIZ_COMMON_DELETE:"Delete",VIZ_COMMON_DELETE_COMMENT_MESSAGE:"Are you sure to delete the comment?",VIZ_COMMON_DONT_SHOW_MESSAGE:"Don't show this again",VIZ_COMMON_OK:"OK",VIZ_COMMON_CANCEL:"Cancel",VIZ_COMMON_BETWEEN:"BETWEEN",VIZ_COMMON_SEARCH:"Search",VIZ_COMMON_FAKE_DIMENSION:"Fake Dimension",VIZ_COMMON_FAKE_MEASURE:"Fake Measure",VIZ_COMMON_SERIALIZATION_FAILED:"Serialization error",VIZ_COMMON_INVALID_SERIALIZATION_PACKAGE:"Invalid serialization package",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_BUILDER_CHART:"TYPE:",VIZ_BUILDER_BUILD:"Build",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_CHART_INCOMPLETE_DESCRIPTION:"Incomplete chart. Please add more measures or dimensions.",VIZ_CHART_GEO_INCOMPLETE_DESCRIPTION:"Incomplete chart. Please add more geography dimensions.",VIZ_CHART_CREATE_CHART_FAILED:"Failed to create chart:",VIZ_CHART_UPDATE_CHART_FAILED:"Failed to update chart:",VIZ_CHART_UPDATE_DATA_FAILED:"Failed to update chart data:",VIZ_CHART_UPDATE_FEEDING_FAILED:"Failed to update chart feeding:",VIZ_CHART_UPDATE_CSS_FAILED:"Failed to update chart css:",VIZ_CHART_UPDATE_PROPERTIES_FAILED:"Failed to update chart properties:",VIZ_CHART_ADD_EVENT_FAILED:"Failed to add chart event callback:",VIZ_CHART_REMOVE_EVENT_FAILED:"Failed to remove chart event callback:",VIZ_CHART_SELECTION_FAILED:"Failed to get/set chart selection:",VIZ_CHART_FEEDINGZONE_FAILED:"Failed to get chart feedingzone:",VIZ_CHART_DESCRIPTION_FAILED:"Failed to get/set chart description:",VIZ_CHART_TRIGGER_ACTION_FAILED:"Failed to trigger chart action:",VIZ_CHART_SERIALIZE_FAILED:"Failed to serialize chart:",VIZ_CHART_VIZINSTANCE_NOT_CREATED:"VizInstance is not created.",VIZ_CHART_INVALID_VIZ_TYPE:"Cannot display this chart: {0}.",VIZ_CHART_TRELLIS_DISABLED_WARN:"The trellis is disabled in either Viz Frame or Feeding Panel.",VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER:"No data matches your filter(s).",VIZ_CHART_TITLE_TEXT_JOIN_BY:"{0} by {1}",VIZ_CHART_TITLE_TEXT_JOIN_AND:"and",VIZ_CHART_TITLE_CONTEXT_MENU_EDIT:"Rename",VIZ_CHART_TITLE_CONTEXT_MENU_RESTORE:"Restore Default Title",VIZ_CONTROLS_API_PARAMETER_ERROR:"API parameter error.",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_COLORPICKER_COLOR:"Edit Color",VIZ_COLORPICKER_OPACITY:"Opacity",VIZ_COLORPICKER_OK:"Ok",VIZ_COLORPICKER_CANCEL:"Cancel.",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_CONTEXTMENU_SHOW_LEGEND:"Show Legend",VIZ_CONTEXTMENU_SHOW_DATALABELS:"Show Data Labels",VIZ_CONTEXTMENU_NORMAL_STACKING:"Normal Stacking",VIZ_CONTEXTMENU_FULL_STACKING:"100% Stacking",VIZ_CONTEXTMENU_HORIZONTAL:"Horizontal",VIZ_CONTEXTMENU_VERTICAL:"Vertical",VIZ_CONTEXTMENU_INSERT_COMMENT:"Insert Comment...",VIZ_CONTEXTMENU_CHANGE_MBCLEGEND_COLOR:"Choose Legend Item Colors...",VIZ_CONTEXTMENU_MENU_CHART_EDITOR:"Chart Editor...",VIZ_CONTEXTMENU_SHOW_MND:"Show Measures' Names as a Dimension",VIZ_CONTEXTMENU_NO_MENU_ITEMS:"No avaliable items",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_CUSTOMBUTTON_SETTINGS:"Settings",VIZ_CUSTOMBUTTON_MAXIMIZE:"Maximize",VIZ_CUSTOMBUTTON_RESTORE_DOWN:"Restore Down",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_FILTERBAR_DESCRIPTION:"Add filters.",VIZ_FILTERBAR_GLOBAL_FILTER:"Global Filter:",VIZ_FILTERBAR_ITEMS_EXCLUDED:"items excluded",VIZ_FILTERBAR_ITEMS_INCLUDED:"items included",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_FILTERBAR_ADD_FILTERS:"Add filters.",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_FRAME_FILTERMENU_FILTER:"Filter",VIZ_FRAME_FILTERMENU_EXCLUDE:"Exclude",VIZ_FRAME_FILTERBAR_DESCRIPTION:"Select fields from the Data Set to filter.",VIZ_FRAME_CHART_EDITOR:"Chart Editor",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_MAPBUILDER_VIZ_LAYER_NAME:"Layer",VIZ_MAPBUILDER_BASE_MAP_NAME:"base map",VIZ_MAPBUILDER_ADD_NEW_LAYER:"Add Layer",VIZ_MAPBUILDER_RENAME:"Rename",VIZ_MAPBUILDER_DELETE:"Delete layer",VIZ_MAPBUILDER_HIDE:"Hide",VIZ_MAPBUILDER_SHOW:"Show",VIZ_MAPBUILDER_MOVEUP:"Move up",VIZ_MAPBUILDER_MOVEDOWN:"Move down",VIZ_MAPBUILDER_DELETE_GEO_LAYER:"Delete Geo Layer",VIZ_MAPBUILDER_OK:"Ok",VIZ_MAPBUILDER_CANCEL:"Cancel",VIZ_MAPBUILDER_DATA_POINTS:"Data Point Type",VIZ_MAPBUILDER_CHOROPLETH:"choropleth",VIZ_MAPBUILDER_BUBBLE:"bubble",VIZ_MAPBUILDER_MARKER:"marker",VIZ_MAPBUILDER_TYPE:"type",VIZ_MAPBUILDER_GEO:"Geo Dimension",VIZ_MAPBUILDER_GEO_LOCATION:"Geo Location",VIZ_MAPBUILDER_GEO_COLOR:"Color",VIZ_MAPBUILDER_GEO_SIZE:"Size",VIZ_MAPBUILDER_MEASURES:"Color",VIZ_MAPBUILDER_PROPERTIES:"PROPERTIES",VIZ_MAPBUILDER_SHOW_LEGEND:"show legend",VIZ_MAPBUILDER_MARKER_CLUSTER:"Cluster adjacent markers",VIZ_MAPBUILDER_BUBBLE_CLUSTER:"Cluster adjacent bubbles",VIZ_MAPBUILDER_MAP:"MAP",VIZ_MAPBUILDER_PROVIDERS:"Providers",VIZ_MAPBUILDER_STYLES:"STYLES",VIZ_MAPBUILDER_ESRI_MAP_STYLE_MAP:"Map",VIZ_MAPBUILDER_ESRI_MAP_STYLE_SATELLITE:"Satellite",VIZ_MAPBUILDER_ESRI_MAP_STYLE_TERRAIN:"Terrain",VIZ_MAPBUILDER_ESRI_MAP_STYLE_STREETS:"Streets",VIZ_MAPBUILDER_NOT_SUPPORT_ERROR:"Not Support Yet.",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_SWITCHBAR_COLUMN_CHARTS:"Column Charts",VIZ_SWITCHBAR_LINE_CHARTS:"Line Charts",VIZ_SWITCHBAR_PIE_CHARTS:"Pie Charts",VIZ_SWITCHBAR_GEO_CHARTS:"Geographic Charts",VIZ_SWITCHBAR_SCATTER_CHARTS:"Scatter Charts",VIZ_SWITCHBAR_MAP_CHARTS:"Map Charts",VIZ_SWITCHBAR_TABLES:"Tables",VIZ_SWITCHBAR_OTHER_CHARTS:"Other Charts",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_ANNOTATION_COMMENT:"Comment",}});(function(g){var e=['sap/viz/controls/builder/VizBuilder','sap/viz/controls/chart/Chart','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/managers/LangManager','sap/viz/controls/feeding/FeedingPanel','sap/viz/controls/frame/VizFrame','sap/viz/controls/mapbuilder/MapBuilder','sap/viz/controls/switchbar/SwitchBar','sap/viz/controls/filterbar2/FilterBar','sap/viz/controls/Version','sap/viz/controls/services/FakeDataService',];var j=g.jQuery;if(j){if(jQuery.holdReady){jQuery.holdReady(true)}else{jQuery.readyWait+=1}}require(e,function(){var a=arguments;e.forEach(function(m,i){var n=m.split("/");n.reduce(function(p,c,b){if(!p[c]){if(b<n.length-1){p[c]={}}else{p[c]=a[i]}}return p[c]},g)});if(j){if(jQuery.holdReady){jQuery.holdReady(false)}else{jQuery.ready(true)}}})})(this);
